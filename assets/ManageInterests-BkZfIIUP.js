import{i as b,j as e,n as R,r as d,o as z,l as v,p as u,B as p,Y as L,P as W,Z as U,$ as H,a0 as _,a1 as l,a2 as F,I as O,a3 as G,a4 as V,a5 as P,G as m,z as x,a6 as Y}from"./vendor-BEV2JtpX.js";import{b as Z,s as o}from"./index-BPoNtoii.js";import{I as $,M as K}from"./MarkdownEditor-CiQUfrIG.js";import"./supabase-BTz4VuFi.js";import"./Delete-BxS1TgHm.js";const Q=b(e.jsx("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutlineOutlined"),X=b(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutlineOutlined"),ee=b(e.jsx("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92zM17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29m-3.6 3.19L3 17.25V21h3.75L17.81 9.94z"}),"EditOutlined");function oe(){const{user:a}=Z(),I=R(),[C,w]=d.useState([]),[k,S]=d.useState(!1),[h,f]=d.useState(null),[i,c]=d.useState({title:"",description:"",image_path:"",content:"",name:"",sequence:0});d.useState(!1);const[te,q]=d.useState(null);d.useEffect(()=>{if(!a||a.email!=="golfergeek@gmail.com"){I("/");return}(async()=>{try{const{data:n}=await o.storage.listBuckets();if(!n.some(r=>r.name==="interest-images")){const{error:r}=await o.storage.createBucket("interest-images",{public:!0,allowedMimeTypes:["image/*"],fileSizeLimit:5242880});r&&console.error("Error creating bucket:",r)}}catch(n){console.error("Error in setupStorage:",n)}})(),j()},[a,I]);const j=async()=>{try{const{data:t,error:n}=await o.from("interests").select("*").eq("user_id",a.id).order("title");if(n)throw n;w(t)}catch(t){console.error("Error fetching interests:",t)}},E=(t=null)=>{t?(f(t),c({title:t.title,description:typeof t.description=="object"?JSON.stringify(t.description,null,2):t.description||"",image_path:t.image_path||"",content:t.content||"",name:t.name||"",sequence:t.sequence||0})):(f(null),c({title:"",description:"",image_path:"",content:"",name:"",sequence:0})),S(!0)},y=()=>{S(!1),f(null),c({title:"",description:"",image_path:"",content:"",name:"",sequence:0})},g=t=>{const{name:n,value:s}=t.target;c(r=>({...r,[n]:s}))},D=t=>n=>{c(s=>({...s,[t]:n||""}))},T=t=>{t&&t.length>0&&c(n=>({...n,image_path:t[0]}))},A=()=>{c(t=>({...t,image_path:""}))},M=async()=>{try{await o.from("interests").select("id").limit(1);const t={id:h?h.id:crypto.randomUUID(),title:i.title,description:i.description,image_path:i.image_path||"/images/default.jpg",name:i.name||i.title.toLowerCase().replace(/[^a-z0-9]+/g,"-"),sequence:i.sequence||0,content:i.content||"",user_id:a.id};if(h){const{error:n}=await o.from("interests").update(t).eq("id",h.id);if(n)throw n}else{const{error:n}=await o.from("interests").insert([t]);if(n)throw n}y(),j()}catch(t){console.error("Error saving interest:",t)}},B=async t=>{if(a!=null&&a.id)try{const{data:n,error:s}=await o.from("interests").select("*").eq("id",t).single();if(s)throw s;const{error:r}=await o.from("interests").delete().eq("id",t);if(r)throw r;w(C.filter(N=>N.id!==t))}catch{q("Failed to delete interest")}},J=async()=>{const t=[{title:"Coding Journey",description:JSON.stringify({sections:[{title:"Near the metal",items:["Assembler","C++"]},{title:"Business Developer",items:["Power Builder","VB","C#",".NET","SS(RAI)S","Angular"]},{title:"Semi-Retirement",items:["React","AI","Mentoring"]}]}),image_path:"/images/default.jpg",name:"coding",sequence:1,content:`# Coding Journey

From assembly language to modern web development, my journey in software development spans decades of technological evolution.`},{title:"Golf Adventures",description:JSON.stringify({text:"Sharing golf experiences, tips, and achievements"}),image_path:"/images/default.jpg",name:"golf",sequence:2,content:`# Golf Adventures

Exploring the game of golf, sharing experiences, and documenting the journey of improvement.`},{title:"Mentorship",description:JSON.stringify({text:"Guiding and supporting others in their journey"}),image_path:"/images/default.jpg",name:"mentoring",sequence:3,content:`# Mentorship

Sharing knowledge and experience to help others grow in their careers and personal development.`},{title:"Life's Journey",description:JSON.stringify({text:"Insights and reflections on the aging process"}),image_path:"/images/default.jpg",name:"aging",sequence:4,content:`# Life's Journey

Reflections on aging, personal growth, and the continuous process of learning and adaptation.`}];for(const n of t)try{const s=crypto.randomUUID(),{error:r}=await o.from("interests").insert([{...n,id:s,user_id:a.id}]);if(r)throw r}catch(s){console.error("Error creating interest:",s)}j()};return e.jsxs(z,{maxWidth:"lg",sx:{mt:4},children:[e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(u,{variant:"h4",component:"h1",children:"Manage Interests"}),e.jsxs(v,{sx:{display:"flex",gap:2},children:[e.jsx(p,{variant:"outlined",color:"primary",onClick:J,children:"Create Initial Interests"}),e.jsx(p,{variant:"contained",color:"primary",startIcon:e.jsx(Q,{}),onClick:()=>E(),children:"Add Interest"})]})]}),e.jsx(L,{component:W,children:e.jsxs(U,{children:[e.jsx(H,{children:e.jsxs(_,{children:[e.jsx(l,{children:"Title"}),e.jsx(l,{children:"Description"}),e.jsx(l,{children:"Image"}),e.jsx(l,{children:"Actions"})]})}),e.jsx(F,{children:C.map(t=>e.jsxs(_,{children:[e.jsx(l,{children:t.title}),e.jsx(l,{children:e.jsxs(u,{noWrap:!0,sx:{maxWidth:200},children:[typeof t.description=="object"?JSON.stringify(t.description).substring(0,100):(t.description||"").substring(0,100),(typeof t.description=="object"?JSON.stringify(t.description).length>100:(t.description||"").length>100)?"...":""]})}),e.jsx(l,{children:t.image_path&&e.jsx(v,{component:"img",src:t.image_path,alt:t.title,sx:{width:50,height:50,objectFit:"cover",borderRadius:1}})}),e.jsxs(l,{children:[e.jsx(O,{onClick:()=>E(t),color:"primary",children:e.jsx(ee,{})}),e.jsx(O,{onClick:()=>B(t.id),color:"error",children:e.jsx(X,{})})]})]},t.id))})]})}),e.jsxs(G,{open:k,onClose:y,maxWidth:"md",fullWidth:!0,children:[e.jsx(V,{children:h?"Edit Interest":"Add Interest"}),e.jsx(P,{children:e.jsxs(m,{container:!0,spacing:2,children:[e.jsx(m,{item:!0,xs:12,children:e.jsx(x,{name:"title",label:"Title",value:i.title,onChange:g,fullWidth:!0,margin:"normal"})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(x,{name:"name",label:"URL Name (optional)",value:i.name,onChange:g,fullWidth:!0,margin:"normal",helperText:"Leave blank to auto-generate from title"})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(x,{name:"description",label:"Description",value:i.description,onChange:g,fullWidth:!0,multiline:!0,rows:3,margin:"normal"})}),e.jsxs(m,{item:!0,xs:12,children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Interest Image"}),e.jsx($,{onUpload:T,onRemove:A,existingImages:i.image_path?[i.image_path]:[],bucket:"interest-images",folder:"interest-images"})]}),e.jsxs(m,{item:!0,xs:12,children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Content"}),e.jsx(K,{value:i.content,onChange:D("content")})]}),e.jsx(m,{item:!0,xs:12,children:e.jsx(x,{name:"sequence",label:"Sequence",type:"number",value:i.sequence,onChange:g,fullWidth:!0,margin:"normal"})})]})}),e.jsxs(Y,{children:[e.jsx(p,{onClick:y,children:"Cancel"}),e.jsx(p,{onClick:M,variant:"contained",color:"primary",children:h?"Save Changes":"Create Interest"})]})]})]})}export{oe as default};
//# sourceMappingURL=ManageInterests-BkZfIIUP.js.map
