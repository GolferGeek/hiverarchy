{"version":3,"mappings":"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,IACZ,cAAe,MACf,aAAc,SACf,EACD,GAAI,CACF,SAAU,SACV,WAAY,IACZ,cAAe,YACf,aAAc,UACf,EACD,GAAI,CACF,SAAU,UACV,WAAY,IACZ,cAAe,MACf,aAAc,QACf,EACD,GAAI,CACF,SAAU,WACV,WAAY,IACZ,cAAe,WACf,aAAc,QACf,EACD,MAAO,CACL,SAAU,OACV,WAAY,GACb,EACD,MAAO,CACL,SAAU,WACV,WAAY,GACb,CACF,EACD,MAAO,CACL,aAAc,CACf,CACH,EAGMC,GAAe,CACnB,OAAQ,UACR,MAAO,UACP,QAAS,UACT,KAAM,UACN,MAAO,UACP,OAAQ,SACV,EAEaC,GAAa,CACxB,GAAGF,GACH,QAAS,CACP,KAAM,QACN,QAAS,CACP,KAAMC,GAAa,KACnB,MAAO,UACP,KAAM,UACN,aAAc,MACf,EACD,UAAW,CACT,KAAMA,GAAa,MACnB,MAAO,UACP,KAAM,UACN,aAAc,MACf,EACD,WAAY,CACV,QAAS,UACT,MAAO,SACR,EACD,KAAM,CACJ,QAASA,GAAa,OACtB,UAAWA,GAAa,OACzB,CACF,EACD,WAAY,CACV,SAAU,CACR,eAAgB,CACd,KAAM,CACJ,UAAW,uCACX,aAAc,EACf,CACF,CACF,EACD,UAAW,CACT,eAAgB,CACd,KAAM,CACJ,cAAe,OACf,WAAY,IACZ,aAAc,EACd,QAAS,UACV,EACD,UAAW,CACT,UAAW,OACX,UAAW,CACT,UAAW,oCACZ,CACF,CACF,CACF,EACD,UAAW,CACT,eAAgB,CACd,KAAM,CACJ,gBAAiBA,GAAa,IAC/B,CACF,CACF,CACF,CACH,EAEaE,GAAY,CACvB,GAAGH,GACH,QAAS,CACP,KAAM,OACN,QAAS,CACP,KAAMC,GAAa,MACnB,MAAO,UACP,KAAM,UACN,aAAc,MACf,EACD,UAAW,CACT,KAAMA,GAAa,QACnB,MAAO,UACP,KAAM,UACN,aAAc,MACf,EACD,WAAY,CACV,QAAS,UACT,MAAO,SACR,EACD,KAAM,CACJ,QAASA,GAAa,MACtB,UAAWG,GAAMH,GAAa,MAAO,EAAG,CACzC,CACF,EACD,WAAY,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","names":["m","require$$0","createRoot","supabaseUrl","supabaseAnonKey","supabase","createClient","AuthContext","createContext","AuthProvider","children","user","setUser","useState","loading","setLoading","useEffect","subscription","_event","session","signUp","email","password","signIn","signOut","value","useAuth","useContext","ProfileContext","useProfile","ProfileProvider","blogProfile","setBlogProfile","userProfile","setUserProfile","routeUsername","useParams","defaultUsername","location","useLocation","getFullLogoUrl","filename","fetchBlogProfile","username","data","error","fetchUserProfile","userId","getUsernameFromPath","pathParts","fetchProfiles","blogUsername","newBlogProfile","newUserProfile","InterestContext","useInterests","InterestProvider","interests","setInterests","effectiveUsername","userInterests","profile","profileError","jsx","baseTheme","autumnColors","lightTheme","darkTheme","alpha","ThemeContext","useTheme","ThemeProvider","darkMode","setDarkMode","stored","toggleDarkMode","prev","theme","useMemo","createTheme","jsxs","MuiThemeProvider","CssBaseline","default_format","formatters","v","RFC1738","is_array","hex_table","array","i","limit","encode","str","_defaultEncoder","charset","_kind","format","string","$0","out","j","segment","arr","c","is_buffer","obj","maybe_map","val","fn","mapped","has","array_prefix_generators","prefix","key","push","push_to_array","value_or_array","to_ISO","defaults","date","is_non_nullish_primitive","sentinel","inner_stringify","object","generateArrayPrefix","commaRoundTrip","allowEmptyArrays","strictNullHandling","skipNulls","encodeDotInKeys","encoder","filter","sort","allowDots","serializeDate","formatter","encodeValuesOnly","sideChannel","tmp_sc","step","find_flag","pos","key_value","values","obj_keys","keys","encoded_prefix","adjusted_prefix","encoded_key","key_prefix","valueSideChannel","normalize_stringify_options","opts","arrayFormat","stringify","options","joined","VERSION","auto","kind","fetch","FormData","File","ReadableStream","getMultipartRequestOptions","getDefaultAgent","fileFromPath","isFsReadStream","setShims","shims","MultipartBody","body","getRuntime","manuallyImported","recommendation","_fetch","_Request","_Response","_Headers","form","url","shims.kind","shims.setShims","auto.getRuntime","OpenAIError","APIError","status","message","headers","msg","errorResponse","APIConnectionError","castToError","BadRequestError","AuthenticationError","PermissionDeniedError","NotFoundError","ConflictError","UnprocessableEntityError","RateLimitError","InternalServerError","APIUserAbortError","cause","APIConnectionTimeoutError","LengthFinishReasonError","ContentFilterFinishReasonError","LineDecoder","chunk","text","trailingNewline","lines","bytes","Stream","iterator","controller","response","consumed","done","sse","_iterSSEMessages","e","readableStream","iterLines","lineDecoder","iter","readableStreamAsyncIterable","line","left","right","teeIterator","queue","result","self","ctrl","err","_a","sseDecoder","SSEDecoder","sseChunk","iterSSEChunks","binaryChunk","newData","patternIndex","findDoubleNewlineIndex","buffer","fieldname","_","partition","delimiter","index","stream","reader","cancelPromise","isResponseLike","isFileLike","isBlobLike","isUploadable","toFile","name","blob","bits","getBytes","getName","type","parts","isAsyncIterableIterator","propsForError","p","getStringFromMaybeBuffer","x","isMultipartBody","multipartFormRequestOptions","createForm","addFormValue","file","entry","prop","__classPrivateFieldSet","receiver","state","f","__classPrivateFieldGet","_AbstractPage_client","defaultParseResponse","props","debug","contentType","json","_addRequestID","APIPromise","responsePromise","parseResponse","resolve","transform","onfulfilled","onrejected","onfinally","APIClient","baseURL","maxRetries","timeout","httpAgent","overridenFetch","validatePositiveInteger","getPlatformHeaders","customHeaders","uuid4","path","method","Page","retryCount","query","contentLength","minAgentTimeout","reqHeaders","defaultHeaders","applyHeadersMut","shimsKind","getHeader","request","header","remainingRetries","optionsInput","retriesRemaining","req","_b","responseHeaders","createResponseHeaders","retryMessage","errText","errJSON","safeJSON","errMessage","PagePromise","isAbsoluteURL","defaultQuery","isEmptyObj","init","ms","signal","shouldRetryHeader","timeoutMillis","retryAfterMillisHeader","timeoutMs","retryAfterHeader","timeoutSeconds","sleep","numRetries","sleepSeconds","jitter","AbstractPage","client","nextInfo","nextOptions","params","page","item","target","requestOptionsKeys","isRequestOptions","k","hasOwn","getPlatformProperties","normalizePlatform","normalizeArch","browserInfo","getBrowserInfo","browserPatterns","pattern","match","major","minor","patch","arch","platform","_platformHeaders","startsWithSchemeRegexp","n","readEnv","env","define_process_env_default","_d","_c","_k","targetHeaders","newHeaders","lowerKey","action","args","r","isRunningInBrowser","isHeadersProtocol","lowerCasedHeader","intercapsHeader","_m","g1","g2","isObj","CursorPage","info","id","APIResource","CompletionsAPI.Completions","Chat","Completions","Speech","Transcriptions","Core.multipartFormRequestOptions","Translations","Audio","TranscriptionsAPI.Transcriptions","TranslationsAPI.Translations","SpeechAPI.Speech","Batches","batchId","BatchesPage","Assistants","assistantId","AssistantsPage","isRunnableFunctionWithParse","isAssistantMessage","isFunctionMessage","isToolMessage","_EventStream_instances","_EventStream_connectedPromise","_EventStream_resolveConnectedPromise","_EventStream_rejectConnectedPromise","_EventStream_endPromise","_EventStream_resolveEndPromise","_EventStream_rejectEndPromise","_EventStream_listeners","_EventStream_ended","_EventStream_errored","_EventStream_aborted","_EventStream_catchingPromiseCreated","_EventStream_handleError","EventStream","reject","executor","event","listener","listeners","l","openAIError","isAutoParsableResponseFormat","response_format","isAutoParsableTool","tool","maybeParseChatCompletion","completion","hasAutoParseableInput","choice","parseChatCompletion","choices","toolCall","parseToolCall","parseResponseFormat","content","inputTool","shouldParseToolCall","validateInputTools","tools","_AbstractChatCompletionRunner_instances","_AbstractChatCompletionRunner_getFinalContent","_AbstractChatCompletionRunner_getFinalMessage","_AbstractChatCompletionRunner_getFinalFunctionCall","_AbstractChatCompletionRunner_getFinalFunctionCallResult","_AbstractChatCompletionRunner_calculateTotalUsage","_AbstractChatCompletionRunner_validateParams","_AbstractChatCompletionRunner_stringifyFunctionCallResult","DEFAULT_MAX_CHAT_COMPLETIONS","AbstractChatCompletionRunner","chatCompletion","emit","tool_call","finalMessage","finalContent","finalFunctionCall","finalFunctionCallResult","role","function_call","restParams","singleFunctionToCall","maxChatCompletions","functionsByName","functions","parsed","rawContent","tool_choice","inputTools","t","tool_call_id","rest","ret","y","total","usage","ChatCompletionRunner","runner","STR","NUM","ARR","OBJ","NULL","BOOL","NAN","INFINITY","MINUS_INFINITY","INF","SPECIAL","ATOM","COLLECTION","ALL","Allow","PartialJSON","MalformedJSON","parseJSON","jsonString","allowPartial","_parseJSON","allow","length","markPartialJSON","throwMalformedError","parseAny","skipBlank","parseStr","parseObj","parseArr","parseNum","start","escape","partialParse","input","_ChatCompletionStream_instances","_ChatCompletionStream_params","_ChatCompletionStream_choiceEventStates","_ChatCompletionStream_currentChatCompletionSnapshot","_ChatCompletionStream_beginRequest","_ChatCompletionStream_getChoiceEventState","_ChatCompletionStream_addChunk","_ChatCompletionStream_emitToolCallDoneEvent","_ChatCompletionStream_emitContentDoneEvents","_ChatCompletionStream_endRequest","_ChatCompletionStream_getAutoParseableResponseFormat","_ChatCompletionStream_accumulateChatCompletion","ChatCompletionStream","chatId","choiceSnapshot","_e","_f","_g","_h","_i","_j","_l","toolCallDelta","toolCallSnapshot","_n","_o","toolCallIndex","responseFormat","snapshot","finalizeChatCompletion","delta","finish_reason","logprobs","other","refusal","tool_calls","pushQueue","readQueue","created","model","system_fingerprint","choiceRest","messageRest","toolRest","fnRest","ChatCompletionStreamingRunner","_AssistantStream_instances","_AssistantStream_events","_AssistantStream_runStepSnapshots","_AssistantStream_messageSnapshots","_AssistantStream_messageSnapshot","_AssistantStream_finalRun","_AssistantStream_currentContentIndex","_AssistantStream_currentContent","_AssistantStream_currentToolCallIndex","_AssistantStream_currentToolCall","_AssistantStream_currentEvent","_AssistantStream_currentRunSnapshot","_AssistantStream_currentRunStepSnapshot","_AssistantStream_addEvent","_AssistantStream_endRequest","_AssistantStream_handleMessage","_AssistantStream_handleRunStep","_AssistantStream_handleEvent","_AssistantStream_accumulateRunStep","_AssistantStream_accumulateMessage","_AssistantStream_accumulateContent","_AssistantStream_handleRun","AssistantStream","threadId","runId","runs","run","thread","acc","deltaValue","accValue","Core.isObj","deltaEntry","accEntry","accumulatedMessage","newContent","snapshotContent","textDelta","currentContent","accumulatedRunStep","accumulated","contentElement","Messages","messageId","MessagesPage","Steps","stepId","RunStepsPage","Runs","StepsAPI.Steps","include","RunsPage","sleepInterval","headerInterval","headerIntervalMs","Threads","RunsAPI.Runs","MessagesAPI.Messages","allSettledWithThrow","promises","results","rejected","vectorStoreId","fileId","VectorStoreFilesPage","fileResponse","fileInfo","Files","FileBatches","batch","files","fileIds","configuredConcurrency","concurrencyLimit","fileIterator","allFileIds","processFiles","fileObj","workers","VectorStores","FilesAPI.Files","FileBatchesAPI.FileBatches","VectorStoresPage","Beta","VectorStoresAPI.VectorStores","ChatAPI.Chat","AssistantsAPI.Assistants","ThreadsAPI.Threads","Embeddings","FileObjectsPage","pollInterval","maxWait","TERMINAL_STATES","Checkpoints","fineTuningJobId","FineTuningJobCheckpointsPage","Jobs","CheckpointsAPI.Checkpoints","FineTuningJobsPage","FineTuningJobEventsPage","FineTuning","JobsAPI.Jobs","Images","Models","ModelsPage","Moderations","Parts","uploadId","Uploads","PartsAPI.Parts","OpenAI","Core.APIClient","Core.readEnv","apiKey","organization","project","Errors.OpenAIError","Core.isRunningInBrowser","API.Completions","API.Chat","API.Embeddings","API.Files","API.Images","API.Audio","API.Moderations","API.Models","API.FineTuning","API.Beta","API.Batches","API.Uploads","qs.stringify","Errors.APIError","Errors.APIConnectionError","Errors.APIConnectionTimeoutError","Errors.APIUserAbortError","Errors.NotFoundError","Errors.ConflictError","Errors.RateLimitError","Errors.BadRequestError","Errors.AuthenticationError","Errors.InternalServerError","Errors.PermissionDeniedError","Errors.UnprocessableEntityError","Uploads.toFile","Uploads.fileFromPath","UploadsAPIUploads","OpenAIService","prompt","AnthropicService","mergedOptions","errorData","GrokService","PerplexityService","SerperService","requestOptions","sources","kg","kgText","search","STEP_SERVICES","AIContext","AIProvider","currentService","setCurrentService","services","setServices","setProfile","currentStep","setCurrentStep","loadProfile","serviceType","service","initializeService","getCurrentService","loadedProfile","useAI","context","AI_SERVICE_NAMES","ProtectedRoute","Navigate","Brightness4Icon","createSvgIcon","_jsx","Brightness7Icon","SettingsIcon","DescriptionIcon","Navbar","interestsLoading","profileLoading","currentUsername","manageAnchorEl","setManageAnchorEl","sortedInterests","a","b","handleManageClick","handleManageClose","activeProfile","isWelcomePage","logoUrl","AppBar","Toolbar","Stack","Button","Link","Box","interest","IconButton","Fragment","Menu","MenuItem","Welcome","useNavigate","Container","Grid","Typography","Paper","Home","lazy","Login","SignUp","ViewPost","CreatePost","EditPost","ManageInterests","InterestPage","UserProfile","Posts","Resume","PostWriter","RouteGuard","navigate","isPublicPath","App","BrowserRouter","Suspense","Routes","Route","StrictMode"],"ignoreList":[0,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,70,71,72,73],"sources":["../../node_modules/react-dom/client.js","../../src/lib/supabase.js","../../src/contexts/AuthContext.jsx","../../src/contexts/ProfileContext.jsx","../../src/contexts/InterestContext.jsx","../../src/theme.js","../../src/contexts/ThemeContext.jsx","../../node_modules/openai/internal/qs/formats.mjs","../../node_modules/openai/internal/qs/utils.mjs","../../node_modules/openai/internal/qs/stringify.mjs","../../node_modules/openai/version.mjs","../../node_modules/openai/_shims/registry.mjs","../../node_modules/openai/_shims/MultipartBody.mjs","../../node_modules/openai/_shims/web-runtime.mjs","../../node_modules/openai/_shims/index.mjs","../../node_modules/openai/error.mjs","../../node_modules/openai/internal/decoders/line.mjs","../../node_modules/openai/streaming.mjs","../../node_modules/openai/uploads.mjs","../../node_modules/openai/core.mjs","../../node_modules/openai/pagination.mjs","../../node_modules/openai/resource.mjs","../../node_modules/openai/resources/chat/completions.mjs","../../node_modules/openai/resources/chat/chat.mjs","../../node_modules/openai/resources/audio/speech.mjs","../../node_modules/openai/resources/audio/transcriptions.mjs","../../node_modules/openai/resources/audio/translations.mjs","../../node_modules/openai/resources/audio/audio.mjs","../../node_modules/openai/resources/batches.mjs","../../node_modules/openai/resources/beta/assistants.mjs","../../node_modules/openai/lib/RunnableFunction.mjs","../../node_modules/openai/lib/chatCompletionUtils.mjs","../../node_modules/openai/lib/EventStream.mjs","../../node_modules/openai/lib/parser.mjs","../../node_modules/openai/lib/AbstractChatCompletionRunner.mjs","../../node_modules/openai/lib/ChatCompletionRunner.mjs","../../node_modules/openai/_vendor/partial-json-parser/parser.mjs","../../node_modules/openai/lib/ChatCompletionStream.mjs","../../node_modules/openai/lib/ChatCompletionStreamingRunner.mjs","../../node_modules/openai/resources/beta/chat/completions.mjs","../../node_modules/openai/resources/beta/chat/chat.mjs","../../node_modules/openai/lib/AssistantStream.mjs","../../node_modules/openai/resources/beta/threads/messages.mjs","../../node_modules/openai/resources/beta/threads/runs/steps.mjs","../../node_modules/openai/resources/beta/threads/runs/runs.mjs","../../node_modules/openai/resources/beta/threads/threads.mjs","../../node_modules/openai/lib/Util.mjs","../../node_modules/openai/resources/beta/vector-stores/files.mjs","../../node_modules/openai/resources/beta/vector-stores/file-batches.mjs","../../node_modules/openai/resources/beta/vector-stores/vector-stores.mjs","../../node_modules/openai/resources/beta/beta.mjs","../../node_modules/openai/resources/completions.mjs","../../node_modules/openai/resources/embeddings.mjs","../../node_modules/openai/resources/files.mjs","../../node_modules/openai/resources/fine-tuning/jobs/checkpoints.mjs","../../node_modules/openai/resources/fine-tuning/jobs/jobs.mjs","../../node_modules/openai/resources/fine-tuning/fine-tuning.mjs","../../node_modules/openai/resources/images.mjs","../../node_modules/openai/resources/models.mjs","../../node_modules/openai/resources/moderations.mjs","../../node_modules/openai/resources/uploads/parts.mjs","../../node_modules/openai/resources/uploads/uploads.mjs","../../node_modules/openai/index.mjs","../../src/services/ai/openai.js","../../src/services/ai/anthropic.js","../../src/services/ai/grok.js","../../src/services/ai/perplexity.js","../../src/services/ai/serper.js","../../src/services/ai/index.jsx","../../src/components/ProtectedRoute.jsx","../../node_modules/@mui/icons-material/esm/Brightness4.js","../../node_modules/@mui/icons-material/esm/Brightness7.js","../../node_modules/@mui/icons-material/esm/Settings.js","../../node_modules/@mui/icons-material/esm/Description.js","../../src/components/Navbar.jsx","../../src/components/Welcome.jsx","../../src/App.jsx","../../src/main.jsx"],"sourcesContent":["'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","import { createClient } from '@supabase/supabase-js'\n\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL\nconst supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error('Missing Supabase environment variables')\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: true\n  }\n})","import { createContext, useContext, useEffect, useState } from 'react'\nimport { supabase } from '../lib/supabase'\n\nconst AuthContext = createContext({})\n\nexport function AuthProvider({ children }) {\n  const [user, setUser] = useState(null)\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    // Listen for auth state changes\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {\n      setUser(session?.user ?? null)\n      setLoading(false)\n    })\n\n    // Get initial session\n    supabase.auth.getSession().then(({ data: { session } }) => {\n      setUser(session?.user ?? null)\n      setLoading(false)\n    })\n\n    return () => subscription.unsubscribe()\n  }, [])\n\n  async function signUp({ email, password }) {\n    return await supabase.auth.signUp({\n      email,\n      password,\n    })\n  }\n\n  async function signIn({ email, password }) {\n    return await supabase.auth.signInWithPassword({\n      email,\n      password,\n    })\n  }\n\n  async function signOut() {\n    return await supabase.auth.signOut()\n  }\n\n  const value = {\n    user,\n    loading,\n    signUp,\n    signIn,\n    signOut\n  }\n\n  return (\n    <AuthContext.Provider value={value}>\n      {!loading && children}\n    </AuthContext.Provider>\n  )\n}\n\nexport const useAuth = () => {\n  return useContext(AuthContext)\n} ","import { createContext, useContext, useState, useEffect } from 'react'\nimport { useParams, useLocation } from 'react-router-dom'\nimport { supabase } from '../lib/supabase'\nimport { useAuth } from './AuthContext'\n\nconst ProfileContext = createContext()\n\nexport function useProfile() {\n  return useContext(ProfileContext)\n}\n\nexport function ProfileProvider({ children }) {\n  const [blogProfile, setBlogProfile] = useState(null)\n  const [userProfile, setUserProfile] = useState(null)\n  const [loading, setLoading] = useState(true)\n  const { username: routeUsername } = useParams()\n  const { user } = useAuth()\n  const defaultUsername = import.meta.env.VITE_DEFAULT_USERNAME\n  const location = useLocation()\n\n  const getFullLogoUrl = (filename) => {\n    if (!filename || filename === 'null' || filename === 'undefined') return '/images/gg-logo.jpg'\n    if (filename.startsWith('http')) return filename\n    if (filename.startsWith('data:')) return filename\n    return `${import.meta.env.VITE_SUPABASE_URL}/storage/v1/object/public/profile_logos/${filename}`\n  }\n\n  // Fetch the blog profile (based on URL)\n  const fetchBlogProfile = async (username) => {\n    try {\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('username', username)\n        .single()\n\n      if (error) throw error\n      return data\n    } catch (error) {\n      return null\n    }\n  }\n\n  // Fetch the user profile (based on auth)\n  const fetchUserProfile = async (userId) => {\n    try {\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('id', userId)\n        .single()\n\n      if (error) throw error\n      return data\n    } catch (error) {\n      return null\n    }\n  }\n\n  // Get username from path if not available from useParams\n  const getUsernameFromPath = () => {\n    const pathParts = location.pathname.split('/').filter(Boolean)\n    return pathParts[0] === 'login' || pathParts[0] === 'signup' \n      ? defaultUsername \n      : pathParts[0]\n  }\n\n  // Fetch both profiles when needed\n  const fetchProfiles = async () => {\n    try {\n      setLoading(true)\n      const effectiveUsername = routeUsername || getUsernameFromPath()\n\n      // Get blog profile from route username or default\n      const blogUsername = effectiveUsername || defaultUsername\n      const newBlogProfile = await fetchBlogProfile(blogUsername)\n      setBlogProfile(newBlogProfile)\n\n      // Get user profile if logged in\n      const newUserProfile = user ? await fetchUserProfile(user.id) : null\n      setUserProfile(newUserProfile)\n\n    } catch (error) {\n      setBlogProfile(null)\n      setUserProfile(null)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  useEffect(() => {\n    fetchProfiles()\n  }, [routeUsername, user?.id, location.pathname])\n\n  const value = {\n    // The profile being viewed (from URL)\n    blogProfile,\n    // The logged-in user's profile\n    userProfile,\n    loading,\n    fetchProfiles,\n    isDefaultProfile: routeUsername === defaultUsername,\n    // For backward compatibility\n    profile: blogProfile,\n    currentUsername: routeUsername || getUsernameFromPath() || blogProfile?.username || userProfile?.username || defaultUsername,\n    getFullLogoUrl // Export the URL helper function\n  }\n\n  return (\n    <ProfileContext.Provider value={value}>\n      {children}\n    </ProfileContext.Provider>\n  )\n}\n","import { createContext, useContext, useState, useEffect } from 'react'\nimport { useParams, useLocation } from 'react-router-dom'\nimport { supabase } from '../lib/supabase'\nimport { useProfile } from './ProfileContext'\n\nconst InterestContext = createContext()\n\nexport function useInterests() {\n  return useContext(InterestContext)\n}\n\nexport function InterestProvider({ children }) {\n  const [interests, setInterests] = useState([])\n  const [loading, setLoading] = useState(true)\n  const { username: routeUsername } = useParams()\n  const { blogProfile } = useProfile()\n  const location = useLocation()\n\n  // Get username from path if not available from useParams\n  const getUsernameFromPath = () => {\n    const pathParts = location.pathname.split('/').filter(Boolean)\n    return pathParts[0]\n  }\n\n  useEffect(() => {\n    const effectiveUsername = routeUsername || getUsernameFromPath()\n    \n    // If we have a blog profile, use its ID directly\n    if (blogProfile?.id) {\n      setLoading(true)\n      \n      const fetchInterestsForProfile = async () => {\n        try {\n          const { data: userInterests, error } = await supabase\n            .from('interests')\n            .select('*')\n            .eq('user_id', blogProfile.id)\n            .order('sequence', { ascending: true })\n            .order('title')\n\n          if (error) {\n            setInterests([])\n          } else {\n            setInterests(userInterests || [])\n          }\n        } catch (error) {\n          setInterests([])\n        } finally {\n          setLoading(false)\n        }\n      }\n      \n      fetchInterestsForProfile()\n      return\n    }\n    \n    // If we don't have a blog profile but have a username, fetch the profile first\n    if (effectiveUsername) {\n      setLoading(true)\n      \n      const fetchProfileAndInterests = async () => {\n        try {\n          // Get the profile ID\n          const { data: profile, error: profileError } = await supabase\n            .from('profiles')\n            .select('id')\n            .ilike('username', effectiveUsername)\n            .single()\n\n          if (profileError || !profile) {\n            setInterests([])\n            return\n          }\n\n          // Get the interests\n          const { data: userInterests, error } = await supabase\n            .from('interests')\n            .select('*')\n            .eq('user_id', profile.id)\n            .order('sequence', { ascending: true })\n            .order('title')\n\n          if (error) {\n            setInterests([])\n          } else {\n            setInterests(userInterests || [])\n          }\n        } catch (error) {\n          setInterests([])\n        } finally {\n          setLoading(false)\n        }\n      }\n\n      fetchProfileAndInterests()\n      return\n    }\n\n    // If we have neither, clear interests\n    setInterests([])\n    setLoading(false)\n  }, [routeUsername, blogProfile, location.pathname])\n\n  const value = {\n    interests,\n    loading,\n    fetchInterests: async () => {\n      const effectiveUsername = routeUsername || getUsernameFromPath()\n      if (blogProfile?.id) {\n        const { data, error } = await supabase\n          .from('interests')\n          .select('*')\n          .eq('user_id', blogProfile.id)\n          .order('sequence', { ascending: true })\n          .order('title')\n        \n        if (error) {\n          return []\n        }\n        return data || []\n      } else if (effectiveUsername) {\n        const { data: profile } = await supabase\n          .from('profiles')\n          .select('id')\n          .ilike('username', effectiveUsername)\n          .single()\n        \n        if (profile?.id) {\n          const { data, error } = await supabase\n            .from('interests')\n            .select('*')\n            .eq('user_id', profile.id)\n            .order('sequence', { ascending: true })\n            .order('title')\n          \n          if (error) {\n            return []\n          }\n          return data || []\n        }\n      }\n      return []\n    }\n  }\n\n  return (\n    <InterestContext.Provider value={value}>\n      {children}\n    </InterestContext.Provider>\n  )\n}\n","import { alpha } from '@mui/material/styles'\n\nconst baseTheme = {\n  typography: {\n    fontFamily: '\"Inter\", \"Roboto\", \"Helvetica\", \"Arial\", sans-serif',\n    h1: {\n      fontSize: '2.5rem',\n      fontWeight: 700,\n      letterSpacing: '-0.01562em',\n      marginBottom: '1rem',\n    },\n    h2: {\n      fontSize: '2rem',\n      fontWeight: 600,\n      letterSpacing: '-0.00833em',\n      marginBottom: '0.875rem',\n    },\n    h3: {\n      fontSize: '1.75rem',\n      fontWeight: 600,\n      letterSpacing: '0em',\n      marginBottom: '0.75rem',\n    },\n    h4: {\n      fontSize: '1.5rem',\n      fontWeight: 600,\n      letterSpacing: '0.00735em',\n      marginBottom: '0.625rem',\n    },\n    h5: {\n      fontSize: '1.25rem',\n      fontWeight: 600,\n      letterSpacing: '0em',\n      marginBottom: '0.5rem',\n    },\n    h6: {\n      fontSize: '1.125rem',\n      fontWeight: 600,\n      letterSpacing: '0.0075em',\n      marginBottom: '0.5rem',\n    },\n    body1: {\n      fontSize: '1rem',\n      lineHeight: 1.6,\n    },\n    body2: {\n      fontSize: '0.875rem',\n      lineHeight: 1.6,\n    },\n  },\n  shape: {\n    borderRadius: 8,\n  },\n}\n\n// Autumn color palette\nconst autumnColors = {\n  russet: '#8B4513', // Deep brown\n  maple: '#D2691E',  // Warm orange-brown\n  harvest: '#CD853F', // Golden brown\n  sage: '#556B2F',   // Deep olive green\n  wheat: '#F5DEB3',  // Light warm beige\n  auburn: '#A0522D', // Rich reddish-brown\n}\n\nexport const lightTheme = {\n  ...baseTheme,\n  palette: {\n    mode: 'light',\n    primary: {\n      main: autumnColors.sage,\n      light: '#6B8E23', // Lighter sage\n      dark: '#3B4A1F',  // Darker sage\n      contrastText: '#fff',\n    },\n    secondary: {\n      main: autumnColors.maple,\n      light: '#FF7F50', // Lighter orange-brown\n      dark: '#8B4513', // Darker brown\n      contrastText: '#fff',\n    },\n    background: {\n      default: '#FAF9F6', // Warm off-white\n      paper: '#FFFFFF',\n    },\n    text: {\n      primary: autumnColors.russet,\n      secondary: autumnColors.harvest,\n    },\n  },\n  components: {\n    MuiPaper: {\n      styleOverrides: {\n        root: {\n          boxShadow: '0 2px 12px 0 rgba(139, 69, 19, 0.05)',\n          borderRadius: 12,\n        },\n      },\n    },\n    MuiButton: {\n      styleOverrides: {\n        root: {\n          textTransform: 'none',\n          fontWeight: 600,\n          borderRadius: 8,\n          padding: '8px 20px',\n        },\n        contained: {\n          boxShadow: 'none',\n          '&:hover': {\n            boxShadow: '0 2px 8px 0 rgba(139, 69, 19, 0.2)',\n          },\n        },\n      },\n    },\n    MuiAppBar: {\n      styleOverrides: {\n        root: {\n          backgroundColor: autumnColors.sage,\n        },\n      },\n    },\n  },\n}\n\nexport const darkTheme = {\n  ...baseTheme,\n  palette: {\n    mode: 'dark',\n    primary: {\n      main: autumnColors.maple,\n      light: '#FF7F50', // Lighter orange-brown\n      dark: '#8B4513', // Darker brown\n      contrastText: '#fff',\n    },\n    secondary: {\n      main: autumnColors.harvest,\n      light: '#DEB887', // Lighter golden brown\n      dark: '#8B5A2B', // Darker golden brown\n      contrastText: '#fff',\n    },\n    background: {\n      default: '#2C1810', // Deep brown background\n      paper: '#3D2317', // Slightly lighter brown\n    },\n    text: {\n      primary: autumnColors.wheat,\n      secondary: alpha(autumnColors.wheat, 0.7),\n    },\n  },\n  components: {\n    MuiPaper: {\n      styleOverrides: {\n        root: {\n          boxShadow: '0 2px 12px 0 rgba(0,0,0,0.2)',\n          borderRadius: 12,\n          backgroundColor: '#3D2317',\n        },\n      },\n    },\n    MuiButton: {\n      styleOverrides: {\n        root: {\n          textTransform: 'none',\n          fontWeight: 600,\n          borderRadius: 8,\n          padding: '8px 20px',\n        },\n        contained: {\n          boxShadow: 'none',\n          '&:hover': {\n            boxShadow: '0 2px 8px 0 rgba(0,0,0,0.3)',\n          },\n        },\n      },\n    },\n    MuiAppBar: {\n      styleOverrides: {\n        root: {\n          backgroundColor: '#2C1810',\n        },\n      },\n    },\n  },\n}","import { createContext, useContext, useState, useMemo, useEffect } from 'react'\nimport { ThemeProvider as MuiThemeProvider, CssBaseline } from '@mui/material'\nimport { createTheme } from '@mui/material/styles'\nimport { lightTheme, darkTheme } from '../theme'\n\nconst ThemeContext = createContext()\n\nexport function useTheme() {\n  return useContext(ThemeContext)\n}\n\nexport function ThemeProvider({ children }) {\n  const [darkMode, setDarkMode] = useState(() => {\n    const stored = localStorage.getItem('darkMode')\n    return stored ? JSON.parse(stored) : false\n  })\n\n  useEffect(() => {\n    localStorage.setItem('darkMode', JSON.stringify(darkMode))\n  }, [darkMode])\n\n  const toggleDarkMode = () => {\n    setDarkMode(prev => !prev)\n  }\n\n  const theme = useMemo(\n    () => createTheme(darkMode ? darkTheme : lightTheme),\n    [darkMode]\n  )\n\n  const value = {\n    darkMode,\n    toggleDarkMode\n  }\n\n  return (\n    <ThemeContext.Provider value={value}>\n      <MuiThemeProvider theme={theme}>\n        <CssBaseline />\n        {children}\n      </MuiThemeProvider>\n    </ThemeContext.Provider>\n  )\n} ","export const default_format = 'RFC3986';\nexport const formatters = {\n    RFC1738: (v) => String(v).replace(/%20/g, '+'),\n    RFC3986: (v) => String(v),\n};\nexport const RFC1738 = 'RFC1738';\nexport const RFC3986 = 'RFC3986';\n//# sourceMappingURL=formats.mjs.map","import { RFC1738 } from \"./formats.mjs\";\nconst has = Object.prototype.hasOwnProperty;\nconst is_array = Array.isArray;\nconst hex_table = (() => {\n    const array = [];\n    for (let i = 0; i < 256; ++i) {\n        array.push('%' + ((i < 16 ? '0' : '') + i.toString(16)).toUpperCase());\n    }\n    return array;\n})();\nfunction compact_queue(queue) {\n    while (queue.length > 1) {\n        const item = queue.pop();\n        if (!item)\n            continue;\n        const obj = item.obj[item.prop];\n        if (is_array(obj)) {\n            const compacted = [];\n            for (let j = 0; j < obj.length; ++j) {\n                if (typeof obj[j] !== 'undefined') {\n                    compacted.push(obj[j]);\n                }\n            }\n            // @ts-ignore\n            item.obj[item.prop] = compacted;\n        }\n    }\n}\nfunction array_to_object(source, options) {\n    const obj = options && options.plainObjects ? Object.create(null) : {};\n    for (let i = 0; i < source.length; ++i) {\n        if (typeof source[i] !== 'undefined') {\n            obj[i] = source[i];\n        }\n    }\n    return obj;\n}\nexport function merge(target, source, options = {}) {\n    if (!source) {\n        return target;\n    }\n    if (typeof source !== 'object') {\n        if (is_array(target)) {\n            target.push(source);\n        }\n        else if (target && typeof target === 'object') {\n            if ((options && (options.plainObjects || options.allowPrototypes)) ||\n                !has.call(Object.prototype, source)) {\n                target[source] = true;\n            }\n        }\n        else {\n            return [target, source];\n        }\n        return target;\n    }\n    if (!target || typeof target !== 'object') {\n        return [target].concat(source);\n    }\n    let mergeTarget = target;\n    if (is_array(target) && !is_array(source)) {\n        // @ts-ignore\n        mergeTarget = array_to_object(target, options);\n    }\n    if (is_array(target) && is_array(source)) {\n        source.forEach(function (item, i) {\n            if (has.call(target, i)) {\n                const targetItem = target[i];\n                if (targetItem && typeof targetItem === 'object' && item && typeof item === 'object') {\n                    target[i] = merge(targetItem, item, options);\n                }\n                else {\n                    target.push(item);\n                }\n            }\n            else {\n                target[i] = item;\n            }\n        });\n        return target;\n    }\n    return Object.keys(source).reduce(function (acc, key) {\n        const value = source[key];\n        if (has.call(acc, key)) {\n            acc[key] = merge(acc[key], value, options);\n        }\n        else {\n            acc[key] = value;\n        }\n        return acc;\n    }, mergeTarget);\n}\nexport function assign_single_source(target, source) {\n    return Object.keys(source).reduce(function (acc, key) {\n        acc[key] = source[key];\n        return acc;\n    }, target);\n}\nexport function decode(str, _, charset) {\n    const strWithoutPlus = str.replace(/\\+/g, ' ');\n    if (charset === 'iso-8859-1') {\n        // unescape never throws, no try...catch needed:\n        return strWithoutPlus.replace(/%[0-9a-f]{2}/gi, unescape);\n    }\n    // utf-8\n    try {\n        return decodeURIComponent(strWithoutPlus);\n    }\n    catch (e) {\n        return strWithoutPlus;\n    }\n}\nconst limit = 1024;\nexport const encode = (str, _defaultEncoder, charset, _kind, format) => {\n    // This code was originally written by Brian White for the io.js core querystring library.\n    // It has been adapted here for stricter adherence to RFC 3986\n    if (str.length === 0) {\n        return str;\n    }\n    let string = str;\n    if (typeof str === 'symbol') {\n        string = Symbol.prototype.toString.call(str);\n    }\n    else if (typeof str !== 'string') {\n        string = String(str);\n    }\n    if (charset === 'iso-8859-1') {\n        return escape(string).replace(/%u[0-9a-f]{4}/gi, function ($0) {\n            return '%26%23' + parseInt($0.slice(2), 16) + '%3B';\n        });\n    }\n    let out = '';\n    for (let j = 0; j < string.length; j += limit) {\n        const segment = string.length >= limit ? string.slice(j, j + limit) : string;\n        const arr = [];\n        for (let i = 0; i < segment.length; ++i) {\n            let c = segment.charCodeAt(i);\n            if (c === 0x2d || // -\n                c === 0x2e || // .\n                c === 0x5f || // _\n                c === 0x7e || // ~\n                (c >= 0x30 && c <= 0x39) || // 0-9\n                (c >= 0x41 && c <= 0x5a) || // a-z\n                (c >= 0x61 && c <= 0x7a) || // A-Z\n                (format === RFC1738 && (c === 0x28 || c === 0x29)) // ( )\n            ) {\n                arr[arr.length] = segment.charAt(i);\n                continue;\n            }\n            if (c < 0x80) {\n                arr[arr.length] = hex_table[c];\n                continue;\n            }\n            if (c < 0x800) {\n                arr[arr.length] = hex_table[0xc0 | (c >> 6)] + hex_table[0x80 | (c & 0x3f)];\n                continue;\n            }\n            if (c < 0xd800 || c >= 0xe000) {\n                arr[arr.length] =\n                    hex_table[0xe0 | (c >> 12)] + hex_table[0x80 | ((c >> 6) & 0x3f)] + hex_table[0x80 | (c & 0x3f)];\n                continue;\n            }\n            i += 1;\n            c = 0x10000 + (((c & 0x3ff) << 10) | (segment.charCodeAt(i) & 0x3ff));\n            arr[arr.length] =\n                hex_table[0xf0 | (c >> 18)] +\n                    hex_table[0x80 | ((c >> 12) & 0x3f)] +\n                    hex_table[0x80 | ((c >> 6) & 0x3f)] +\n                    hex_table[0x80 | (c & 0x3f)];\n        }\n        out += arr.join('');\n    }\n    return out;\n};\nexport function compact(value) {\n    const queue = [{ obj: { o: value }, prop: 'o' }];\n    const refs = [];\n    for (let i = 0; i < queue.length; ++i) {\n        const item = queue[i];\n        // @ts-ignore\n        const obj = item.obj[item.prop];\n        const keys = Object.keys(obj);\n        for (let j = 0; j < keys.length; ++j) {\n            const key = keys[j];\n            const val = obj[key];\n            if (typeof val === 'object' && val !== null && refs.indexOf(val) === -1) {\n                queue.push({ obj: obj, prop: key });\n                refs.push(val);\n            }\n        }\n    }\n    compact_queue(queue);\n    return value;\n}\nexport function is_regexp(obj) {\n    return Object.prototype.toString.call(obj) === '[object RegExp]';\n}\nexport function is_buffer(obj) {\n    if (!obj || typeof obj !== 'object') {\n        return false;\n    }\n    return !!(obj.constructor && obj.constructor.isBuffer && obj.constructor.isBuffer(obj));\n}\nexport function combine(a, b) {\n    return [].concat(a, b);\n}\nexport function maybe_map(val, fn) {\n    if (is_array(val)) {\n        const mapped = [];\n        for (let i = 0; i < val.length; i += 1) {\n            mapped.push(fn(val[i]));\n        }\n        return mapped;\n    }\n    return fn(val);\n}\n//# sourceMappingURL=utils.mjs.map","import { encode, is_buffer, maybe_map } from \"./utils.mjs\";\nimport { default_format, formatters } from \"./formats.mjs\";\nconst has = Object.prototype.hasOwnProperty;\nconst array_prefix_generators = {\n    brackets(prefix) {\n        return String(prefix) + '[]';\n    },\n    comma: 'comma',\n    indices(prefix, key) {\n        return String(prefix) + '[' + key + ']';\n    },\n    repeat(prefix) {\n        return String(prefix);\n    },\n};\nconst is_array = Array.isArray;\nconst push = Array.prototype.push;\nconst push_to_array = function (arr, value_or_array) {\n    push.apply(arr, is_array(value_or_array) ? value_or_array : [value_or_array]);\n};\nconst to_ISO = Date.prototype.toISOString;\nconst defaults = {\n    addQueryPrefix: false,\n    allowDots: false,\n    allowEmptyArrays: false,\n    arrayFormat: 'indices',\n    charset: 'utf-8',\n    charsetSentinel: false,\n    delimiter: '&',\n    encode: true,\n    encodeDotInKeys: false,\n    encoder: encode,\n    encodeValuesOnly: false,\n    format: default_format,\n    formatter: formatters[default_format],\n    /** @deprecated */\n    indices: false,\n    serializeDate(date) {\n        return to_ISO.call(date);\n    },\n    skipNulls: false,\n    strictNullHandling: false,\n};\nfunction is_non_nullish_primitive(v) {\n    return (typeof v === 'string' ||\n        typeof v === 'number' ||\n        typeof v === 'boolean' ||\n        typeof v === 'symbol' ||\n        typeof v === 'bigint');\n}\nconst sentinel = {};\nfunction inner_stringify(object, prefix, generateArrayPrefix, commaRoundTrip, allowEmptyArrays, strictNullHandling, skipNulls, encodeDotInKeys, encoder, filter, sort, allowDots, serializeDate, format, formatter, encodeValuesOnly, charset, sideChannel) {\n    let obj = object;\n    let tmp_sc = sideChannel;\n    let step = 0;\n    let find_flag = false;\n    while ((tmp_sc = tmp_sc.get(sentinel)) !== void undefined && !find_flag) {\n        // Where object last appeared in the ref tree\n        const pos = tmp_sc.get(object);\n        step += 1;\n        if (typeof pos !== 'undefined') {\n            if (pos === step) {\n                throw new RangeError('Cyclic object value');\n            }\n            else {\n                find_flag = true; // Break while\n            }\n        }\n        if (typeof tmp_sc.get(sentinel) === 'undefined') {\n            step = 0;\n        }\n    }\n    if (typeof filter === 'function') {\n        obj = filter(prefix, obj);\n    }\n    else if (obj instanceof Date) {\n        obj = serializeDate?.(obj);\n    }\n    else if (generateArrayPrefix === 'comma' && is_array(obj)) {\n        obj = maybe_map(obj, function (value) {\n            if (value instanceof Date) {\n                return serializeDate?.(value);\n            }\n            return value;\n        });\n    }\n    if (obj === null) {\n        if (strictNullHandling) {\n            return encoder && !encodeValuesOnly ?\n                // @ts-expect-error\n                encoder(prefix, defaults.encoder, charset, 'key', format)\n                : prefix;\n        }\n        obj = '';\n    }\n    if (is_non_nullish_primitive(obj) || is_buffer(obj)) {\n        if (encoder) {\n            const key_value = encodeValuesOnly ? prefix\n                // @ts-expect-error\n                : encoder(prefix, defaults.encoder, charset, 'key', format);\n            return [\n                formatter?.(key_value) +\n                    '=' +\n                    // @ts-expect-error\n                    formatter?.(encoder(obj, defaults.encoder, charset, 'value', format)),\n            ];\n        }\n        return [formatter?.(prefix) + '=' + formatter?.(String(obj))];\n    }\n    const values = [];\n    if (typeof obj === 'undefined') {\n        return values;\n    }\n    let obj_keys;\n    if (generateArrayPrefix === 'comma' && is_array(obj)) {\n        // we need to join elements in\n        if (encodeValuesOnly && encoder) {\n            // @ts-expect-error values only\n            obj = maybe_map(obj, encoder);\n        }\n        obj_keys = [{ value: obj.length > 0 ? obj.join(',') || null : void undefined }];\n    }\n    else if (is_array(filter)) {\n        obj_keys = filter;\n    }\n    else {\n        const keys = Object.keys(obj);\n        obj_keys = sort ? keys.sort(sort) : keys;\n    }\n    const encoded_prefix = encodeDotInKeys ? String(prefix).replace(/\\./g, '%2E') : String(prefix);\n    const adjusted_prefix = commaRoundTrip && is_array(obj) && obj.length === 1 ? encoded_prefix + '[]' : encoded_prefix;\n    if (allowEmptyArrays && is_array(obj) && obj.length === 0) {\n        return adjusted_prefix + '[]';\n    }\n    for (let j = 0; j < obj_keys.length; ++j) {\n        const key = obj_keys[j];\n        const value = \n        // @ts-ignore\n        typeof key === 'object' && typeof key.value !== 'undefined' ? key.value : obj[key];\n        if (skipNulls && value === null) {\n            continue;\n        }\n        // @ts-ignore\n        const encoded_key = allowDots && encodeDotInKeys ? key.replace(/\\./g, '%2E') : key;\n        const key_prefix = is_array(obj) ?\n            typeof generateArrayPrefix === 'function' ?\n                generateArrayPrefix(adjusted_prefix, encoded_key)\n                : adjusted_prefix\n            : adjusted_prefix + (allowDots ? '.' + encoded_key : '[' + encoded_key + ']');\n        sideChannel.set(object, step);\n        const valueSideChannel = new WeakMap();\n        valueSideChannel.set(sentinel, sideChannel);\n        push_to_array(values, inner_stringify(value, key_prefix, generateArrayPrefix, commaRoundTrip, allowEmptyArrays, strictNullHandling, skipNulls, encodeDotInKeys, \n        // @ts-ignore\n        generateArrayPrefix === 'comma' && encodeValuesOnly && is_array(obj) ? null : encoder, filter, sort, allowDots, serializeDate, format, formatter, encodeValuesOnly, charset, valueSideChannel));\n    }\n    return values;\n}\nfunction normalize_stringify_options(opts = defaults) {\n    if (typeof opts.allowEmptyArrays !== 'undefined' && typeof opts.allowEmptyArrays !== 'boolean') {\n        throw new TypeError('`allowEmptyArrays` option can only be `true` or `false`, when provided');\n    }\n    if (typeof opts.encodeDotInKeys !== 'undefined' && typeof opts.encodeDotInKeys !== 'boolean') {\n        throw new TypeError('`encodeDotInKeys` option can only be `true` or `false`, when provided');\n    }\n    if (opts.encoder !== null && typeof opts.encoder !== 'undefined' && typeof opts.encoder !== 'function') {\n        throw new TypeError('Encoder has to be a function.');\n    }\n    const charset = opts.charset || defaults.charset;\n    if (typeof opts.charset !== 'undefined' && opts.charset !== 'utf-8' && opts.charset !== 'iso-8859-1') {\n        throw new TypeError('The charset option must be either utf-8, iso-8859-1, or undefined');\n    }\n    let format = default_format;\n    if (typeof opts.format !== 'undefined') {\n        if (!has.call(formatters, opts.format)) {\n            throw new TypeError('Unknown format option provided.');\n        }\n        format = opts.format;\n    }\n    const formatter = formatters[format];\n    let filter = defaults.filter;\n    if (typeof opts.filter === 'function' || is_array(opts.filter)) {\n        filter = opts.filter;\n    }\n    let arrayFormat;\n    if (opts.arrayFormat && opts.arrayFormat in array_prefix_generators) {\n        arrayFormat = opts.arrayFormat;\n    }\n    else if ('indices' in opts) {\n        arrayFormat = opts.indices ? 'indices' : 'repeat';\n    }\n    else {\n        arrayFormat = defaults.arrayFormat;\n    }\n    if ('commaRoundTrip' in opts && typeof opts.commaRoundTrip !== 'boolean') {\n        throw new TypeError('`commaRoundTrip` must be a boolean, or absent');\n    }\n    const allowDots = typeof opts.allowDots === 'undefined' ?\n        !!opts.encodeDotInKeys === true ?\n            true\n            : defaults.allowDots\n        : !!opts.allowDots;\n    return {\n        addQueryPrefix: typeof opts.addQueryPrefix === 'boolean' ? opts.addQueryPrefix : defaults.addQueryPrefix,\n        // @ts-ignore\n        allowDots: allowDots,\n        allowEmptyArrays: typeof opts.allowEmptyArrays === 'boolean' ? !!opts.allowEmptyArrays : defaults.allowEmptyArrays,\n        arrayFormat: arrayFormat,\n        charset: charset,\n        charsetSentinel: typeof opts.charsetSentinel === 'boolean' ? opts.charsetSentinel : defaults.charsetSentinel,\n        commaRoundTrip: !!opts.commaRoundTrip,\n        delimiter: typeof opts.delimiter === 'undefined' ? defaults.delimiter : opts.delimiter,\n        encode: typeof opts.encode === 'boolean' ? opts.encode : defaults.encode,\n        encodeDotInKeys: typeof opts.encodeDotInKeys === 'boolean' ? opts.encodeDotInKeys : defaults.encodeDotInKeys,\n        encoder: typeof opts.encoder === 'function' ? opts.encoder : defaults.encoder,\n        encodeValuesOnly: typeof opts.encodeValuesOnly === 'boolean' ? opts.encodeValuesOnly : defaults.encodeValuesOnly,\n        filter: filter,\n        format: format,\n        formatter: formatter,\n        serializeDate: typeof opts.serializeDate === 'function' ? opts.serializeDate : defaults.serializeDate,\n        skipNulls: typeof opts.skipNulls === 'boolean' ? opts.skipNulls : defaults.skipNulls,\n        // @ts-ignore\n        sort: typeof opts.sort === 'function' ? opts.sort : null,\n        strictNullHandling: typeof opts.strictNullHandling === 'boolean' ? opts.strictNullHandling : defaults.strictNullHandling,\n    };\n}\nexport function stringify(object, opts = {}) {\n    let obj = object;\n    const options = normalize_stringify_options(opts);\n    let obj_keys;\n    let filter;\n    if (typeof options.filter === 'function') {\n        filter = options.filter;\n        obj = filter('', obj);\n    }\n    else if (is_array(options.filter)) {\n        filter = options.filter;\n        obj_keys = filter;\n    }\n    const keys = [];\n    if (typeof obj !== 'object' || obj === null) {\n        return '';\n    }\n    const generateArrayPrefix = array_prefix_generators[options.arrayFormat];\n    const commaRoundTrip = generateArrayPrefix === 'comma' && options.commaRoundTrip;\n    if (!obj_keys) {\n        obj_keys = Object.keys(obj);\n    }\n    if (options.sort) {\n        obj_keys.sort(options.sort);\n    }\n    const sideChannel = new WeakMap();\n    for (let i = 0; i < obj_keys.length; ++i) {\n        const key = obj_keys[i];\n        if (options.skipNulls && obj[key] === null) {\n            continue;\n        }\n        push_to_array(keys, inner_stringify(obj[key], key, \n        // @ts-expect-error\n        generateArrayPrefix, commaRoundTrip, options.allowEmptyArrays, options.strictNullHandling, options.skipNulls, options.encodeDotInKeys, options.encode ? options.encoder : null, options.filter, options.sort, options.allowDots, options.serializeDate, options.format, options.formatter, options.encodeValuesOnly, options.charset, sideChannel));\n    }\n    const joined = keys.join(options.delimiter);\n    let prefix = options.addQueryPrefix === true ? '?' : '';\n    if (options.charsetSentinel) {\n        if (options.charset === 'iso-8859-1') {\n            // encodeURIComponent('&#10003;'), the \"numeric entity\" representation of a checkmark\n            prefix += 'utf8=%26%2310003%3B&';\n        }\n        else {\n            // encodeURIComponent('✓')\n            prefix += 'utf8=%E2%9C%93&';\n        }\n    }\n    return joined.length > 0 ? prefix + joined : '';\n}\n//# sourceMappingURL=stringify.mjs.map","export const VERSION = '4.73.1'; // x-release-please-version\n//# sourceMappingURL=version.mjs.map","export let auto = false;\nexport let kind = undefined;\nexport let fetch = undefined;\nexport let Request = undefined;\nexport let Response = undefined;\nexport let Headers = undefined;\nexport let FormData = undefined;\nexport let Blob = undefined;\nexport let File = undefined;\nexport let ReadableStream = undefined;\nexport let getMultipartRequestOptions = undefined;\nexport let getDefaultAgent = undefined;\nexport let fileFromPath = undefined;\nexport let isFsReadStream = undefined;\nexport function setShims(shims, options = { auto: false }) {\n    if (auto) {\n        throw new Error(`you must \\`import 'openai/shims/${shims.kind}'\\` before importing anything else from openai`);\n    }\n    if (kind) {\n        throw new Error(`can't \\`import 'openai/shims/${shims.kind}'\\` after \\`import 'openai/shims/${kind}'\\``);\n    }\n    auto = options.auto;\n    kind = shims.kind;\n    fetch = shims.fetch;\n    Request = shims.Request;\n    Response = shims.Response;\n    Headers = shims.Headers;\n    FormData = shims.FormData;\n    Blob = shims.Blob;\n    File = shims.File;\n    ReadableStream = shims.ReadableStream;\n    getMultipartRequestOptions = shims.getMultipartRequestOptions;\n    getDefaultAgent = shims.getDefaultAgent;\n    fileFromPath = shims.fileFromPath;\n    isFsReadStream = shims.isFsReadStream;\n}\n//# sourceMappingURL=registry.mjs.map","/**\n * Disclaimer: modules in _shims aren't intended to be imported by SDK users.\n */\nexport class MultipartBody {\n    constructor(body) {\n        this.body = body;\n    }\n    get [Symbol.toStringTag]() {\n        return 'MultipartBody';\n    }\n}\n//# sourceMappingURL=MultipartBody.mjs.map","import { MultipartBody } from \"./MultipartBody.mjs\";\nexport function getRuntime({ manuallyImported } = {}) {\n    const recommendation = manuallyImported ?\n        `You may need to use polyfills`\n        : `Add one of these imports before your first \\`import … from 'openai'\\`:\n- \\`import 'openai/shims/node'\\` (if you're running on Node)\n- \\`import 'openai/shims/web'\\` (otherwise)\n`;\n    let _fetch, _Request, _Response, _Headers;\n    try {\n        // @ts-ignore\n        _fetch = fetch;\n        // @ts-ignore\n        _Request = Request;\n        // @ts-ignore\n        _Response = Response;\n        // @ts-ignore\n        _Headers = Headers;\n    }\n    catch (error) {\n        throw new Error(`this environment is missing the following Web Fetch API type: ${error.message}. ${recommendation}`);\n    }\n    return {\n        kind: 'web',\n        fetch: _fetch,\n        Request: _Request,\n        Response: _Response,\n        Headers: _Headers,\n        FormData: \n        // @ts-ignore\n        typeof FormData !== 'undefined' ? FormData : (class FormData {\n            // @ts-ignore\n            constructor() {\n                throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${recommendation}`);\n            }\n        }),\n        Blob: typeof Blob !== 'undefined' ? Blob : (class Blob {\n            constructor() {\n                throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${recommendation}`);\n            }\n        }),\n        File: \n        // @ts-ignore\n        typeof File !== 'undefined' ? File : (class File {\n            // @ts-ignore\n            constructor() {\n                throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${recommendation}`);\n            }\n        }),\n        ReadableStream: \n        // @ts-ignore\n        typeof ReadableStream !== 'undefined' ? ReadableStream : (class ReadableStream {\n            // @ts-ignore\n            constructor() {\n                throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${recommendation}`);\n            }\n        }),\n        getMultipartRequestOptions: async (\n        // @ts-ignore\n        form, opts) => ({\n            ...opts,\n            body: new MultipartBody(form),\n        }),\n        getDefaultAgent: (url) => undefined,\n        fileFromPath: () => {\n            throw new Error('The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads');\n        },\n        isFsReadStream: (value) => false,\n    };\n}\n//# sourceMappingURL=web-runtime.mjs.map","/**\n * Disclaimer: modules in _shims aren't intended to be imported by SDK users.\n */\nimport * as shims from './registry.mjs';\nimport * as auto from 'openai/_shims/auto/runtime';\nif (!shims.kind) shims.setShims(auto.getRuntime(), { auto: true });\nexport * from './registry.mjs';\n","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { castToError } from \"./core.mjs\";\nexport class OpenAIError extends Error {\n}\nexport class APIError extends OpenAIError {\n    constructor(status, error, message, headers) {\n        super(`${APIError.makeMessage(status, error, message)}`);\n        this.status = status;\n        this.headers = headers;\n        this.request_id = headers?.['x-request-id'];\n        const data = error;\n        this.error = data;\n        this.code = data?.['code'];\n        this.param = data?.['param'];\n        this.type = data?.['type'];\n    }\n    static makeMessage(status, error, message) {\n        const msg = error?.message ?\n            typeof error.message === 'string' ?\n                error.message\n                : JSON.stringify(error.message)\n            : error ? JSON.stringify(error)\n                : message;\n        if (status && msg) {\n            return `${status} ${msg}`;\n        }\n        if (status) {\n            return `${status} status code (no body)`;\n        }\n        if (msg) {\n            return msg;\n        }\n        return '(no status code or body)';\n    }\n    static generate(status, errorResponse, message, headers) {\n        if (!status) {\n            return new APIConnectionError({ message, cause: castToError(errorResponse) });\n        }\n        const error = errorResponse?.['error'];\n        if (status === 400) {\n            return new BadRequestError(status, error, message, headers);\n        }\n        if (status === 401) {\n            return new AuthenticationError(status, error, message, headers);\n        }\n        if (status === 403) {\n            return new PermissionDeniedError(status, error, message, headers);\n        }\n        if (status === 404) {\n            return new NotFoundError(status, error, message, headers);\n        }\n        if (status === 409) {\n            return new ConflictError(status, error, message, headers);\n        }\n        if (status === 422) {\n            return new UnprocessableEntityError(status, error, message, headers);\n        }\n        if (status === 429) {\n            return new RateLimitError(status, error, message, headers);\n        }\n        if (status >= 500) {\n            return new InternalServerError(status, error, message, headers);\n        }\n        return new APIError(status, error, message, headers);\n    }\n}\nexport class APIUserAbortError extends APIError {\n    constructor({ message } = {}) {\n        super(undefined, undefined, message || 'Request was aborted.', undefined);\n        this.status = undefined;\n    }\n}\nexport class APIConnectionError extends APIError {\n    constructor({ message, cause }) {\n        super(undefined, undefined, message || 'Connection error.', undefined);\n        this.status = undefined;\n        // in some environments the 'cause' property is already declared\n        // @ts-ignore\n        if (cause)\n            this.cause = cause;\n    }\n}\nexport class APIConnectionTimeoutError extends APIConnectionError {\n    constructor({ message } = {}) {\n        super({ message: message ?? 'Request timed out.' });\n    }\n}\nexport class BadRequestError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 400;\n    }\n}\nexport class AuthenticationError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 401;\n    }\n}\nexport class PermissionDeniedError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 403;\n    }\n}\nexport class NotFoundError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 404;\n    }\n}\nexport class ConflictError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 409;\n    }\n}\nexport class UnprocessableEntityError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 422;\n    }\n}\nexport class RateLimitError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 429;\n    }\n}\nexport class InternalServerError extends APIError {\n}\nexport class LengthFinishReasonError extends OpenAIError {\n    constructor() {\n        super(`Could not parse response content as the length limit was reached`);\n    }\n}\nexport class ContentFilterFinishReasonError extends OpenAIError {\n    constructor() {\n        super(`Could not parse response content as the request was rejected by the content filter`);\n    }\n}\n//# sourceMappingURL=error.mjs.map","import { OpenAIError } from \"../../error.mjs\";\n/**\n * A re-implementation of httpx's `LineDecoder` in Python that handles incrementally\n * reading lines from text.\n *\n * https://github.com/encode/httpx/blob/920333ea98118e9cf617f246905d7b202510941c/httpx/_decoders.py#L258\n */\nexport class LineDecoder {\n    constructor() {\n        this.buffer = [];\n        this.trailingCR = false;\n    }\n    decode(chunk) {\n        let text = this.decodeText(chunk);\n        if (this.trailingCR) {\n            text = '\\r' + text;\n            this.trailingCR = false;\n        }\n        if (text.endsWith('\\r')) {\n            this.trailingCR = true;\n            text = text.slice(0, -1);\n        }\n        if (!text) {\n            return [];\n        }\n        const trailingNewline = LineDecoder.NEWLINE_CHARS.has(text[text.length - 1] || '');\n        let lines = text.split(LineDecoder.NEWLINE_REGEXP);\n        // if there is a trailing new line then the last entry will be an empty\n        // string which we don't care about\n        if (trailingNewline) {\n            lines.pop();\n        }\n        if (lines.length === 1 && !trailingNewline) {\n            this.buffer.push(lines[0]);\n            return [];\n        }\n        if (this.buffer.length > 0) {\n            lines = [this.buffer.join('') + lines[0], ...lines.slice(1)];\n            this.buffer = [];\n        }\n        if (!trailingNewline) {\n            this.buffer = [lines.pop() || ''];\n        }\n        return lines;\n    }\n    decodeText(bytes) {\n        if (bytes == null)\n            return '';\n        if (typeof bytes === 'string')\n            return bytes;\n        // Node:\n        if (typeof Buffer !== 'undefined') {\n            if (bytes instanceof Buffer) {\n                return bytes.toString();\n            }\n            if (bytes instanceof Uint8Array) {\n                return Buffer.from(bytes).toString();\n            }\n            throw new OpenAIError(`Unexpected: received non-Uint8Array (${bytes.constructor.name}) stream chunk in an environment with a global \"Buffer\" defined, which this library assumes to be Node. Please report this error.`);\n        }\n        // Browser\n        if (typeof TextDecoder !== 'undefined') {\n            if (bytes instanceof Uint8Array || bytes instanceof ArrayBuffer) {\n                this.textDecoder ?? (this.textDecoder = new TextDecoder('utf8'));\n                return this.textDecoder.decode(bytes);\n            }\n            throw new OpenAIError(`Unexpected: received non-Uint8Array/ArrayBuffer (${bytes.constructor.name}) in a web platform. Please report this error.`);\n        }\n        throw new OpenAIError(`Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.`);\n    }\n    flush() {\n        if (!this.buffer.length && !this.trailingCR) {\n            return [];\n        }\n        const lines = [this.buffer.join('')];\n        this.buffer = [];\n        this.trailingCR = false;\n        return lines;\n    }\n}\n// prettier-ignore\nLineDecoder.NEWLINE_CHARS = new Set(['\\n', '\\r']);\nLineDecoder.NEWLINE_REGEXP = /\\r\\n|[\\n\\r]/g;\n//# sourceMappingURL=line.mjs.map","import { ReadableStream } from \"./_shims/index.mjs\";\nimport { OpenAIError } from \"./error.mjs\";\nimport { LineDecoder } from \"./internal/decoders/line.mjs\";\nimport { APIError } from \"./error.mjs\";\nexport class Stream {\n    constructor(iterator, controller) {\n        this.iterator = iterator;\n        this.controller = controller;\n    }\n    static fromSSEResponse(response, controller) {\n        let consumed = false;\n        async function* iterator() {\n            if (consumed) {\n                throw new Error('Cannot iterate over a consumed stream, use `.tee()` to split the stream.');\n            }\n            consumed = true;\n            let done = false;\n            try {\n                for await (const sse of _iterSSEMessages(response, controller)) {\n                    if (done)\n                        continue;\n                    if (sse.data.startsWith('[DONE]')) {\n                        done = true;\n                        continue;\n                    }\n                    if (sse.event === null) {\n                        let data;\n                        try {\n                            data = JSON.parse(sse.data);\n                        }\n                        catch (e) {\n                            console.error(`Could not parse message into JSON:`, sse.data);\n                            console.error(`From chunk:`, sse.raw);\n                            throw e;\n                        }\n                        if (data && data.error) {\n                            throw new APIError(undefined, data.error, undefined, undefined);\n                        }\n                        yield data;\n                    }\n                    else {\n                        let data;\n                        try {\n                            data = JSON.parse(sse.data);\n                        }\n                        catch (e) {\n                            console.error(`Could not parse message into JSON:`, sse.data);\n                            console.error(`From chunk:`, sse.raw);\n                            throw e;\n                        }\n                        // TODO: Is this where the error should be thrown?\n                        if (sse.event == 'error') {\n                            throw new APIError(undefined, data.error, data.message, undefined);\n                        }\n                        yield { event: sse.event, data: data };\n                    }\n                }\n                done = true;\n            }\n            catch (e) {\n                // If the user calls `stream.controller.abort()`, we should exit without throwing.\n                if (e instanceof Error && e.name === 'AbortError')\n                    return;\n                throw e;\n            }\n            finally {\n                // If the user `break`s, abort the ongoing request.\n                if (!done)\n                    controller.abort();\n            }\n        }\n        return new Stream(iterator, controller);\n    }\n    /**\n     * Generates a Stream from a newline-separated ReadableStream\n     * where each item is a JSON value.\n     */\n    static fromReadableStream(readableStream, controller) {\n        let consumed = false;\n        async function* iterLines() {\n            const lineDecoder = new LineDecoder();\n            const iter = readableStreamAsyncIterable(readableStream);\n            for await (const chunk of iter) {\n                for (const line of lineDecoder.decode(chunk)) {\n                    yield line;\n                }\n            }\n            for (const line of lineDecoder.flush()) {\n                yield line;\n            }\n        }\n        async function* iterator() {\n            if (consumed) {\n                throw new Error('Cannot iterate over a consumed stream, use `.tee()` to split the stream.');\n            }\n            consumed = true;\n            let done = false;\n            try {\n                for await (const line of iterLines()) {\n                    if (done)\n                        continue;\n                    if (line)\n                        yield JSON.parse(line);\n                }\n                done = true;\n            }\n            catch (e) {\n                // If the user calls `stream.controller.abort()`, we should exit without throwing.\n                if (e instanceof Error && e.name === 'AbortError')\n                    return;\n                throw e;\n            }\n            finally {\n                // If the user `break`s, abort the ongoing request.\n                if (!done)\n                    controller.abort();\n            }\n        }\n        return new Stream(iterator, controller);\n    }\n    [Symbol.asyncIterator]() {\n        return this.iterator();\n    }\n    /**\n     * Splits the stream into two streams which can be\n     * independently read from at different speeds.\n     */\n    tee() {\n        const left = [];\n        const right = [];\n        const iterator = this.iterator();\n        const teeIterator = (queue) => {\n            return {\n                next: () => {\n                    if (queue.length === 0) {\n                        const result = iterator.next();\n                        left.push(result);\n                        right.push(result);\n                    }\n                    return queue.shift();\n                },\n            };\n        };\n        return [\n            new Stream(() => teeIterator(left), this.controller),\n            new Stream(() => teeIterator(right), this.controller),\n        ];\n    }\n    /**\n     * Converts this stream to a newline-separated ReadableStream of\n     * JSON stringified values in the stream\n     * which can be turned back into a Stream with `Stream.fromReadableStream()`.\n     */\n    toReadableStream() {\n        const self = this;\n        let iter;\n        const encoder = new TextEncoder();\n        return new ReadableStream({\n            async start() {\n                iter = self[Symbol.asyncIterator]();\n            },\n            async pull(ctrl) {\n                try {\n                    const { value, done } = await iter.next();\n                    if (done)\n                        return ctrl.close();\n                    const bytes = encoder.encode(JSON.stringify(value) + '\\n');\n                    ctrl.enqueue(bytes);\n                }\n                catch (err) {\n                    ctrl.error(err);\n                }\n            },\n            async cancel() {\n                await iter.return?.();\n            },\n        });\n    }\n}\nexport async function* _iterSSEMessages(response, controller) {\n    if (!response.body) {\n        controller.abort();\n        throw new OpenAIError(`Attempted to iterate over a response with no body`);\n    }\n    const sseDecoder = new SSEDecoder();\n    const lineDecoder = new LineDecoder();\n    const iter = readableStreamAsyncIterable(response.body);\n    for await (const sseChunk of iterSSEChunks(iter)) {\n        for (const line of lineDecoder.decode(sseChunk)) {\n            const sse = sseDecoder.decode(line);\n            if (sse)\n                yield sse;\n        }\n    }\n    for (const line of lineDecoder.flush()) {\n        const sse = sseDecoder.decode(line);\n        if (sse)\n            yield sse;\n    }\n}\n/**\n * Given an async iterable iterator, iterates over it and yields full\n * SSE chunks, i.e. yields when a double new-line is encountered.\n */\nasync function* iterSSEChunks(iterator) {\n    let data = new Uint8Array();\n    for await (const chunk of iterator) {\n        if (chunk == null) {\n            continue;\n        }\n        const binaryChunk = chunk instanceof ArrayBuffer ? new Uint8Array(chunk)\n            : typeof chunk === 'string' ? new TextEncoder().encode(chunk)\n                : chunk;\n        let newData = new Uint8Array(data.length + binaryChunk.length);\n        newData.set(data);\n        newData.set(binaryChunk, data.length);\n        data = newData;\n        let patternIndex;\n        while ((patternIndex = findDoubleNewlineIndex(data)) !== -1) {\n            yield data.slice(0, patternIndex);\n            data = data.slice(patternIndex);\n        }\n    }\n    if (data.length > 0) {\n        yield data;\n    }\n}\nfunction findDoubleNewlineIndex(buffer) {\n    // This function searches the buffer for the end patterns (\\r\\r, \\n\\n, \\r\\n\\r\\n)\n    // and returns the index right after the first occurrence of any pattern,\n    // or -1 if none of the patterns are found.\n    const newline = 0x0a; // \\n\n    const carriage = 0x0d; // \\r\n    for (let i = 0; i < buffer.length - 2; i++) {\n        if (buffer[i] === newline && buffer[i + 1] === newline) {\n            // \\n\\n\n            return i + 2;\n        }\n        if (buffer[i] === carriage && buffer[i + 1] === carriage) {\n            // \\r\\r\n            return i + 2;\n        }\n        if (buffer[i] === carriage &&\n            buffer[i + 1] === newline &&\n            i + 3 < buffer.length &&\n            buffer[i + 2] === carriage &&\n            buffer[i + 3] === newline) {\n            // \\r\\n\\r\\n\n            return i + 4;\n        }\n    }\n    return -1;\n}\nclass SSEDecoder {\n    constructor() {\n        this.event = null;\n        this.data = [];\n        this.chunks = [];\n    }\n    decode(line) {\n        if (line.endsWith('\\r')) {\n            line = line.substring(0, line.length - 1);\n        }\n        if (!line) {\n            // empty line and we didn't previously encounter any messages\n            if (!this.event && !this.data.length)\n                return null;\n            const sse = {\n                event: this.event,\n                data: this.data.join('\\n'),\n                raw: this.chunks,\n            };\n            this.event = null;\n            this.data = [];\n            this.chunks = [];\n            return sse;\n        }\n        this.chunks.push(line);\n        if (line.startsWith(':')) {\n            return null;\n        }\n        let [fieldname, _, value] = partition(line, ':');\n        if (value.startsWith(' ')) {\n            value = value.substring(1);\n        }\n        if (fieldname === 'event') {\n            this.event = value;\n        }\n        else if (fieldname === 'data') {\n            this.data.push(value);\n        }\n        return null;\n    }\n}\n/** This is an internal helper function that's just used for testing */\nexport function _decodeChunks(chunks) {\n    const decoder = new LineDecoder();\n    const lines = [];\n    for (const chunk of chunks) {\n        lines.push(...decoder.decode(chunk));\n    }\n    return lines;\n}\nfunction partition(str, delimiter) {\n    const index = str.indexOf(delimiter);\n    if (index !== -1) {\n        return [str.substring(0, index), delimiter, str.substring(index + delimiter.length)];\n    }\n    return [str, '', ''];\n}\n/**\n * Most browsers don't yet have async iterable support for ReadableStream,\n * and Node has a very different way of reading bytes from its \"ReadableStream\".\n *\n * This polyfill was pulled from https://github.com/MattiasBuelens/web-streams-polyfill/pull/122#issuecomment-1627354490\n */\nexport function readableStreamAsyncIterable(stream) {\n    if (stream[Symbol.asyncIterator])\n        return stream;\n    const reader = stream.getReader();\n    return {\n        async next() {\n            try {\n                const result = await reader.read();\n                if (result?.done)\n                    reader.releaseLock(); // release lock when stream becomes closed\n                return result;\n            }\n            catch (e) {\n                reader.releaseLock(); // release lock when stream becomes errored\n                throw e;\n            }\n        },\n        async return() {\n            const cancelPromise = reader.cancel();\n            reader.releaseLock();\n            await cancelPromise;\n            return { done: true, value: undefined };\n        },\n        [Symbol.asyncIterator]() {\n            return this;\n        },\n    };\n}\n//# sourceMappingURL=streaming.mjs.map","import { FormData, File, getMultipartRequestOptions, isFsReadStream, } from \"./_shims/index.mjs\";\nexport { fileFromPath } from \"./_shims/index.mjs\";\nexport const isResponseLike = (value) => value != null &&\n    typeof value === 'object' &&\n    typeof value.url === 'string' &&\n    typeof value.blob === 'function';\nexport const isFileLike = (value) => value != null &&\n    typeof value === 'object' &&\n    typeof value.name === 'string' &&\n    typeof value.lastModified === 'number' &&\n    isBlobLike(value);\n/**\n * The BlobLike type omits arrayBuffer() because @types/node-fetch@^2.6.4 lacks it; but this check\n * adds the arrayBuffer() method type because it is available and used at runtime\n */\nexport const isBlobLike = (value) => value != null &&\n    typeof value === 'object' &&\n    typeof value.size === 'number' &&\n    typeof value.type === 'string' &&\n    typeof value.text === 'function' &&\n    typeof value.slice === 'function' &&\n    typeof value.arrayBuffer === 'function';\nexport const isUploadable = (value) => {\n    return isFileLike(value) || isResponseLike(value) || isFsReadStream(value);\n};\n/**\n * Helper for creating a {@link File} to pass to an SDK upload method from a variety of different data formats\n * @param value the raw content of the file.  Can be an {@link Uploadable}, {@link BlobLikePart}, or {@link AsyncIterable} of {@link BlobLikePart}s\n * @param {string=} name the name of the file. If omitted, toFile will try to determine a file name from bits if possible\n * @param {Object=} options additional properties\n * @param {string=} options.type the MIME type of the content\n * @param {number=} options.lastModified the last modified timestamp\n * @returns a {@link File} with the given properties\n */\nexport async function toFile(value, name, options) {\n    // If it's a promise, resolve it.\n    value = await value;\n    // If we've been given a `File` we don't need to do anything\n    if (isFileLike(value)) {\n        return value;\n    }\n    if (isResponseLike(value)) {\n        const blob = await value.blob();\n        name || (name = new URL(value.url).pathname.split(/[\\\\/]/).pop() ?? 'unknown_file');\n        // we need to convert the `Blob` into an array buffer because the `Blob` class\n        // that `node-fetch` defines is incompatible with the web standard which results\n        // in `new File` interpreting it as a string instead of binary data.\n        const data = isBlobLike(blob) ? [(await blob.arrayBuffer())] : [blob];\n        return new File(data, name, options);\n    }\n    const bits = await getBytes(value);\n    name || (name = getName(value) ?? 'unknown_file');\n    if (!options?.type) {\n        const type = bits[0]?.type;\n        if (typeof type === 'string') {\n            options = { ...options, type };\n        }\n    }\n    return new File(bits, name, options);\n}\nasync function getBytes(value) {\n    let parts = [];\n    if (typeof value === 'string' ||\n        ArrayBuffer.isView(value) || // includes Uint8Array, Buffer, etc.\n        value instanceof ArrayBuffer) {\n        parts.push(value);\n    }\n    else if (isBlobLike(value)) {\n        parts.push(await value.arrayBuffer());\n    }\n    else if (isAsyncIterableIterator(value) // includes Readable, ReadableStream, etc.\n    ) {\n        for await (const chunk of value) {\n            parts.push(chunk); // TODO, consider validating?\n        }\n    }\n    else {\n        throw new Error(`Unexpected data type: ${typeof value}; constructor: ${value?.constructor\n            ?.name}; props: ${propsForError(value)}`);\n    }\n    return parts;\n}\nfunction propsForError(value) {\n    const props = Object.getOwnPropertyNames(value);\n    return `[${props.map((p) => `\"${p}\"`).join(', ')}]`;\n}\nfunction getName(value) {\n    return (getStringFromMaybeBuffer(value.name) ||\n        getStringFromMaybeBuffer(value.filename) ||\n        // For fs.ReadStream\n        getStringFromMaybeBuffer(value.path)?.split(/[\\\\/]/).pop());\n}\nconst getStringFromMaybeBuffer = (x) => {\n    if (typeof x === 'string')\n        return x;\n    if (typeof Buffer !== 'undefined' && x instanceof Buffer)\n        return String(x);\n    return undefined;\n};\nconst isAsyncIterableIterator = (value) => value != null && typeof value === 'object' && typeof value[Symbol.asyncIterator] === 'function';\nexport const isMultipartBody = (body) => body && typeof body === 'object' && body.body && body[Symbol.toStringTag] === 'MultipartBody';\n/**\n * Returns a multipart/form-data request if any part of the given request body contains a File / Blob value.\n * Otherwise returns the request as is.\n */\nexport const maybeMultipartFormRequestOptions = async (opts) => {\n    if (!hasUploadableValue(opts.body))\n        return opts;\n    const form = await createForm(opts.body);\n    return getMultipartRequestOptions(form, opts);\n};\nexport const multipartFormRequestOptions = async (opts) => {\n    const form = await createForm(opts.body);\n    return getMultipartRequestOptions(form, opts);\n};\nexport const createForm = async (body) => {\n    const form = new FormData();\n    await Promise.all(Object.entries(body || {}).map(([key, value]) => addFormValue(form, key, value)));\n    return form;\n};\nconst hasUploadableValue = (value) => {\n    if (isUploadable(value))\n        return true;\n    if (Array.isArray(value))\n        return value.some(hasUploadableValue);\n    if (value && typeof value === 'object') {\n        for (const k in value) {\n            if (hasUploadableValue(value[k]))\n                return true;\n        }\n    }\n    return false;\n};\nconst addFormValue = async (form, key, value) => {\n    if (value === undefined)\n        return;\n    if (value == null) {\n        throw new TypeError(`Received null for \"${key}\"; to pass null in FormData, you must use the string 'null'`);\n    }\n    // TODO: make nested formats configurable\n    if (typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean') {\n        form.append(key, String(value));\n    }\n    else if (isUploadable(value)) {\n        const file = await toFile(value);\n        form.append(key, file);\n    }\n    else if (Array.isArray(value)) {\n        await Promise.all(value.map((entry) => addFormValue(form, key + '[]', entry)));\n    }\n    else if (typeof value === 'object') {\n        await Promise.all(Object.entries(value).map(([name, prop]) => addFormValue(form, `${key}[${name}]`, prop)));\n    }\n    else {\n        throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${value} instead`);\n    }\n};\n//# sourceMappingURL=uploads.mjs.map","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _AbstractPage_client;\nimport { VERSION } from \"./version.mjs\";\nimport { Stream } from \"./streaming.mjs\";\nimport { OpenAIError, APIError, APIConnectionError, APIConnectionTimeoutError, APIUserAbortError, } from \"./error.mjs\";\nimport { kind as shimsKind, getDefaultAgent, fetch, } from \"./_shims/index.mjs\";\nimport { isBlobLike, isMultipartBody } from \"./uploads.mjs\";\nexport { maybeMultipartFormRequestOptions, multipartFormRequestOptions, createForm, } from \"./uploads.mjs\";\nasync function defaultParseResponse(props) {\n    const { response } = props;\n    if (props.options.stream) {\n        debug('response', response.status, response.url, response.headers, response.body);\n        // Note: there is an invariant here that isn't represented in the type system\n        // that if you set `stream: true` the response type must also be `Stream<T>`\n        if (props.options.__streamClass) {\n            return props.options.__streamClass.fromSSEResponse(response, props.controller);\n        }\n        return Stream.fromSSEResponse(response, props.controller);\n    }\n    // fetch refuses to read the body when the status code is 204.\n    if (response.status === 204) {\n        return null;\n    }\n    if (props.options.__binaryResponse) {\n        return response;\n    }\n    const contentType = response.headers.get('content-type');\n    const isJSON = contentType?.includes('application/json') || contentType?.includes('application/vnd.api+json');\n    if (isJSON) {\n        const json = await response.json();\n        debug('response', response.status, response.url, response.headers, json);\n        return _addRequestID(json, response);\n    }\n    const text = await response.text();\n    debug('response', response.status, response.url, response.headers, text);\n    // TODO handle blob, arraybuffer, other content types, etc.\n    return text;\n}\nfunction _addRequestID(value, response) {\n    if (!value || typeof value !== 'object' || Array.isArray(value)) {\n        return value;\n    }\n    return Object.defineProperty(value, '_request_id', {\n        value: response.headers.get('x-request-id'),\n        enumerable: false,\n    });\n}\n/**\n * A subclass of `Promise` providing additional helper methods\n * for interacting with the SDK.\n */\nexport class APIPromise extends Promise {\n    constructor(responsePromise, parseResponse = defaultParseResponse) {\n        super((resolve) => {\n            // this is maybe a bit weird but this has to be a no-op to not implicitly\n            // parse the response body; instead .then, .catch, .finally are overridden\n            // to parse the response\n            resolve(null);\n        });\n        this.responsePromise = responsePromise;\n        this.parseResponse = parseResponse;\n    }\n    _thenUnwrap(transform) {\n        return new APIPromise(this.responsePromise, async (props) => _addRequestID(transform(await this.parseResponse(props), props), props.response));\n    }\n    /**\n     * Gets the raw `Response` instance instead of parsing the response\n     * data.\n     *\n     * If you want to parse the response body but still get the `Response`\n     * instance, you can use {@link withResponse()}.\n     *\n     * 👋 Getting the wrong TypeScript type for `Response`?\n     * Try setting `\"moduleResolution\": \"NodeNext\"` if you can,\n     * or add one of these imports before your first `import … from 'openai'`:\n     * - `import 'openai/shims/node'` (if you're running on Node)\n     * - `import 'openai/shims/web'` (otherwise)\n     */\n    asResponse() {\n        return this.responsePromise.then((p) => p.response);\n    }\n    /**\n     * Gets the parsed response data, the raw `Response` instance and the ID of the request,\n     * returned via the X-Request-ID header which is useful for debugging requests and reporting\n     * issues to OpenAI.\n     *\n     * If you just want to get the raw `Response` instance without parsing it,\n     * you can use {@link asResponse()}.\n     *\n     *\n     * 👋 Getting the wrong TypeScript type for `Response`?\n     * Try setting `\"moduleResolution\": \"NodeNext\"` if you can,\n     * or add one of these imports before your first `import … from 'openai'`:\n     * - `import 'openai/shims/node'` (if you're running on Node)\n     * - `import 'openai/shims/web'` (otherwise)\n     */\n    async withResponse() {\n        const [data, response] = await Promise.all([this.parse(), this.asResponse()]);\n        return { data, response, request_id: response.headers.get('x-request-id') };\n    }\n    parse() {\n        if (!this.parsedPromise) {\n            this.parsedPromise = this.responsePromise.then(this.parseResponse);\n        }\n        return this.parsedPromise;\n    }\n    then(onfulfilled, onrejected) {\n        return this.parse().then(onfulfilled, onrejected);\n    }\n    catch(onrejected) {\n        return this.parse().catch(onrejected);\n    }\n    finally(onfinally) {\n        return this.parse().finally(onfinally);\n    }\n}\nexport class APIClient {\n    constructor({ baseURL, maxRetries = 2, timeout = 600000, // 10 minutes\n    httpAgent, fetch: overridenFetch, }) {\n        this.baseURL = baseURL;\n        this.maxRetries = validatePositiveInteger('maxRetries', maxRetries);\n        this.timeout = validatePositiveInteger('timeout', timeout);\n        this.httpAgent = httpAgent;\n        this.fetch = overridenFetch ?? fetch;\n    }\n    authHeaders(opts) {\n        return {};\n    }\n    /**\n     * Override this to add your own default headers, for example:\n     *\n     *  {\n     *    ...super.defaultHeaders(),\n     *    Authorization: 'Bearer 123',\n     *  }\n     */\n    defaultHeaders(opts) {\n        return {\n            Accept: 'application/json',\n            'Content-Type': 'application/json',\n            'User-Agent': this.getUserAgent(),\n            ...getPlatformHeaders(),\n            ...this.authHeaders(opts),\n        };\n    }\n    /**\n     * Override this to add your own headers validation:\n     */\n    validateHeaders(headers, customHeaders) { }\n    defaultIdempotencyKey() {\n        return `stainless-node-retry-${uuid4()}`;\n    }\n    get(path, opts) {\n        return this.methodRequest('get', path, opts);\n    }\n    post(path, opts) {\n        return this.methodRequest('post', path, opts);\n    }\n    patch(path, opts) {\n        return this.methodRequest('patch', path, opts);\n    }\n    put(path, opts) {\n        return this.methodRequest('put', path, opts);\n    }\n    delete(path, opts) {\n        return this.methodRequest('delete', path, opts);\n    }\n    methodRequest(method, path, opts) {\n        return this.request(Promise.resolve(opts).then(async (opts) => {\n            const body = opts && isBlobLike(opts?.body) ? new DataView(await opts.body.arrayBuffer())\n                : opts?.body instanceof DataView ? opts.body\n                    : opts?.body instanceof ArrayBuffer ? new DataView(opts.body)\n                        : opts && ArrayBuffer.isView(opts?.body) ? new DataView(opts.body.buffer)\n                            : opts?.body;\n            return { method, path, ...opts, body };\n        }));\n    }\n    getAPIList(path, Page, opts) {\n        return this.requestAPIList(Page, { method: 'get', path, ...opts });\n    }\n    calculateContentLength(body) {\n        if (typeof body === 'string') {\n            if (typeof Buffer !== 'undefined') {\n                return Buffer.byteLength(body, 'utf8').toString();\n            }\n            if (typeof TextEncoder !== 'undefined') {\n                const encoder = new TextEncoder();\n                const encoded = encoder.encode(body);\n                return encoded.length.toString();\n            }\n        }\n        else if (ArrayBuffer.isView(body)) {\n            return body.byteLength.toString();\n        }\n        return null;\n    }\n    buildRequest(options, { retryCount = 0 } = {}) {\n        const { method, path, query, headers: headers = {} } = options;\n        const body = ArrayBuffer.isView(options.body) || (options.__binaryRequest && typeof options.body === 'string') ?\n            options.body\n            : isMultipartBody(options.body) ? options.body.body\n                : options.body ? JSON.stringify(options.body, null, 2)\n                    : null;\n        const contentLength = this.calculateContentLength(body);\n        const url = this.buildURL(path, query);\n        if ('timeout' in options)\n            validatePositiveInteger('timeout', options.timeout);\n        const timeout = options.timeout ?? this.timeout;\n        const httpAgent = options.httpAgent ?? this.httpAgent ?? getDefaultAgent(url);\n        const minAgentTimeout = timeout + 1000;\n        if (typeof httpAgent?.options?.timeout === 'number' &&\n            minAgentTimeout > (httpAgent.options.timeout ?? 0)) {\n            // Allow any given request to bump our agent active socket timeout.\n            // This may seem strange, but leaking active sockets should be rare and not particularly problematic,\n            // and without mutating agent we would need to create more of them.\n            // This tradeoff optimizes for performance.\n            httpAgent.options.timeout = minAgentTimeout;\n        }\n        if (this.idempotencyHeader && method !== 'get') {\n            if (!options.idempotencyKey)\n                options.idempotencyKey = this.defaultIdempotencyKey();\n            headers[this.idempotencyHeader] = options.idempotencyKey;\n        }\n        const reqHeaders = this.buildHeaders({ options, headers, contentLength, retryCount });\n        const req = {\n            method,\n            ...(body && { body: body }),\n            headers: reqHeaders,\n            ...(httpAgent && { agent: httpAgent }),\n            // @ts-ignore node-fetch uses a custom AbortSignal type that is\n            // not compatible with standard web types\n            signal: options.signal ?? null,\n        };\n        return { req, url, timeout };\n    }\n    buildHeaders({ options, headers, contentLength, retryCount, }) {\n        const reqHeaders = {};\n        if (contentLength) {\n            reqHeaders['content-length'] = contentLength;\n        }\n        const defaultHeaders = this.defaultHeaders(options);\n        applyHeadersMut(reqHeaders, defaultHeaders);\n        applyHeadersMut(reqHeaders, headers);\n        // let builtin fetch set the Content-Type for multipart bodies\n        if (isMultipartBody(options.body) && shimsKind !== 'node') {\n            delete reqHeaders['content-type'];\n        }\n        // Don't set the retry count header if it was already set or removed through default headers or by the\n        // caller. We check `defaultHeaders` and `headers`, which can contain nulls, instead of `reqHeaders` to\n        // account for the removal case.\n        if (getHeader(defaultHeaders, 'x-stainless-retry-count') === undefined &&\n            getHeader(headers, 'x-stainless-retry-count') === undefined) {\n            reqHeaders['x-stainless-retry-count'] = String(retryCount);\n        }\n        this.validateHeaders(reqHeaders, headers);\n        return reqHeaders;\n    }\n    /**\n     * Used as a callback for mutating the given `FinalRequestOptions` object.\n     */\n    async prepareOptions(options) { }\n    /**\n     * Used as a callback for mutating the given `RequestInit` object.\n     *\n     * This is useful for cases where you want to add certain headers based off of\n     * the request properties, e.g. `method` or `url`.\n     */\n    async prepareRequest(request, { url, options }) { }\n    parseHeaders(headers) {\n        return (!headers ? {}\n            : Symbol.iterator in headers ?\n                Object.fromEntries(Array.from(headers).map((header) => [...header]))\n                : { ...headers });\n    }\n    makeStatusError(status, error, message, headers) {\n        return APIError.generate(status, error, message, headers);\n    }\n    request(options, remainingRetries = null) {\n        return new APIPromise(this.makeRequest(options, remainingRetries));\n    }\n    async makeRequest(optionsInput, retriesRemaining) {\n        const options = await optionsInput;\n        const maxRetries = options.maxRetries ?? this.maxRetries;\n        if (retriesRemaining == null) {\n            retriesRemaining = maxRetries;\n        }\n        await this.prepareOptions(options);\n        const { req, url, timeout } = this.buildRequest(options, { retryCount: maxRetries - retriesRemaining });\n        await this.prepareRequest(req, { url, options });\n        debug('request', url, options, req.headers);\n        if (options.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        const controller = new AbortController();\n        const response = await this.fetchWithTimeout(url, req, timeout, controller).catch(castToError);\n        if (response instanceof Error) {\n            if (options.signal?.aborted) {\n                throw new APIUserAbortError();\n            }\n            if (retriesRemaining) {\n                return this.retryRequest(options, retriesRemaining);\n            }\n            if (response.name === 'AbortError') {\n                throw new APIConnectionTimeoutError();\n            }\n            throw new APIConnectionError({ cause: response });\n        }\n        const responseHeaders = createResponseHeaders(response.headers);\n        if (!response.ok) {\n            if (retriesRemaining && this.shouldRetry(response)) {\n                const retryMessage = `retrying, ${retriesRemaining} attempts remaining`;\n                debug(`response (error; ${retryMessage})`, response.status, url, responseHeaders);\n                return this.retryRequest(options, retriesRemaining, responseHeaders);\n            }\n            const errText = await response.text().catch((e) => castToError(e).message);\n            const errJSON = safeJSON(errText);\n            const errMessage = errJSON ? undefined : errText;\n            const retryMessage = retriesRemaining ? `(error; no more retries left)` : `(error; not retryable)`;\n            debug(`response (error; ${retryMessage})`, response.status, url, responseHeaders, errMessage);\n            const err = this.makeStatusError(response.status, errJSON, errMessage, responseHeaders);\n            throw err;\n        }\n        return { response, options, controller };\n    }\n    requestAPIList(Page, options) {\n        const request = this.makeRequest(options, null);\n        return new PagePromise(this, request, Page);\n    }\n    buildURL(path, query) {\n        const url = isAbsoluteURL(path) ?\n            new URL(path)\n            : new URL(this.baseURL + (this.baseURL.endsWith('/') && path.startsWith('/') ? path.slice(1) : path));\n        const defaultQuery = this.defaultQuery();\n        if (!isEmptyObj(defaultQuery)) {\n            query = { ...defaultQuery, ...query };\n        }\n        if (typeof query === 'object' && query && !Array.isArray(query)) {\n            url.search = this.stringifyQuery(query);\n        }\n        return url.toString();\n    }\n    stringifyQuery(query) {\n        return Object.entries(query)\n            .filter(([_, value]) => typeof value !== 'undefined')\n            .map(([key, value]) => {\n            if (typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean') {\n                return `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n            }\n            if (value === null) {\n                return `${encodeURIComponent(key)}=`;\n            }\n            throw new OpenAIError(`Cannot stringify type ${typeof value}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`);\n        })\n            .join('&');\n    }\n    async fetchWithTimeout(url, init, ms, controller) {\n        const { signal, ...options } = init || {};\n        if (signal)\n            signal.addEventListener('abort', () => controller.abort());\n        const timeout = setTimeout(() => controller.abort(), ms);\n        return (this.getRequestClient()\n            // use undefined this binding; fetch errors if bound to something else in browser/cloudflare\n            .fetch.call(undefined, url, { signal: controller.signal, ...options })\n            .finally(() => {\n            clearTimeout(timeout);\n        }));\n    }\n    getRequestClient() {\n        return { fetch: this.fetch };\n    }\n    shouldRetry(response) {\n        // Note this is not a standard header.\n        const shouldRetryHeader = response.headers.get('x-should-retry');\n        // If the server explicitly says whether or not to retry, obey.\n        if (shouldRetryHeader === 'true')\n            return true;\n        if (shouldRetryHeader === 'false')\n            return false;\n        // Retry on request timeouts.\n        if (response.status === 408)\n            return true;\n        // Retry on lock timeouts.\n        if (response.status === 409)\n            return true;\n        // Retry on rate limits.\n        if (response.status === 429)\n            return true;\n        // Retry internal errors.\n        if (response.status >= 500)\n            return true;\n        return false;\n    }\n    async retryRequest(options, retriesRemaining, responseHeaders) {\n        let timeoutMillis;\n        // Note the `retry-after-ms` header may not be standard, but is a good idea and we'd like proactive support for it.\n        const retryAfterMillisHeader = responseHeaders?.['retry-after-ms'];\n        if (retryAfterMillisHeader) {\n            const timeoutMs = parseFloat(retryAfterMillisHeader);\n            if (!Number.isNaN(timeoutMs)) {\n                timeoutMillis = timeoutMs;\n            }\n        }\n        // About the Retry-After header: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After\n        const retryAfterHeader = responseHeaders?.['retry-after'];\n        if (retryAfterHeader && !timeoutMillis) {\n            const timeoutSeconds = parseFloat(retryAfterHeader);\n            if (!Number.isNaN(timeoutSeconds)) {\n                timeoutMillis = timeoutSeconds * 1000;\n            }\n            else {\n                timeoutMillis = Date.parse(retryAfterHeader) - Date.now();\n            }\n        }\n        // If the API asks us to wait a certain amount of time (and it's a reasonable amount),\n        // just do what it says, but otherwise calculate a default\n        if (!(timeoutMillis && 0 <= timeoutMillis && timeoutMillis < 60 * 1000)) {\n            const maxRetries = options.maxRetries ?? this.maxRetries;\n            timeoutMillis = this.calculateDefaultRetryTimeoutMillis(retriesRemaining, maxRetries);\n        }\n        await sleep(timeoutMillis);\n        return this.makeRequest(options, retriesRemaining - 1);\n    }\n    calculateDefaultRetryTimeoutMillis(retriesRemaining, maxRetries) {\n        const initialRetryDelay = 0.5;\n        const maxRetryDelay = 8.0;\n        const numRetries = maxRetries - retriesRemaining;\n        // Apply exponential backoff, but not more than the max.\n        const sleepSeconds = Math.min(initialRetryDelay * Math.pow(2, numRetries), maxRetryDelay);\n        // Apply some jitter, take up to at most 25 percent of the retry time.\n        const jitter = 1 - Math.random() * 0.25;\n        return sleepSeconds * jitter * 1000;\n    }\n    getUserAgent() {\n        return `${this.constructor.name}/JS ${VERSION}`;\n    }\n}\nexport class AbstractPage {\n    constructor(client, response, body, options) {\n        _AbstractPage_client.set(this, void 0);\n        __classPrivateFieldSet(this, _AbstractPage_client, client, \"f\");\n        this.options = options;\n        this.response = response;\n        this.body = body;\n    }\n    hasNextPage() {\n        const items = this.getPaginatedItems();\n        if (!items.length)\n            return false;\n        return this.nextPageInfo() != null;\n    }\n    async getNextPage() {\n        const nextInfo = this.nextPageInfo();\n        if (!nextInfo) {\n            throw new OpenAIError('No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.');\n        }\n        const nextOptions = { ...this.options };\n        if ('params' in nextInfo && typeof nextOptions.query === 'object') {\n            nextOptions.query = { ...nextOptions.query, ...nextInfo.params };\n        }\n        else if ('url' in nextInfo) {\n            const params = [...Object.entries(nextOptions.query || {}), ...nextInfo.url.searchParams.entries()];\n            for (const [key, value] of params) {\n                nextInfo.url.searchParams.set(key, value);\n            }\n            nextOptions.query = undefined;\n            nextOptions.path = nextInfo.url.toString();\n        }\n        return await __classPrivateFieldGet(this, _AbstractPage_client, \"f\").requestAPIList(this.constructor, nextOptions);\n    }\n    async *iterPages() {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        let page = this;\n        yield page;\n        while (page.hasNextPage()) {\n            page = await page.getNextPage();\n            yield page;\n        }\n    }\n    async *[(_AbstractPage_client = new WeakMap(), Symbol.asyncIterator)]() {\n        for await (const page of this.iterPages()) {\n            for (const item of page.getPaginatedItems()) {\n                yield item;\n            }\n        }\n    }\n}\n/**\n * This subclass of Promise will resolve to an instantiated Page once the request completes.\n *\n * It also implements AsyncIterable to allow auto-paginating iteration on an unawaited list call, eg:\n *\n *    for await (const item of client.items.list()) {\n *      console.log(item)\n *    }\n */\nexport class PagePromise extends APIPromise {\n    constructor(client, request, Page) {\n        super(request, async (props) => new Page(client, props.response, await defaultParseResponse(props), props.options));\n    }\n    /**\n     * Allow auto-paginating iteration on an unawaited list call, eg:\n     *\n     *    for await (const item of client.items.list()) {\n     *      console.log(item)\n     *    }\n     */\n    async *[Symbol.asyncIterator]() {\n        const page = await this;\n        for await (const item of page) {\n            yield item;\n        }\n    }\n}\nexport const createResponseHeaders = (headers) => {\n    return new Proxy(Object.fromEntries(\n    // @ts-ignore\n    headers.entries()), {\n        get(target, name) {\n            const key = name.toString();\n            return target[key.toLowerCase()] || target[key];\n        },\n    });\n};\n// This is required so that we can determine if a given object matches the RequestOptions\n// type at runtime. While this requires duplication, it is enforced by the TypeScript\n// compiler such that any missing / extraneous keys will cause an error.\nconst requestOptionsKeys = {\n    method: true,\n    path: true,\n    query: true,\n    body: true,\n    headers: true,\n    maxRetries: true,\n    stream: true,\n    timeout: true,\n    httpAgent: true,\n    signal: true,\n    idempotencyKey: true,\n    __binaryRequest: true,\n    __binaryResponse: true,\n    __streamClass: true,\n};\nexport const isRequestOptions = (obj) => {\n    return (typeof obj === 'object' &&\n        obj !== null &&\n        !isEmptyObj(obj) &&\n        Object.keys(obj).every((k) => hasOwn(requestOptionsKeys, k)));\n};\nconst getPlatformProperties = () => {\n    if (typeof Deno !== 'undefined' && Deno.build != null) {\n        return {\n            'X-Stainless-Lang': 'js',\n            'X-Stainless-Package-Version': VERSION,\n            'X-Stainless-OS': normalizePlatform(Deno.build.os),\n            'X-Stainless-Arch': normalizeArch(Deno.build.arch),\n            'X-Stainless-Runtime': 'deno',\n            'X-Stainless-Runtime-Version': typeof Deno.version === 'string' ? Deno.version : Deno.version?.deno ?? 'unknown',\n        };\n    }\n    if (typeof EdgeRuntime !== 'undefined') {\n        return {\n            'X-Stainless-Lang': 'js',\n            'X-Stainless-Package-Version': VERSION,\n            'X-Stainless-OS': 'Unknown',\n            'X-Stainless-Arch': `other:${EdgeRuntime}`,\n            'X-Stainless-Runtime': 'edge',\n            'X-Stainless-Runtime-Version': process.version,\n        };\n    }\n    // Check if Node.js\n    if (Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]') {\n        return {\n            'X-Stainless-Lang': 'js',\n            'X-Stainless-Package-Version': VERSION,\n            'X-Stainless-OS': normalizePlatform(process.platform),\n            'X-Stainless-Arch': normalizeArch(process.arch),\n            'X-Stainless-Runtime': 'node',\n            'X-Stainless-Runtime-Version': process.version,\n        };\n    }\n    const browserInfo = getBrowserInfo();\n    if (browserInfo) {\n        return {\n            'X-Stainless-Lang': 'js',\n            'X-Stainless-Package-Version': VERSION,\n            'X-Stainless-OS': 'Unknown',\n            'X-Stainless-Arch': 'unknown',\n            'X-Stainless-Runtime': `browser:${browserInfo.browser}`,\n            'X-Stainless-Runtime-Version': browserInfo.version,\n        };\n    }\n    // TODO add support for Cloudflare workers, etc.\n    return {\n        'X-Stainless-Lang': 'js',\n        'X-Stainless-Package-Version': VERSION,\n        'X-Stainless-OS': 'Unknown',\n        'X-Stainless-Arch': 'unknown',\n        'X-Stainless-Runtime': 'unknown',\n        'X-Stainless-Runtime-Version': 'unknown',\n    };\n};\n// Note: modified from https://github.com/JS-DevTools/host-environment/blob/b1ab79ecde37db5d6e163c050e54fe7d287d7c92/src/isomorphic.browser.ts\nfunction getBrowserInfo() {\n    if (typeof navigator === 'undefined' || !navigator) {\n        return null;\n    }\n    // NOTE: The order matters here!\n    const browserPatterns = [\n        { key: 'edge', pattern: /Edge(?:\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n        { key: 'ie', pattern: /MSIE(?:\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n        { key: 'ie', pattern: /Trident(?:.*rv\\:(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n        { key: 'chrome', pattern: /Chrome(?:\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n        { key: 'firefox', pattern: /Firefox(?:\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n        { key: 'safari', pattern: /(?:Version\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?(?:\\W+Mobile\\S*)?\\W+Safari/ },\n    ];\n    // Find the FIRST matching browser\n    for (const { key, pattern } of browserPatterns) {\n        const match = pattern.exec(navigator.userAgent);\n        if (match) {\n            const major = match[1] || 0;\n            const minor = match[2] || 0;\n            const patch = match[3] || 0;\n            return { browser: key, version: `${major}.${minor}.${patch}` };\n        }\n    }\n    return null;\n}\nconst normalizeArch = (arch) => {\n    // Node docs:\n    // - https://nodejs.org/api/process.html#processarch\n    // Deno docs:\n    // - https://doc.deno.land/deno/stable/~/Deno.build\n    if (arch === 'x32')\n        return 'x32';\n    if (arch === 'x86_64' || arch === 'x64')\n        return 'x64';\n    if (arch === 'arm')\n        return 'arm';\n    if (arch === 'aarch64' || arch === 'arm64')\n        return 'arm64';\n    if (arch)\n        return `other:${arch}`;\n    return 'unknown';\n};\nconst normalizePlatform = (platform) => {\n    // Node platforms:\n    // - https://nodejs.org/api/process.html#processplatform\n    // Deno platforms:\n    // - https://doc.deno.land/deno/stable/~/Deno.build\n    // - https://github.com/denoland/deno/issues/14799\n    platform = platform.toLowerCase();\n    // NOTE: this iOS check is untested and may not work\n    // Node does not work natively on IOS, there is a fork at\n    // https://github.com/nodejs-mobile/nodejs-mobile\n    // however it is unknown at the time of writing how to detect if it is running\n    if (platform.includes('ios'))\n        return 'iOS';\n    if (platform === 'android')\n        return 'Android';\n    if (platform === 'darwin')\n        return 'MacOS';\n    if (platform === 'win32')\n        return 'Windows';\n    if (platform === 'freebsd')\n        return 'FreeBSD';\n    if (platform === 'openbsd')\n        return 'OpenBSD';\n    if (platform === 'linux')\n        return 'Linux';\n    if (platform)\n        return `Other:${platform}`;\n    return 'Unknown';\n};\nlet _platformHeaders;\nconst getPlatformHeaders = () => {\n    return (_platformHeaders ?? (_platformHeaders = getPlatformProperties()));\n};\nexport const safeJSON = (text) => {\n    try {\n        return JSON.parse(text);\n    }\n    catch (err) {\n        return undefined;\n    }\n};\n// https://stackoverflow.com/a/19709846\nconst startsWithSchemeRegexp = new RegExp('^(?:[a-z]+:)?//', 'i');\nconst isAbsoluteURL = (url) => {\n    return startsWithSchemeRegexp.test(url);\n};\nexport const sleep = (ms) => new Promise((resolve) => setTimeout(resolve, ms));\nconst validatePositiveInteger = (name, n) => {\n    if (typeof n !== 'number' || !Number.isInteger(n)) {\n        throw new OpenAIError(`${name} must be an integer`);\n    }\n    if (n < 0) {\n        throw new OpenAIError(`${name} must be a positive integer`);\n    }\n    return n;\n};\nexport const castToError = (err) => {\n    if (err instanceof Error)\n        return err;\n    if (typeof err === 'object' && err !== null) {\n        try {\n            return new Error(JSON.stringify(err));\n        }\n        catch { }\n    }\n    return new Error(err);\n};\nexport const ensurePresent = (value) => {\n    if (value == null)\n        throw new OpenAIError(`Expected a value to be given but received ${value} instead.`);\n    return value;\n};\n/**\n * Read an environment variable.\n *\n * Trims beginning and trailing whitespace.\n *\n * Will return undefined if the environment variable doesn't exist or cannot be accessed.\n */\nexport const readEnv = (env) => {\n    if (typeof process !== 'undefined') {\n        return process.env?.[env]?.trim() ?? undefined;\n    }\n    if (typeof Deno !== 'undefined') {\n        return Deno.env?.get?.(env)?.trim();\n    }\n    return undefined;\n};\nexport const coerceInteger = (value) => {\n    if (typeof value === 'number')\n        return Math.round(value);\n    if (typeof value === 'string')\n        return parseInt(value, 10);\n    throw new OpenAIError(`Could not coerce ${value} (type: ${typeof value}) into a number`);\n};\nexport const coerceFloat = (value) => {\n    if (typeof value === 'number')\n        return value;\n    if (typeof value === 'string')\n        return parseFloat(value);\n    throw new OpenAIError(`Could not coerce ${value} (type: ${typeof value}) into a number`);\n};\nexport const coerceBoolean = (value) => {\n    if (typeof value === 'boolean')\n        return value;\n    if (typeof value === 'string')\n        return value === 'true';\n    return Boolean(value);\n};\nexport const maybeCoerceInteger = (value) => {\n    if (value === undefined) {\n        return undefined;\n    }\n    return coerceInteger(value);\n};\nexport const maybeCoerceFloat = (value) => {\n    if (value === undefined) {\n        return undefined;\n    }\n    return coerceFloat(value);\n};\nexport const maybeCoerceBoolean = (value) => {\n    if (value === undefined) {\n        return undefined;\n    }\n    return coerceBoolean(value);\n};\n// https://stackoverflow.com/a/34491287\nexport function isEmptyObj(obj) {\n    if (!obj)\n        return true;\n    for (const _k in obj)\n        return false;\n    return true;\n}\n// https://eslint.org/docs/latest/rules/no-prototype-builtins\nexport function hasOwn(obj, key) {\n    return Object.prototype.hasOwnProperty.call(obj, key);\n}\n/**\n * Copies headers from \"newHeaders\" onto \"targetHeaders\",\n * using lower-case for all properties,\n * ignoring any keys with undefined values,\n * and deleting any keys with null values.\n */\nfunction applyHeadersMut(targetHeaders, newHeaders) {\n    for (const k in newHeaders) {\n        if (!hasOwn(newHeaders, k))\n            continue;\n        const lowerKey = k.toLowerCase();\n        if (!lowerKey)\n            continue;\n        const val = newHeaders[k];\n        if (val === null) {\n            delete targetHeaders[lowerKey];\n        }\n        else if (val !== undefined) {\n            targetHeaders[lowerKey] = val;\n        }\n    }\n}\nexport function debug(action, ...args) {\n    if (typeof process !== 'undefined' && process?.env?.['DEBUG'] === 'true') {\n        console.log(`OpenAI:DEBUG:${action}`, ...args);\n    }\n}\n/**\n * https://stackoverflow.com/a/2117523\n */\nconst uuid4 = () => {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n        const r = (Math.random() * 16) | 0;\n        const v = c === 'x' ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n    });\n};\nexport const isRunningInBrowser = () => {\n    return (\n    // @ts-ignore\n    typeof window !== 'undefined' &&\n        // @ts-ignore\n        typeof window.document !== 'undefined' &&\n        // @ts-ignore\n        typeof navigator !== 'undefined');\n};\nexport const isHeadersProtocol = (headers) => {\n    return typeof headers?.get === 'function';\n};\nexport const getRequiredHeader = (headers, header) => {\n    const foundHeader = getHeader(headers, header);\n    if (foundHeader === undefined) {\n        throw new Error(`Could not find ${header} header`);\n    }\n    return foundHeader;\n};\nexport const getHeader = (headers, header) => {\n    const lowerCasedHeader = header.toLowerCase();\n    if (isHeadersProtocol(headers)) {\n        // to deal with the case where the header looks like Stainless-Event-Id\n        const intercapsHeader = header[0]?.toUpperCase() +\n            header.substring(1).replace(/([^\\w])(\\w)/g, (_m, g1, g2) => g1 + g2.toUpperCase());\n        for (const key of [header, lowerCasedHeader, header.toUpperCase(), intercapsHeader]) {\n            const value = headers.get(key);\n            if (value) {\n                return value;\n            }\n        }\n    }\n    for (const [key, value] of Object.entries(headers)) {\n        if (key.toLowerCase() === lowerCasedHeader) {\n            if (Array.isArray(value)) {\n                if (value.length <= 1)\n                    return value[0];\n                console.warn(`Received ${value.length} entries for the ${header} header, using the first entry.`);\n                return value[0];\n            }\n            return value;\n        }\n    }\n    return undefined;\n};\n/**\n * Encodes a string to Base64 format.\n */\nexport const toBase64 = (str) => {\n    if (!str)\n        return '';\n    if (typeof Buffer !== 'undefined') {\n        return Buffer.from(str).toString('base64');\n    }\n    if (typeof btoa !== 'undefined') {\n        return btoa(str);\n    }\n    throw new OpenAIError('Cannot generate b64 string; Expected `Buffer` or `btoa` to be defined');\n};\nexport function isObj(obj) {\n    return obj != null && typeof obj === 'object' && !Array.isArray(obj);\n}\n//# sourceMappingURL=core.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { AbstractPage } from \"./core.mjs\";\n/**\n * Note: no pagination actually occurs yet, this is for forwards-compatibility.\n */\nexport class Page extends AbstractPage {\n    constructor(client, response, body, options) {\n        super(client, response, body, options);\n        this.data = body.data || [];\n        this.object = body.object;\n    }\n    getPaginatedItems() {\n        return this.data ?? [];\n    }\n    // @deprecated Please use `nextPageInfo()` instead\n    /**\n     * This page represents a response that isn't actually paginated at the API level\n     * so there will never be any next page params.\n     */\n    nextPageParams() {\n        return null;\n    }\n    nextPageInfo() {\n        return null;\n    }\n}\nexport class CursorPage extends AbstractPage {\n    constructor(client, response, body, options) {\n        super(client, response, body, options);\n        this.data = body.data || [];\n    }\n    getPaginatedItems() {\n        return this.data ?? [];\n    }\n    // @deprecated Please use `nextPageInfo()` instead\n    nextPageParams() {\n        const info = this.nextPageInfo();\n        if (!info)\n            return null;\n        if ('params' in info)\n            return info.params;\n        const params = Object.fromEntries(info.url.searchParams);\n        if (!Object.keys(params).length)\n            return null;\n        return params;\n    }\n    nextPageInfo() {\n        const data = this.getPaginatedItems();\n        if (!data.length) {\n            return null;\n        }\n        const id = data[data.length - 1]?.id;\n        if (!id) {\n            return null;\n        }\n        return { params: { after: id } };\n    }\n}\n//# sourceMappingURL=pagination.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nexport class APIResource {\n    constructor(client) {\n        this._client = client;\n    }\n}\n//# sourceMappingURL=resource.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nexport class Completions extends APIResource {\n    create(body, options) {\n        return this._client.post('/chat/completions', { body, ...options, stream: body.stream ?? false });\n    }\n}\n//# sourceMappingURL=completions.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as CompletionsAPI from \"./completions.mjs\";\nimport { Completions, } from \"./completions.mjs\";\nexport class Chat extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.completions = new CompletionsAPI.Completions(this._client);\n    }\n}\nChat.Completions = Completions;\n//# sourceMappingURL=chat.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nexport class Speech extends APIResource {\n    /**\n     * Generates audio from the input text.\n     */\n    create(body, options) {\n        return this._client.post('/audio/speech', { body, ...options, __binaryResponse: true });\n    }\n}\n//# sourceMappingURL=speech.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as Core from \"../../core.mjs\";\nexport class Transcriptions extends APIResource {\n    create(body, options) {\n        return this._client.post('/audio/transcriptions', Core.multipartFormRequestOptions({ body, ...options }));\n    }\n}\n//# sourceMappingURL=transcriptions.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as Core from \"../../core.mjs\";\nexport class Translations extends APIResource {\n    create(body, options) {\n        return this._client.post('/audio/translations', Core.multipartFormRequestOptions({ body, ...options }));\n    }\n}\n//# sourceMappingURL=translations.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as SpeechAPI from \"./speech.mjs\";\nimport { Speech } from \"./speech.mjs\";\nimport * as TranscriptionsAPI from \"./transcriptions.mjs\";\nimport { Transcriptions, } from \"./transcriptions.mjs\";\nimport * as TranslationsAPI from \"./translations.mjs\";\nimport { Translations, } from \"./translations.mjs\";\nexport class Audio extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.transcriptions = new TranscriptionsAPI.Transcriptions(this._client);\n        this.translations = new TranslationsAPI.Translations(this._client);\n        this.speech = new SpeechAPI.Speech(this._client);\n    }\n}\nAudio.Transcriptions = Transcriptions;\nAudio.Translations = Translations;\nAudio.Speech = Speech;\n//# sourceMappingURL=audio.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nimport { isRequestOptions } from \"../core.mjs\";\nimport { CursorPage } from \"../pagination.mjs\";\nexport class Batches extends APIResource {\n    /**\n     * Creates and executes a batch from an uploaded file of requests\n     */\n    create(body, options) {\n        return this._client.post('/batches', { body, ...options });\n    }\n    /**\n     * Retrieves a batch.\n     */\n    retrieve(batchId, options) {\n        return this._client.get(`/batches/${batchId}`, options);\n    }\n    list(query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list({}, query);\n        }\n        return this._client.getAPIList('/batches', BatchesPage, { query, ...options });\n    }\n    /**\n     * Cancels an in-progress batch. The batch will be in status `cancelling` for up to\n     * 10 minutes, before changing to `cancelled`, where it will have partial results\n     * (if any) available in the output file.\n     */\n    cancel(batchId, options) {\n        return this._client.post(`/batches/${batchId}/cancel`, options);\n    }\n}\nexport class BatchesPage extends CursorPage {\n}\nBatches.BatchesPage = BatchesPage;\n//# sourceMappingURL=batches.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport { isRequestOptions } from \"../../core.mjs\";\nimport { CursorPage } from \"../../pagination.mjs\";\nexport class Assistants extends APIResource {\n    /**\n     * Create an assistant with a model and instructions.\n     */\n    create(body, options) {\n        return this._client.post('/assistants', {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Retrieves an assistant.\n     */\n    retrieve(assistantId, options) {\n        return this._client.get(`/assistants/${assistantId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Modifies an assistant.\n     */\n    update(assistantId, body, options) {\n        return this._client.post(`/assistants/${assistantId}`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    list(query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list({}, query);\n        }\n        return this._client.getAPIList('/assistants', AssistantsPage, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Delete an assistant.\n     */\n    del(assistantId, options) {\n        return this._client.delete(`/assistants/${assistantId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n}\nexport class AssistantsPage extends CursorPage {\n}\nAssistants.AssistantsPage = AssistantsPage;\n//# sourceMappingURL=assistants.mjs.map","export function isRunnableFunctionWithParse(fn) {\n    return typeof fn.parse === 'function';\n}\n/**\n * This is helper class for passing a `function` and `parse` where the `function`\n * argument type matches the `parse` return type.\n *\n * @deprecated - please use ParsingToolFunction instead.\n */\nexport class ParsingFunction {\n    constructor(input) {\n        this.function = input.function;\n        this.parse = input.parse;\n        this.parameters = input.parameters;\n        this.description = input.description;\n        this.name = input.name;\n    }\n}\n/**\n * This is helper class for passing a `function` and `parse` where the `function`\n * argument type matches the `parse` return type.\n */\nexport class ParsingToolFunction {\n    constructor(input) {\n        this.type = 'function';\n        this.function = input;\n    }\n}\n//# sourceMappingURL=RunnableFunction.mjs.map","export const isAssistantMessage = (message) => {\n    return message?.role === 'assistant';\n};\nexport const isFunctionMessage = (message) => {\n    return message?.role === 'function';\n};\nexport const isToolMessage = (message) => {\n    return message?.role === 'tool';\n};\nexport function isPresent(obj) {\n    return obj != null;\n}\n//# sourceMappingURL=chatCompletionUtils.mjs.map","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _EventStream_instances, _EventStream_connectedPromise, _EventStream_resolveConnectedPromise, _EventStream_rejectConnectedPromise, _EventStream_endPromise, _EventStream_resolveEndPromise, _EventStream_rejectEndPromise, _EventStream_listeners, _EventStream_ended, _EventStream_errored, _EventStream_aborted, _EventStream_catchingPromiseCreated, _EventStream_handleError;\nimport { APIUserAbortError, OpenAIError } from \"../error.mjs\";\nexport class EventStream {\n    constructor() {\n        _EventStream_instances.add(this);\n        this.controller = new AbortController();\n        _EventStream_connectedPromise.set(this, void 0);\n        _EventStream_resolveConnectedPromise.set(this, () => { });\n        _EventStream_rejectConnectedPromise.set(this, () => { });\n        _EventStream_endPromise.set(this, void 0);\n        _EventStream_resolveEndPromise.set(this, () => { });\n        _EventStream_rejectEndPromise.set(this, () => { });\n        _EventStream_listeners.set(this, {});\n        _EventStream_ended.set(this, false);\n        _EventStream_errored.set(this, false);\n        _EventStream_aborted.set(this, false);\n        _EventStream_catchingPromiseCreated.set(this, false);\n        __classPrivateFieldSet(this, _EventStream_connectedPromise, new Promise((resolve, reject) => {\n            __classPrivateFieldSet(this, _EventStream_resolveConnectedPromise, resolve, \"f\");\n            __classPrivateFieldSet(this, _EventStream_rejectConnectedPromise, reject, \"f\");\n        }), \"f\");\n        __classPrivateFieldSet(this, _EventStream_endPromise, new Promise((resolve, reject) => {\n            __classPrivateFieldSet(this, _EventStream_resolveEndPromise, resolve, \"f\");\n            __classPrivateFieldSet(this, _EventStream_rejectEndPromise, reject, \"f\");\n        }), \"f\");\n        // Don't let these promises cause unhandled rejection errors.\n        // we will manually cause an unhandled rejection error later\n        // if the user hasn't registered any error listener or called\n        // any promise-returning method.\n        __classPrivateFieldGet(this, _EventStream_connectedPromise, \"f\").catch(() => { });\n        __classPrivateFieldGet(this, _EventStream_endPromise, \"f\").catch(() => { });\n    }\n    _run(executor) {\n        // Unfortunately if we call `executor()` immediately we get runtime errors about\n        // references to `this` before the `super()` constructor call returns.\n        setTimeout(() => {\n            executor().then(() => {\n                this._emitFinal();\n                this._emit('end');\n            }, __classPrivateFieldGet(this, _EventStream_instances, \"m\", _EventStream_handleError).bind(this));\n        }, 0);\n    }\n    _connected() {\n        if (this.ended)\n            return;\n        __classPrivateFieldGet(this, _EventStream_resolveConnectedPromise, \"f\").call(this);\n        this._emit('connect');\n    }\n    get ended() {\n        return __classPrivateFieldGet(this, _EventStream_ended, \"f\");\n    }\n    get errored() {\n        return __classPrivateFieldGet(this, _EventStream_errored, \"f\");\n    }\n    get aborted() {\n        return __classPrivateFieldGet(this, _EventStream_aborted, \"f\");\n    }\n    abort() {\n        this.controller.abort();\n    }\n    /**\n     * Adds the listener function to the end of the listeners array for the event.\n     * No checks are made to see if the listener has already been added. Multiple calls passing\n     * the same combination of event and listener will result in the listener being added, and\n     * called, multiple times.\n     * @returns this ChatCompletionStream, so that calls can be chained\n     */\n    on(event, listener) {\n        const listeners = __classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event] || (__classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event] = []);\n        listeners.push({ listener });\n        return this;\n    }\n    /**\n     * Removes the specified listener from the listener array for the event.\n     * off() will remove, at most, one instance of a listener from the listener array. If any single\n     * listener has been added multiple times to the listener array for the specified event, then\n     * off() must be called multiple times to remove each instance.\n     * @returns this ChatCompletionStream, so that calls can be chained\n     */\n    off(event, listener) {\n        const listeners = __classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event];\n        if (!listeners)\n            return this;\n        const index = listeners.findIndex((l) => l.listener === listener);\n        if (index >= 0)\n            listeners.splice(index, 1);\n        return this;\n    }\n    /**\n     * Adds a one-time listener function for the event. The next time the event is triggered,\n     * this listener is removed and then invoked.\n     * @returns this ChatCompletionStream, so that calls can be chained\n     */\n    once(event, listener) {\n        const listeners = __classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event] || (__classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event] = []);\n        listeners.push({ listener, once: true });\n        return this;\n    }\n    /**\n     * This is similar to `.once()`, but returns a Promise that resolves the next time\n     * the event is triggered, instead of calling a listener callback.\n     * @returns a Promise that resolves the next time given event is triggered,\n     * or rejects if an error is emitted.  (If you request the 'error' event,\n     * returns a promise that resolves with the error).\n     *\n     * Example:\n     *\n     *   const message = await stream.emitted('message') // rejects if the stream errors\n     */\n    emitted(event) {\n        return new Promise((resolve, reject) => {\n            __classPrivateFieldSet(this, _EventStream_catchingPromiseCreated, true, \"f\");\n            if (event !== 'error')\n                this.once('error', reject);\n            this.once(event, resolve);\n        });\n    }\n    async done() {\n        __classPrivateFieldSet(this, _EventStream_catchingPromiseCreated, true, \"f\");\n        await __classPrivateFieldGet(this, _EventStream_endPromise, \"f\");\n    }\n    _emit(event, ...args) {\n        // make sure we don't emit any events after end\n        if (__classPrivateFieldGet(this, _EventStream_ended, \"f\")) {\n            return;\n        }\n        if (event === 'end') {\n            __classPrivateFieldSet(this, _EventStream_ended, true, \"f\");\n            __classPrivateFieldGet(this, _EventStream_resolveEndPromise, \"f\").call(this);\n        }\n        const listeners = __classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event];\n        if (listeners) {\n            __classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event] = listeners.filter((l) => !l.once);\n            listeners.forEach(({ listener }) => listener(...args));\n        }\n        if (event === 'abort') {\n            const error = args[0];\n            if (!__classPrivateFieldGet(this, _EventStream_catchingPromiseCreated, \"f\") && !listeners?.length) {\n                Promise.reject(error);\n            }\n            __classPrivateFieldGet(this, _EventStream_rejectConnectedPromise, \"f\").call(this, error);\n            __classPrivateFieldGet(this, _EventStream_rejectEndPromise, \"f\").call(this, error);\n            this._emit('end');\n            return;\n        }\n        if (event === 'error') {\n            // NOTE: _emit('error', error) should only be called from #handleError().\n            const error = args[0];\n            if (!__classPrivateFieldGet(this, _EventStream_catchingPromiseCreated, \"f\") && !listeners?.length) {\n                // Trigger an unhandled rejection if the user hasn't registered any error handlers.\n                // If you are seeing stack traces here, make sure to handle errors via either:\n                // - runner.on('error', () => ...)\n                // - await runner.done()\n                // - await runner.finalChatCompletion()\n                // - etc.\n                Promise.reject(error);\n            }\n            __classPrivateFieldGet(this, _EventStream_rejectConnectedPromise, \"f\").call(this, error);\n            __classPrivateFieldGet(this, _EventStream_rejectEndPromise, \"f\").call(this, error);\n            this._emit('end');\n        }\n    }\n    _emitFinal() { }\n}\n_EventStream_connectedPromise = new WeakMap(), _EventStream_resolveConnectedPromise = new WeakMap(), _EventStream_rejectConnectedPromise = new WeakMap(), _EventStream_endPromise = new WeakMap(), _EventStream_resolveEndPromise = new WeakMap(), _EventStream_rejectEndPromise = new WeakMap(), _EventStream_listeners = new WeakMap(), _EventStream_ended = new WeakMap(), _EventStream_errored = new WeakMap(), _EventStream_aborted = new WeakMap(), _EventStream_catchingPromiseCreated = new WeakMap(), _EventStream_instances = new WeakSet(), _EventStream_handleError = function _EventStream_handleError(error) {\n    __classPrivateFieldSet(this, _EventStream_errored, true, \"f\");\n    if (error instanceof Error && error.name === 'AbortError') {\n        error = new APIUserAbortError();\n    }\n    if (error instanceof APIUserAbortError) {\n        __classPrivateFieldSet(this, _EventStream_aborted, true, \"f\");\n        return this._emit('abort', error);\n    }\n    if (error instanceof OpenAIError) {\n        return this._emit('error', error);\n    }\n    if (error instanceof Error) {\n        const openAIError = new OpenAIError(error.message);\n        // @ts-ignore\n        openAIError.cause = error;\n        return this._emit('error', openAIError);\n    }\n    return this._emit('error', new OpenAIError(String(error)));\n};\n//# sourceMappingURL=EventStream.mjs.map","import { ContentFilterFinishReasonError, LengthFinishReasonError, OpenAIError } from \"../error.mjs\";\nexport function makeParseableResponseFormat(response_format, parser) {\n    const obj = { ...response_format };\n    Object.defineProperties(obj, {\n        $brand: {\n            value: 'auto-parseable-response-format',\n            enumerable: false,\n        },\n        $parseRaw: {\n            value: parser,\n            enumerable: false,\n        },\n    });\n    return obj;\n}\nexport function isAutoParsableResponseFormat(response_format) {\n    return response_format?.['$brand'] === 'auto-parseable-response-format';\n}\nexport function makeParseableTool(tool, { parser, callback, }) {\n    const obj = { ...tool };\n    Object.defineProperties(obj, {\n        $brand: {\n            value: 'auto-parseable-tool',\n            enumerable: false,\n        },\n        $parseRaw: {\n            value: parser,\n            enumerable: false,\n        },\n        $callback: {\n            value: callback,\n            enumerable: false,\n        },\n    });\n    return obj;\n}\nexport function isAutoParsableTool(tool) {\n    return tool?.['$brand'] === 'auto-parseable-tool';\n}\nexport function maybeParseChatCompletion(completion, params) {\n    if (!params || !hasAutoParseableInput(params)) {\n        return {\n            ...completion,\n            choices: completion.choices.map((choice) => ({\n                ...choice,\n                message: { ...choice.message, parsed: null, tool_calls: choice.message.tool_calls ?? [] },\n            })),\n        };\n    }\n    return parseChatCompletion(completion, params);\n}\nexport function parseChatCompletion(completion, params) {\n    const choices = completion.choices.map((choice) => {\n        if (choice.finish_reason === 'length') {\n            throw new LengthFinishReasonError();\n        }\n        if (choice.finish_reason === 'content_filter') {\n            throw new ContentFilterFinishReasonError();\n        }\n        return {\n            ...choice,\n            message: {\n                ...choice.message,\n                tool_calls: choice.message.tool_calls?.map((toolCall) => parseToolCall(params, toolCall)) ?? [],\n                parsed: choice.message.content && !choice.message.refusal ?\n                    parseResponseFormat(params, choice.message.content)\n                    : null,\n            },\n        };\n    });\n    return { ...completion, choices };\n}\nfunction parseResponseFormat(params, content) {\n    if (params.response_format?.type !== 'json_schema') {\n        return null;\n    }\n    if (params.response_format?.type === 'json_schema') {\n        if ('$parseRaw' in params.response_format) {\n            const response_format = params.response_format;\n            return response_format.$parseRaw(content);\n        }\n        return JSON.parse(content);\n    }\n    return null;\n}\nfunction parseToolCall(params, toolCall) {\n    const inputTool = params.tools?.find((inputTool) => inputTool.function?.name === toolCall.function.name);\n    return {\n        ...toolCall,\n        function: {\n            ...toolCall.function,\n            parsed_arguments: isAutoParsableTool(inputTool) ? inputTool.$parseRaw(toolCall.function.arguments)\n                : inputTool?.function.strict ? JSON.parse(toolCall.function.arguments)\n                    : null,\n        },\n    };\n}\nexport function shouldParseToolCall(params, toolCall) {\n    if (!params) {\n        return false;\n    }\n    const inputTool = params.tools?.find((inputTool) => inputTool.function?.name === toolCall.function.name);\n    return isAutoParsableTool(inputTool) || inputTool?.function.strict || false;\n}\nexport function hasAutoParseableInput(params) {\n    if (isAutoParsableResponseFormat(params.response_format)) {\n        return true;\n    }\n    return (params.tools?.some((t) => isAutoParsableTool(t) || (t.type === 'function' && t.function.strict === true)) ?? false);\n}\nexport function validateInputTools(tools) {\n    for (const tool of tools ?? []) {\n        if (tool.type !== 'function') {\n            throw new OpenAIError(`Currently only \\`function\\` tool types support auto-parsing; Received \\`${tool.type}\\``);\n        }\n        if (tool.function.strict !== true) {\n            throw new OpenAIError(`The \\`${tool.function.name}\\` tool is not marked with \\`strict: true\\`. Only strict function tools can be auto-parsed`);\n        }\n    }\n}\n//# sourceMappingURL=parser.mjs.map","var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _AbstractChatCompletionRunner_instances, _AbstractChatCompletionRunner_getFinalContent, _AbstractChatCompletionRunner_getFinalMessage, _AbstractChatCompletionRunner_getFinalFunctionCall, _AbstractChatCompletionRunner_getFinalFunctionCallResult, _AbstractChatCompletionRunner_calculateTotalUsage, _AbstractChatCompletionRunner_validateParams, _AbstractChatCompletionRunner_stringifyFunctionCallResult;\nimport { OpenAIError } from \"../error.mjs\";\nimport { isRunnableFunctionWithParse, } from \"./RunnableFunction.mjs\";\nimport { isAssistantMessage, isFunctionMessage, isToolMessage } from \"./chatCompletionUtils.mjs\";\nimport { EventStream } from \"./EventStream.mjs\";\nimport { isAutoParsableTool, parseChatCompletion } from \"../lib/parser.mjs\";\nconst DEFAULT_MAX_CHAT_COMPLETIONS = 10;\nexport class AbstractChatCompletionRunner extends EventStream {\n    constructor() {\n        super(...arguments);\n        _AbstractChatCompletionRunner_instances.add(this);\n        this._chatCompletions = [];\n        this.messages = [];\n    }\n    _addChatCompletion(chatCompletion) {\n        this._chatCompletions.push(chatCompletion);\n        this._emit('chatCompletion', chatCompletion);\n        const message = chatCompletion.choices[0]?.message;\n        if (message)\n            this._addMessage(message);\n        return chatCompletion;\n    }\n    _addMessage(message, emit = true) {\n        if (!('content' in message))\n            message.content = null;\n        this.messages.push(message);\n        if (emit) {\n            this._emit('message', message);\n            if ((isFunctionMessage(message) || isToolMessage(message)) && message.content) {\n                // Note, this assumes that {role: 'tool', content: …} is always the result of a call of tool of type=function.\n                this._emit('functionCallResult', message.content);\n            }\n            else if (isAssistantMessage(message) && message.function_call) {\n                this._emit('functionCall', message.function_call);\n            }\n            else if (isAssistantMessage(message) && message.tool_calls) {\n                for (const tool_call of message.tool_calls) {\n                    if (tool_call.type === 'function') {\n                        this._emit('functionCall', tool_call.function);\n                    }\n                }\n            }\n        }\n    }\n    /**\n     * @returns a promise that resolves with the final ChatCompletion, or rejects\n     * if an error occurred or the stream ended prematurely without producing a ChatCompletion.\n     */\n    async finalChatCompletion() {\n        await this.done();\n        const completion = this._chatCompletions[this._chatCompletions.length - 1];\n        if (!completion)\n            throw new OpenAIError('stream ended without producing a ChatCompletion');\n        return completion;\n    }\n    /**\n     * @returns a promise that resolves with the content of the final ChatCompletionMessage, or rejects\n     * if an error occurred or the stream ended prematurely without producing a ChatCompletionMessage.\n     */\n    async finalContent() {\n        await this.done();\n        return __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalContent).call(this);\n    }\n    /**\n     * @returns a promise that resolves with the the final assistant ChatCompletionMessage response,\n     * or rejects if an error occurred or the stream ended prematurely without producing a ChatCompletionMessage.\n     */\n    async finalMessage() {\n        await this.done();\n        return __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalMessage).call(this);\n    }\n    /**\n     * @returns a promise that resolves with the content of the final FunctionCall, or rejects\n     * if an error occurred or the stream ended prematurely without producing a ChatCompletionMessage.\n     */\n    async finalFunctionCall() {\n        await this.done();\n        return __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalFunctionCall).call(this);\n    }\n    async finalFunctionCallResult() {\n        await this.done();\n        return __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalFunctionCallResult).call(this);\n    }\n    async totalUsage() {\n        await this.done();\n        return __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_calculateTotalUsage).call(this);\n    }\n    allChatCompletions() {\n        return [...this._chatCompletions];\n    }\n    _emitFinal() {\n        const completion = this._chatCompletions[this._chatCompletions.length - 1];\n        if (completion)\n            this._emit('finalChatCompletion', completion);\n        const finalMessage = __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalMessage).call(this);\n        if (finalMessage)\n            this._emit('finalMessage', finalMessage);\n        const finalContent = __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalContent).call(this);\n        if (finalContent)\n            this._emit('finalContent', finalContent);\n        const finalFunctionCall = __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalFunctionCall).call(this);\n        if (finalFunctionCall)\n            this._emit('finalFunctionCall', finalFunctionCall);\n        const finalFunctionCallResult = __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalFunctionCallResult).call(this);\n        if (finalFunctionCallResult != null)\n            this._emit('finalFunctionCallResult', finalFunctionCallResult);\n        if (this._chatCompletions.some((c) => c.usage)) {\n            this._emit('totalUsage', __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_calculateTotalUsage).call(this));\n        }\n    }\n    async _createChatCompletion(client, params, options) {\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_validateParams).call(this, params);\n        const chatCompletion = await client.chat.completions.create({ ...params, stream: false }, { ...options, signal: this.controller.signal });\n        this._connected();\n        return this._addChatCompletion(parseChatCompletion(chatCompletion, params));\n    }\n    async _runChatCompletion(client, params, options) {\n        for (const message of params.messages) {\n            this._addMessage(message, false);\n        }\n        return await this._createChatCompletion(client, params, options);\n    }\n    async _runFunctions(client, params, options) {\n        const role = 'function';\n        const { function_call = 'auto', stream, ...restParams } = params;\n        const singleFunctionToCall = typeof function_call !== 'string' && function_call?.name;\n        const { maxChatCompletions = DEFAULT_MAX_CHAT_COMPLETIONS } = options || {};\n        const functionsByName = {};\n        for (const f of params.functions) {\n            functionsByName[f.name || f.function.name] = f;\n        }\n        const functions = params.functions.map((f) => ({\n            name: f.name || f.function.name,\n            parameters: f.parameters,\n            description: f.description,\n        }));\n        for (const message of params.messages) {\n            this._addMessage(message, false);\n        }\n        for (let i = 0; i < maxChatCompletions; ++i) {\n            const chatCompletion = await this._createChatCompletion(client, {\n                ...restParams,\n                function_call,\n                functions,\n                messages: [...this.messages],\n            }, options);\n            const message = chatCompletion.choices[0]?.message;\n            if (!message) {\n                throw new OpenAIError(`missing message in ChatCompletion response`);\n            }\n            if (!message.function_call)\n                return;\n            const { name, arguments: args } = message.function_call;\n            const fn = functionsByName[name];\n            if (!fn) {\n                const content = `Invalid function_call: ${JSON.stringify(name)}. Available options are: ${functions\n                    .map((f) => JSON.stringify(f.name))\n                    .join(', ')}. Please try again`;\n                this._addMessage({ role, name, content });\n                continue;\n            }\n            else if (singleFunctionToCall && singleFunctionToCall !== name) {\n                const content = `Invalid function_call: ${JSON.stringify(name)}. ${JSON.stringify(singleFunctionToCall)} requested. Please try again`;\n                this._addMessage({ role, name, content });\n                continue;\n            }\n            let parsed;\n            try {\n                parsed = isRunnableFunctionWithParse(fn) ? await fn.parse(args) : args;\n            }\n            catch (error) {\n                this._addMessage({\n                    role,\n                    name,\n                    content: error instanceof Error ? error.message : String(error),\n                });\n                continue;\n            }\n            // @ts-expect-error it can't rule out `never` type.\n            const rawContent = await fn.function(parsed, this);\n            const content = __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_stringifyFunctionCallResult).call(this, rawContent);\n            this._addMessage({ role, name, content });\n            if (singleFunctionToCall)\n                return;\n        }\n    }\n    async _runTools(client, params, options) {\n        const role = 'tool';\n        const { tool_choice = 'auto', stream, ...restParams } = params;\n        const singleFunctionToCall = typeof tool_choice !== 'string' && tool_choice?.function?.name;\n        const { maxChatCompletions = DEFAULT_MAX_CHAT_COMPLETIONS } = options || {};\n        // TODO(someday): clean this logic up\n        const inputTools = params.tools.map((tool) => {\n            if (isAutoParsableTool(tool)) {\n                if (!tool.$callback) {\n                    throw new OpenAIError('Tool given to `.runTools()` that does not have an associated function');\n                }\n                return {\n                    type: 'function',\n                    function: {\n                        function: tool.$callback,\n                        name: tool.function.name,\n                        description: tool.function.description || '',\n                        parameters: tool.function.parameters,\n                        parse: tool.$parseRaw,\n                        strict: true,\n                    },\n                };\n            }\n            return tool;\n        });\n        const functionsByName = {};\n        for (const f of inputTools) {\n            if (f.type === 'function') {\n                functionsByName[f.function.name || f.function.function.name] = f.function;\n            }\n        }\n        const tools = 'tools' in params ?\n            inputTools.map((t) => t.type === 'function' ?\n                {\n                    type: 'function',\n                    function: {\n                        name: t.function.name || t.function.function.name,\n                        parameters: t.function.parameters,\n                        description: t.function.description,\n                        strict: t.function.strict,\n                    },\n                }\n                : t)\n            : undefined;\n        for (const message of params.messages) {\n            this._addMessage(message, false);\n        }\n        for (let i = 0; i < maxChatCompletions; ++i) {\n            const chatCompletion = await this._createChatCompletion(client, {\n                ...restParams,\n                tool_choice,\n                tools,\n                messages: [...this.messages],\n            }, options);\n            const message = chatCompletion.choices[0]?.message;\n            if (!message) {\n                throw new OpenAIError(`missing message in ChatCompletion response`);\n            }\n            if (!message.tool_calls?.length) {\n                return;\n            }\n            for (const tool_call of message.tool_calls) {\n                if (tool_call.type !== 'function')\n                    continue;\n                const tool_call_id = tool_call.id;\n                const { name, arguments: args } = tool_call.function;\n                const fn = functionsByName[name];\n                if (!fn) {\n                    const content = `Invalid tool_call: ${JSON.stringify(name)}. Available options are: ${Object.keys(functionsByName)\n                        .map((name) => JSON.stringify(name))\n                        .join(', ')}. Please try again`;\n                    this._addMessage({ role, tool_call_id, content });\n                    continue;\n                }\n                else if (singleFunctionToCall && singleFunctionToCall !== name) {\n                    const content = `Invalid tool_call: ${JSON.stringify(name)}. ${JSON.stringify(singleFunctionToCall)} requested. Please try again`;\n                    this._addMessage({ role, tool_call_id, content });\n                    continue;\n                }\n                let parsed;\n                try {\n                    parsed = isRunnableFunctionWithParse(fn) ? await fn.parse(args) : args;\n                }\n                catch (error) {\n                    const content = error instanceof Error ? error.message : String(error);\n                    this._addMessage({ role, tool_call_id, content });\n                    continue;\n                }\n                // @ts-expect-error it can't rule out `never` type.\n                const rawContent = await fn.function(parsed, this);\n                const content = __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_stringifyFunctionCallResult).call(this, rawContent);\n                this._addMessage({ role, tool_call_id, content });\n                if (singleFunctionToCall) {\n                    return;\n                }\n            }\n        }\n        return;\n    }\n}\n_AbstractChatCompletionRunner_instances = new WeakSet(), _AbstractChatCompletionRunner_getFinalContent = function _AbstractChatCompletionRunner_getFinalContent() {\n    return __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalMessage).call(this).content ?? null;\n}, _AbstractChatCompletionRunner_getFinalMessage = function _AbstractChatCompletionRunner_getFinalMessage() {\n    let i = this.messages.length;\n    while (i-- > 0) {\n        const message = this.messages[i];\n        if (isAssistantMessage(message)) {\n            const { function_call, ...rest } = message;\n            // TODO: support audio here\n            const ret = {\n                ...rest,\n                content: message.content ?? null,\n                refusal: message.refusal ?? null,\n            };\n            if (function_call) {\n                ret.function_call = function_call;\n            }\n            return ret;\n        }\n    }\n    throw new OpenAIError('stream ended without producing a ChatCompletionMessage with role=assistant');\n}, _AbstractChatCompletionRunner_getFinalFunctionCall = function _AbstractChatCompletionRunner_getFinalFunctionCall() {\n    for (let i = this.messages.length - 1; i >= 0; i--) {\n        const message = this.messages[i];\n        if (isAssistantMessage(message) && message?.function_call) {\n            return message.function_call;\n        }\n        if (isAssistantMessage(message) && message?.tool_calls?.length) {\n            return message.tool_calls.at(-1)?.function;\n        }\n    }\n    return;\n}, _AbstractChatCompletionRunner_getFinalFunctionCallResult = function _AbstractChatCompletionRunner_getFinalFunctionCallResult() {\n    for (let i = this.messages.length - 1; i >= 0; i--) {\n        const message = this.messages[i];\n        if (isFunctionMessage(message) && message.content != null) {\n            return message.content;\n        }\n        if (isToolMessage(message) &&\n            message.content != null &&\n            typeof message.content === 'string' &&\n            this.messages.some((x) => x.role === 'assistant' &&\n                x.tool_calls?.some((y) => y.type === 'function' && y.id === message.tool_call_id))) {\n            return message.content;\n        }\n    }\n    return;\n}, _AbstractChatCompletionRunner_calculateTotalUsage = function _AbstractChatCompletionRunner_calculateTotalUsage() {\n    const total = {\n        completion_tokens: 0,\n        prompt_tokens: 0,\n        total_tokens: 0,\n    };\n    for (const { usage } of this._chatCompletions) {\n        if (usage) {\n            total.completion_tokens += usage.completion_tokens;\n            total.prompt_tokens += usage.prompt_tokens;\n            total.total_tokens += usage.total_tokens;\n        }\n    }\n    return total;\n}, _AbstractChatCompletionRunner_validateParams = function _AbstractChatCompletionRunner_validateParams(params) {\n    if (params.n != null && params.n > 1) {\n        throw new OpenAIError('ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.');\n    }\n}, _AbstractChatCompletionRunner_stringifyFunctionCallResult = function _AbstractChatCompletionRunner_stringifyFunctionCallResult(rawContent) {\n    return (typeof rawContent === 'string' ? rawContent\n        : rawContent === undefined ? 'undefined'\n            : JSON.stringify(rawContent));\n};\n//# sourceMappingURL=AbstractChatCompletionRunner.mjs.map","import { AbstractChatCompletionRunner, } from \"./AbstractChatCompletionRunner.mjs\";\nimport { isAssistantMessage } from \"./chatCompletionUtils.mjs\";\nexport class ChatCompletionRunner extends AbstractChatCompletionRunner {\n    /** @deprecated - please use `runTools` instead. */\n    static runFunctions(client, params, options) {\n        const runner = new ChatCompletionRunner();\n        const opts = {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'runFunctions' },\n        };\n        runner._run(() => runner._runFunctions(client, params, opts));\n        return runner;\n    }\n    static runTools(client, params, options) {\n        const runner = new ChatCompletionRunner();\n        const opts = {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'runTools' },\n        };\n        runner._run(() => runner._runTools(client, params, opts));\n        return runner;\n    }\n    _addMessage(message, emit = true) {\n        super._addMessage(message, emit);\n        if (isAssistantMessage(message) && message.content) {\n            this._emit('content', message.content);\n        }\n    }\n}\n//# sourceMappingURL=ChatCompletionRunner.mjs.map","const STR = 0b000000001;\nconst NUM = 0b000000010;\nconst ARR = 0b000000100;\nconst OBJ = 0b000001000;\nconst NULL = 0b000010000;\nconst BOOL = 0b000100000;\nconst NAN = 0b001000000;\nconst INFINITY = 0b010000000;\nconst MINUS_INFINITY = 0b100000000;\nconst INF = INFINITY | MINUS_INFINITY;\nconst SPECIAL = NULL | BOOL | INF | NAN;\nconst ATOM = STR | NUM | SPECIAL;\nconst COLLECTION = ARR | OBJ;\nconst ALL = ATOM | COLLECTION;\nconst Allow = {\n    STR,\n    NUM,\n    ARR,\n    OBJ,\n    NULL,\n    BOOL,\n    NAN,\n    INFINITY,\n    MINUS_INFINITY,\n    INF,\n    SPECIAL,\n    ATOM,\n    COLLECTION,\n    ALL,\n};\n// The JSON string segment was unable to be parsed completely\nclass PartialJSON extends Error {\n}\nclass MalformedJSON extends Error {\n}\n/**\n * Parse incomplete JSON\n * @param {string} jsonString Partial JSON to be parsed\n * @param {number} allowPartial Specify what types are allowed to be partial, see {@link Allow} for details\n * @returns The parsed JSON\n * @throws {PartialJSON} If the JSON is incomplete (related to the `allow` parameter)\n * @throws {MalformedJSON} If the JSON is malformed\n */\nfunction parseJSON(jsonString, allowPartial = Allow.ALL) {\n    if (typeof jsonString !== 'string') {\n        throw new TypeError(`expecting str, got ${typeof jsonString}`);\n    }\n    if (!jsonString.trim()) {\n        throw new Error(`${jsonString} is empty`);\n    }\n    return _parseJSON(jsonString.trim(), allowPartial);\n}\nconst _parseJSON = (jsonString, allow) => {\n    const length = jsonString.length;\n    let index = 0;\n    const markPartialJSON = (msg) => {\n        throw new PartialJSON(`${msg} at position ${index}`);\n    };\n    const throwMalformedError = (msg) => {\n        throw new MalformedJSON(`${msg} at position ${index}`);\n    };\n    const parseAny = () => {\n        skipBlank();\n        if (index >= length)\n            markPartialJSON('Unexpected end of input');\n        if (jsonString[index] === '\"')\n            return parseStr();\n        if (jsonString[index] === '{')\n            return parseObj();\n        if (jsonString[index] === '[')\n            return parseArr();\n        if (jsonString.substring(index, index + 4) === 'null' ||\n            (Allow.NULL & allow && length - index < 4 && 'null'.startsWith(jsonString.substring(index)))) {\n            index += 4;\n            return null;\n        }\n        if (jsonString.substring(index, index + 4) === 'true' ||\n            (Allow.BOOL & allow && length - index < 4 && 'true'.startsWith(jsonString.substring(index)))) {\n            index += 4;\n            return true;\n        }\n        if (jsonString.substring(index, index + 5) === 'false' ||\n            (Allow.BOOL & allow && length - index < 5 && 'false'.startsWith(jsonString.substring(index)))) {\n            index += 5;\n            return false;\n        }\n        if (jsonString.substring(index, index + 8) === 'Infinity' ||\n            (Allow.INFINITY & allow && length - index < 8 && 'Infinity'.startsWith(jsonString.substring(index)))) {\n            index += 8;\n            return Infinity;\n        }\n        if (jsonString.substring(index, index + 9) === '-Infinity' ||\n            (Allow.MINUS_INFINITY & allow &&\n                1 < length - index &&\n                length - index < 9 &&\n                '-Infinity'.startsWith(jsonString.substring(index)))) {\n            index += 9;\n            return -Infinity;\n        }\n        if (jsonString.substring(index, index + 3) === 'NaN' ||\n            (Allow.NAN & allow && length - index < 3 && 'NaN'.startsWith(jsonString.substring(index)))) {\n            index += 3;\n            return NaN;\n        }\n        return parseNum();\n    };\n    const parseStr = () => {\n        const start = index;\n        let escape = false;\n        index++; // skip initial quote\n        while (index < length && (jsonString[index] !== '\"' || (escape && jsonString[index - 1] === '\\\\'))) {\n            escape = jsonString[index] === '\\\\' ? !escape : false;\n            index++;\n        }\n        if (jsonString.charAt(index) == '\"') {\n            try {\n                return JSON.parse(jsonString.substring(start, ++index - Number(escape)));\n            }\n            catch (e) {\n                throwMalformedError(String(e));\n            }\n        }\n        else if (Allow.STR & allow) {\n            try {\n                return JSON.parse(jsonString.substring(start, index - Number(escape)) + '\"');\n            }\n            catch (e) {\n                // SyntaxError: Invalid escape sequence\n                return JSON.parse(jsonString.substring(start, jsonString.lastIndexOf('\\\\')) + '\"');\n            }\n        }\n        markPartialJSON('Unterminated string literal');\n    };\n    const parseObj = () => {\n        index++; // skip initial brace\n        skipBlank();\n        const obj = {};\n        try {\n            while (jsonString[index] !== '}') {\n                skipBlank();\n                if (index >= length && Allow.OBJ & allow)\n                    return obj;\n                const key = parseStr();\n                skipBlank();\n                index++; // skip colon\n                try {\n                    const value = parseAny();\n                    Object.defineProperty(obj, key, { value, writable: true, enumerable: true, configurable: true });\n                }\n                catch (e) {\n                    if (Allow.OBJ & allow)\n                        return obj;\n                    else\n                        throw e;\n                }\n                skipBlank();\n                if (jsonString[index] === ',')\n                    index++; // skip comma\n            }\n        }\n        catch (e) {\n            if (Allow.OBJ & allow)\n                return obj;\n            else\n                markPartialJSON(\"Expected '}' at end of object\");\n        }\n        index++; // skip final brace\n        return obj;\n    };\n    const parseArr = () => {\n        index++; // skip initial bracket\n        const arr = [];\n        try {\n            while (jsonString[index] !== ']') {\n                arr.push(parseAny());\n                skipBlank();\n                if (jsonString[index] === ',') {\n                    index++; // skip comma\n                }\n            }\n        }\n        catch (e) {\n            if (Allow.ARR & allow) {\n                return arr;\n            }\n            markPartialJSON(\"Expected ']' at end of array\");\n        }\n        index++; // skip final bracket\n        return arr;\n    };\n    const parseNum = () => {\n        if (index === 0) {\n            if (jsonString === '-' && Allow.NUM & allow)\n                markPartialJSON(\"Not sure what '-' is\");\n            try {\n                return JSON.parse(jsonString);\n            }\n            catch (e) {\n                if (Allow.NUM & allow) {\n                    try {\n                        if ('.' === jsonString[jsonString.length - 1])\n                            return JSON.parse(jsonString.substring(0, jsonString.lastIndexOf('.')));\n                        return JSON.parse(jsonString.substring(0, jsonString.lastIndexOf('e')));\n                    }\n                    catch (e) { }\n                }\n                throwMalformedError(String(e));\n            }\n        }\n        const start = index;\n        if (jsonString[index] === '-')\n            index++;\n        while (jsonString[index] && !',]}'.includes(jsonString[index]))\n            index++;\n        if (index == length && !(Allow.NUM & allow))\n            markPartialJSON('Unterminated number literal');\n        try {\n            return JSON.parse(jsonString.substring(start, index));\n        }\n        catch (e) {\n            if (jsonString.substring(start, index) === '-' && Allow.NUM & allow)\n                markPartialJSON(\"Not sure what '-' is\");\n            try {\n                return JSON.parse(jsonString.substring(start, jsonString.lastIndexOf('e')));\n            }\n            catch (e) {\n                throwMalformedError(String(e));\n            }\n        }\n    };\n    const skipBlank = () => {\n        while (index < length && ' \\n\\r\\t'.includes(jsonString[index])) {\n            index++;\n        }\n    };\n    return parseAny();\n};\n// using this function with malformed JSON is undefined behavior\nconst partialParse = (input) => parseJSON(input, Allow.ALL ^ Allow.NUM);\nexport { partialParse, PartialJSON, MalformedJSON };\n//# sourceMappingURL=parser.mjs.map","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _ChatCompletionStream_instances, _ChatCompletionStream_params, _ChatCompletionStream_choiceEventStates, _ChatCompletionStream_currentChatCompletionSnapshot, _ChatCompletionStream_beginRequest, _ChatCompletionStream_getChoiceEventState, _ChatCompletionStream_addChunk, _ChatCompletionStream_emitToolCallDoneEvent, _ChatCompletionStream_emitContentDoneEvents, _ChatCompletionStream_endRequest, _ChatCompletionStream_getAutoParseableResponseFormat, _ChatCompletionStream_accumulateChatCompletion;\nimport { OpenAIError, APIUserAbortError, LengthFinishReasonError, ContentFilterFinishReasonError, } from \"../error.mjs\";\nimport { AbstractChatCompletionRunner, } from \"./AbstractChatCompletionRunner.mjs\";\nimport { Stream } from \"../streaming.mjs\";\nimport { hasAutoParseableInput, isAutoParsableResponseFormat, isAutoParsableTool, maybeParseChatCompletion, shouldParseToolCall, } from \"../lib/parser.mjs\";\nimport { partialParse } from \"../_vendor/partial-json-parser/parser.mjs\";\nexport class ChatCompletionStream extends AbstractChatCompletionRunner {\n    constructor(params) {\n        super();\n        _ChatCompletionStream_instances.add(this);\n        _ChatCompletionStream_params.set(this, void 0);\n        _ChatCompletionStream_choiceEventStates.set(this, void 0);\n        _ChatCompletionStream_currentChatCompletionSnapshot.set(this, void 0);\n        __classPrivateFieldSet(this, _ChatCompletionStream_params, params, \"f\");\n        __classPrivateFieldSet(this, _ChatCompletionStream_choiceEventStates, [], \"f\");\n    }\n    get currentChatCompletionSnapshot() {\n        return __classPrivateFieldGet(this, _ChatCompletionStream_currentChatCompletionSnapshot, \"f\");\n    }\n    /**\n     * Intended for use on the frontend, consuming a stream produced with\n     * `.toReadableStream()` on the backend.\n     *\n     * Note that messages sent to the model do not appear in `.on('message')`\n     * in this context.\n     */\n    static fromReadableStream(stream) {\n        const runner = new ChatCompletionStream(null);\n        runner._run(() => runner._fromReadableStream(stream));\n        return runner;\n    }\n    static createChatCompletion(client, params, options) {\n        const runner = new ChatCompletionStream(params);\n        runner._run(() => runner._runChatCompletion(client, { ...params, stream: true }, { ...options, headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'stream' } }));\n        return runner;\n    }\n    async _createChatCompletion(client, params, options) {\n        super._createChatCompletion;\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_beginRequest).call(this);\n        const stream = await client.chat.completions.create({ ...params, stream: true }, { ...options, signal: this.controller.signal });\n        this._connected();\n        for await (const chunk of stream) {\n            __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_addChunk).call(this, chunk);\n        }\n        if (stream.controller.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        return this._addChatCompletion(__classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_endRequest).call(this));\n    }\n    async _fromReadableStream(readableStream, options) {\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_beginRequest).call(this);\n        this._connected();\n        const stream = Stream.fromReadableStream(readableStream, this.controller);\n        let chatId;\n        for await (const chunk of stream) {\n            if (chatId && chatId !== chunk.id) {\n                // A new request has been made.\n                this._addChatCompletion(__classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_endRequest).call(this));\n            }\n            __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_addChunk).call(this, chunk);\n            chatId = chunk.id;\n        }\n        if (stream.controller.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        return this._addChatCompletion(__classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_endRequest).call(this));\n    }\n    [(_ChatCompletionStream_params = new WeakMap(), _ChatCompletionStream_choiceEventStates = new WeakMap(), _ChatCompletionStream_currentChatCompletionSnapshot = new WeakMap(), _ChatCompletionStream_instances = new WeakSet(), _ChatCompletionStream_beginRequest = function _ChatCompletionStream_beginRequest() {\n        if (this.ended)\n            return;\n        __classPrivateFieldSet(this, _ChatCompletionStream_currentChatCompletionSnapshot, undefined, \"f\");\n    }, _ChatCompletionStream_getChoiceEventState = function _ChatCompletionStream_getChoiceEventState(choice) {\n        let state = __classPrivateFieldGet(this, _ChatCompletionStream_choiceEventStates, \"f\")[choice.index];\n        if (state) {\n            return state;\n        }\n        state = {\n            content_done: false,\n            refusal_done: false,\n            logprobs_content_done: false,\n            logprobs_refusal_done: false,\n            done_tool_calls: new Set(),\n            current_tool_call_index: null,\n        };\n        __classPrivateFieldGet(this, _ChatCompletionStream_choiceEventStates, \"f\")[choice.index] = state;\n        return state;\n    }, _ChatCompletionStream_addChunk = function _ChatCompletionStream_addChunk(chunk) {\n        if (this.ended)\n            return;\n        const completion = __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_accumulateChatCompletion).call(this, chunk);\n        this._emit('chunk', chunk, completion);\n        for (const choice of chunk.choices) {\n            const choiceSnapshot = completion.choices[choice.index];\n            if (choice.delta.content != null &&\n                choiceSnapshot.message?.role === 'assistant' &&\n                choiceSnapshot.message?.content) {\n                this._emit('content', choice.delta.content, choiceSnapshot.message.content);\n                this._emit('content.delta', {\n                    delta: choice.delta.content,\n                    snapshot: choiceSnapshot.message.content,\n                    parsed: choiceSnapshot.message.parsed,\n                });\n            }\n            if (choice.delta.refusal != null &&\n                choiceSnapshot.message?.role === 'assistant' &&\n                choiceSnapshot.message?.refusal) {\n                this._emit('refusal.delta', {\n                    delta: choice.delta.refusal,\n                    snapshot: choiceSnapshot.message.refusal,\n                });\n            }\n            if (choice.logprobs?.content != null && choiceSnapshot.message?.role === 'assistant') {\n                this._emit('logprobs.content.delta', {\n                    content: choice.logprobs?.content,\n                    snapshot: choiceSnapshot.logprobs?.content ?? [],\n                });\n            }\n            if (choice.logprobs?.refusal != null && choiceSnapshot.message?.role === 'assistant') {\n                this._emit('logprobs.refusal.delta', {\n                    refusal: choice.logprobs?.refusal,\n                    snapshot: choiceSnapshot.logprobs?.refusal ?? [],\n                });\n            }\n            const state = __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_getChoiceEventState).call(this, choiceSnapshot);\n            if (choiceSnapshot.finish_reason) {\n                __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_emitContentDoneEvents).call(this, choiceSnapshot);\n                if (state.current_tool_call_index != null) {\n                    __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_emitToolCallDoneEvent).call(this, choiceSnapshot, state.current_tool_call_index);\n                }\n            }\n            for (const toolCall of choice.delta.tool_calls ?? []) {\n                if (state.current_tool_call_index !== toolCall.index) {\n                    __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_emitContentDoneEvents).call(this, choiceSnapshot);\n                    // new tool call started, the previous one is done\n                    if (state.current_tool_call_index != null) {\n                        __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_emitToolCallDoneEvent).call(this, choiceSnapshot, state.current_tool_call_index);\n                    }\n                }\n                state.current_tool_call_index = toolCall.index;\n            }\n            for (const toolCallDelta of choice.delta.tool_calls ?? []) {\n                const toolCallSnapshot = choiceSnapshot.message.tool_calls?.[toolCallDelta.index];\n                if (!toolCallSnapshot?.type) {\n                    continue;\n                }\n                if (toolCallSnapshot?.type === 'function') {\n                    this._emit('tool_calls.function.arguments.delta', {\n                        name: toolCallSnapshot.function?.name,\n                        index: toolCallDelta.index,\n                        arguments: toolCallSnapshot.function.arguments,\n                        parsed_arguments: toolCallSnapshot.function.parsed_arguments,\n                        arguments_delta: toolCallDelta.function?.arguments ?? '',\n                    });\n                }\n                else {\n                    assertNever(toolCallSnapshot?.type);\n                }\n            }\n        }\n    }, _ChatCompletionStream_emitToolCallDoneEvent = function _ChatCompletionStream_emitToolCallDoneEvent(choiceSnapshot, toolCallIndex) {\n        const state = __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_getChoiceEventState).call(this, choiceSnapshot);\n        if (state.done_tool_calls.has(toolCallIndex)) {\n            // we've already fired the done event\n            return;\n        }\n        const toolCallSnapshot = choiceSnapshot.message.tool_calls?.[toolCallIndex];\n        if (!toolCallSnapshot) {\n            throw new Error('no tool call snapshot');\n        }\n        if (!toolCallSnapshot.type) {\n            throw new Error('tool call snapshot missing `type`');\n        }\n        if (toolCallSnapshot.type === 'function') {\n            const inputTool = __classPrivateFieldGet(this, _ChatCompletionStream_params, \"f\")?.tools?.find((tool) => tool.type === 'function' && tool.function.name === toolCallSnapshot.function.name);\n            this._emit('tool_calls.function.arguments.done', {\n                name: toolCallSnapshot.function.name,\n                index: toolCallIndex,\n                arguments: toolCallSnapshot.function.arguments,\n                parsed_arguments: isAutoParsableTool(inputTool) ? inputTool.$parseRaw(toolCallSnapshot.function.arguments)\n                    : inputTool?.function.strict ? JSON.parse(toolCallSnapshot.function.arguments)\n                        : null,\n            });\n        }\n        else {\n            assertNever(toolCallSnapshot.type);\n        }\n    }, _ChatCompletionStream_emitContentDoneEvents = function _ChatCompletionStream_emitContentDoneEvents(choiceSnapshot) {\n        const state = __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_getChoiceEventState).call(this, choiceSnapshot);\n        if (choiceSnapshot.message.content && !state.content_done) {\n            state.content_done = true;\n            const responseFormat = __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_getAutoParseableResponseFormat).call(this);\n            this._emit('content.done', {\n                content: choiceSnapshot.message.content,\n                parsed: responseFormat ? responseFormat.$parseRaw(choiceSnapshot.message.content) : null,\n            });\n        }\n        if (choiceSnapshot.message.refusal && !state.refusal_done) {\n            state.refusal_done = true;\n            this._emit('refusal.done', { refusal: choiceSnapshot.message.refusal });\n        }\n        if (choiceSnapshot.logprobs?.content && !state.logprobs_content_done) {\n            state.logprobs_content_done = true;\n            this._emit('logprobs.content.done', { content: choiceSnapshot.logprobs.content });\n        }\n        if (choiceSnapshot.logprobs?.refusal && !state.logprobs_refusal_done) {\n            state.logprobs_refusal_done = true;\n            this._emit('logprobs.refusal.done', { refusal: choiceSnapshot.logprobs.refusal });\n        }\n    }, _ChatCompletionStream_endRequest = function _ChatCompletionStream_endRequest() {\n        if (this.ended) {\n            throw new OpenAIError(`stream has ended, this shouldn't happen`);\n        }\n        const snapshot = __classPrivateFieldGet(this, _ChatCompletionStream_currentChatCompletionSnapshot, \"f\");\n        if (!snapshot) {\n            throw new OpenAIError(`request ended without sending any chunks`);\n        }\n        __classPrivateFieldSet(this, _ChatCompletionStream_currentChatCompletionSnapshot, undefined, \"f\");\n        __classPrivateFieldSet(this, _ChatCompletionStream_choiceEventStates, [], \"f\");\n        return finalizeChatCompletion(snapshot, __classPrivateFieldGet(this, _ChatCompletionStream_params, \"f\"));\n    }, _ChatCompletionStream_getAutoParseableResponseFormat = function _ChatCompletionStream_getAutoParseableResponseFormat() {\n        const responseFormat = __classPrivateFieldGet(this, _ChatCompletionStream_params, \"f\")?.response_format;\n        if (isAutoParsableResponseFormat(responseFormat)) {\n            return responseFormat;\n        }\n        return null;\n    }, _ChatCompletionStream_accumulateChatCompletion = function _ChatCompletionStream_accumulateChatCompletion(chunk) {\n        var _a, _b, _c, _d;\n        let snapshot = __classPrivateFieldGet(this, _ChatCompletionStream_currentChatCompletionSnapshot, \"f\");\n        const { choices, ...rest } = chunk;\n        if (!snapshot) {\n            snapshot = __classPrivateFieldSet(this, _ChatCompletionStream_currentChatCompletionSnapshot, {\n                ...rest,\n                choices: [],\n            }, \"f\");\n        }\n        else {\n            Object.assign(snapshot, rest);\n        }\n        for (const { delta, finish_reason, index, logprobs = null, ...other } of chunk.choices) {\n            let choice = snapshot.choices[index];\n            if (!choice) {\n                choice = snapshot.choices[index] = { finish_reason, index, message: {}, logprobs, ...other };\n            }\n            if (logprobs) {\n                if (!choice.logprobs) {\n                    choice.logprobs = Object.assign({}, logprobs);\n                }\n                else {\n                    const { content, refusal, ...rest } = logprobs;\n                    assertIsEmpty(rest);\n                    Object.assign(choice.logprobs, rest);\n                    if (content) {\n                        (_a = choice.logprobs).content ?? (_a.content = []);\n                        choice.logprobs.content.push(...content);\n                    }\n                    if (refusal) {\n                        (_b = choice.logprobs).refusal ?? (_b.refusal = []);\n                        choice.logprobs.refusal.push(...refusal);\n                    }\n                }\n            }\n            if (finish_reason) {\n                choice.finish_reason = finish_reason;\n                if (__classPrivateFieldGet(this, _ChatCompletionStream_params, \"f\") && hasAutoParseableInput(__classPrivateFieldGet(this, _ChatCompletionStream_params, \"f\"))) {\n                    if (finish_reason === 'length') {\n                        throw new LengthFinishReasonError();\n                    }\n                    if (finish_reason === 'content_filter') {\n                        throw new ContentFilterFinishReasonError();\n                    }\n                }\n            }\n            Object.assign(choice, other);\n            if (!delta)\n                continue; // Shouldn't happen; just in case.\n            const { content, refusal, function_call, role, tool_calls, ...rest } = delta;\n            assertIsEmpty(rest);\n            Object.assign(choice.message, rest);\n            if (refusal) {\n                choice.message.refusal = (choice.message.refusal || '') + refusal;\n            }\n            if (role)\n                choice.message.role = role;\n            if (function_call) {\n                if (!choice.message.function_call) {\n                    choice.message.function_call = function_call;\n                }\n                else {\n                    if (function_call.name)\n                        choice.message.function_call.name = function_call.name;\n                    if (function_call.arguments) {\n                        (_c = choice.message.function_call).arguments ?? (_c.arguments = '');\n                        choice.message.function_call.arguments += function_call.arguments;\n                    }\n                }\n            }\n            if (content) {\n                choice.message.content = (choice.message.content || '') + content;\n                if (!choice.message.refusal && __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_getAutoParseableResponseFormat).call(this)) {\n                    choice.message.parsed = partialParse(choice.message.content);\n                }\n            }\n            if (tool_calls) {\n                if (!choice.message.tool_calls)\n                    choice.message.tool_calls = [];\n                for (const { index, id, type, function: fn, ...rest } of tool_calls) {\n                    const tool_call = ((_d = choice.message.tool_calls)[index] ?? (_d[index] = {}));\n                    Object.assign(tool_call, rest);\n                    if (id)\n                        tool_call.id = id;\n                    if (type)\n                        tool_call.type = type;\n                    if (fn)\n                        tool_call.function ?? (tool_call.function = { name: fn.name ?? '', arguments: '' });\n                    if (fn?.name)\n                        tool_call.function.name = fn.name;\n                    if (fn?.arguments) {\n                        tool_call.function.arguments += fn.arguments;\n                        if (shouldParseToolCall(__classPrivateFieldGet(this, _ChatCompletionStream_params, \"f\"), tool_call)) {\n                            tool_call.function.parsed_arguments = partialParse(tool_call.function.arguments);\n                        }\n                    }\n                }\n            }\n        }\n        return snapshot;\n    }, Symbol.asyncIterator)]() {\n        const pushQueue = [];\n        const readQueue = [];\n        let done = false;\n        this.on('chunk', (chunk) => {\n            const reader = readQueue.shift();\n            if (reader) {\n                reader.resolve(chunk);\n            }\n            else {\n                pushQueue.push(chunk);\n            }\n        });\n        this.on('end', () => {\n            done = true;\n            for (const reader of readQueue) {\n                reader.resolve(undefined);\n            }\n            readQueue.length = 0;\n        });\n        this.on('abort', (err) => {\n            done = true;\n            for (const reader of readQueue) {\n                reader.reject(err);\n            }\n            readQueue.length = 0;\n        });\n        this.on('error', (err) => {\n            done = true;\n            for (const reader of readQueue) {\n                reader.reject(err);\n            }\n            readQueue.length = 0;\n        });\n        return {\n            next: async () => {\n                if (!pushQueue.length) {\n                    if (done) {\n                        return { value: undefined, done: true };\n                    }\n                    return new Promise((resolve, reject) => readQueue.push({ resolve, reject })).then((chunk) => (chunk ? { value: chunk, done: false } : { value: undefined, done: true }));\n                }\n                const chunk = pushQueue.shift();\n                return { value: chunk, done: false };\n            },\n            return: async () => {\n                this.abort();\n                return { value: undefined, done: true };\n            },\n        };\n    }\n    toReadableStream() {\n        const stream = new Stream(this[Symbol.asyncIterator].bind(this), this.controller);\n        return stream.toReadableStream();\n    }\n}\nfunction finalizeChatCompletion(snapshot, params) {\n    const { id, choices, created, model, system_fingerprint, ...rest } = snapshot;\n    const completion = {\n        ...rest,\n        id,\n        choices: choices.map(({ message, finish_reason, index, logprobs, ...choiceRest }) => {\n            if (!finish_reason) {\n                throw new OpenAIError(`missing finish_reason for choice ${index}`);\n            }\n            const { content = null, function_call, tool_calls, ...messageRest } = message;\n            const role = message.role; // this is what we expect; in theory it could be different which would make our types a slight lie but would be fine.\n            if (!role) {\n                throw new OpenAIError(`missing role for choice ${index}`);\n            }\n            if (function_call) {\n                const { arguments: args, name } = function_call;\n                if (args == null) {\n                    throw new OpenAIError(`missing function_call.arguments for choice ${index}`);\n                }\n                if (!name) {\n                    throw new OpenAIError(`missing function_call.name for choice ${index}`);\n                }\n                return {\n                    ...choiceRest,\n                    message: {\n                        content,\n                        function_call: { arguments: args, name },\n                        role,\n                        refusal: message.refusal ?? null,\n                    },\n                    finish_reason,\n                    index,\n                    logprobs,\n                };\n            }\n            if (tool_calls) {\n                return {\n                    ...choiceRest,\n                    index,\n                    finish_reason,\n                    logprobs,\n                    message: {\n                        ...messageRest,\n                        role,\n                        content,\n                        refusal: message.refusal ?? null,\n                        tool_calls: tool_calls.map((tool_call, i) => {\n                            const { function: fn, type, id, ...toolRest } = tool_call;\n                            const { arguments: args, name, ...fnRest } = fn || {};\n                            if (id == null) {\n                                throw new OpenAIError(`missing choices[${index}].tool_calls[${i}].id\\n${str(snapshot)}`);\n                            }\n                            if (type == null) {\n                                throw new OpenAIError(`missing choices[${index}].tool_calls[${i}].type\\n${str(snapshot)}`);\n                            }\n                            if (name == null) {\n                                throw new OpenAIError(`missing choices[${index}].tool_calls[${i}].function.name\\n${str(snapshot)}`);\n                            }\n                            if (args == null) {\n                                throw new OpenAIError(`missing choices[${index}].tool_calls[${i}].function.arguments\\n${str(snapshot)}`);\n                            }\n                            return { ...toolRest, id, type, function: { ...fnRest, name, arguments: args } };\n                        }),\n                    },\n                };\n            }\n            return {\n                ...choiceRest,\n                message: { ...messageRest, content, role, refusal: message.refusal ?? null },\n                finish_reason,\n                index,\n                logprobs,\n            };\n        }),\n        created,\n        model,\n        object: 'chat.completion',\n        ...(system_fingerprint ? { system_fingerprint } : {}),\n    };\n    return maybeParseChatCompletion(completion, params);\n}\nfunction str(x) {\n    return JSON.stringify(x);\n}\n/**\n * Ensures the given argument is an empty object, useful for\n * asserting that all known properties on an object have been\n * destructured.\n */\nfunction assertIsEmpty(obj) {\n    return;\n}\nfunction assertNever(_x) { }\n//# sourceMappingURL=ChatCompletionStream.mjs.map","import { ChatCompletionStream } from \"./ChatCompletionStream.mjs\";\nexport class ChatCompletionStreamingRunner extends ChatCompletionStream {\n    static fromReadableStream(stream) {\n        const runner = new ChatCompletionStreamingRunner(null);\n        runner._run(() => runner._fromReadableStream(stream));\n        return runner;\n    }\n    /** @deprecated - please use `runTools` instead. */\n    static runFunctions(client, params, options) {\n        const runner = new ChatCompletionStreamingRunner(null);\n        const opts = {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'runFunctions' },\n        };\n        runner._run(() => runner._runFunctions(client, params, opts));\n        return runner;\n    }\n    static runTools(client, params, options) {\n        const runner = new ChatCompletionStreamingRunner(\n        // @ts-expect-error TODO these types are incompatible\n        params);\n        const opts = {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'runTools' },\n        };\n        runner._run(() => runner._runTools(client, params, opts));\n        return runner;\n    }\n}\n//# sourceMappingURL=ChatCompletionStreamingRunner.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { ChatCompletionRunner } from \"../../../lib/ChatCompletionRunner.mjs\";\nimport { ChatCompletionStreamingRunner, } from \"../../../lib/ChatCompletionStreamingRunner.mjs\";\nimport { ChatCompletionStream } from \"../../../lib/ChatCompletionStream.mjs\";\nimport { parseChatCompletion, validateInputTools } from \"../../../lib/parser.mjs\";\nexport { ChatCompletionStreamingRunner, } from \"../../../lib/ChatCompletionStreamingRunner.mjs\";\nexport { ParsingFunction, ParsingToolFunction, } from \"../../../lib/RunnableFunction.mjs\";\nexport { ChatCompletionStream } from \"../../../lib/ChatCompletionStream.mjs\";\nexport { ChatCompletionRunner, } from \"../../../lib/ChatCompletionRunner.mjs\";\nexport class Completions extends APIResource {\n    parse(body, options) {\n        validateInputTools(body.tools);\n        return this._client.chat.completions\n            .create(body, {\n            ...options,\n            headers: {\n                ...options?.headers,\n                'X-Stainless-Helper-Method': 'beta.chat.completions.parse',\n            },\n        })\n            ._thenUnwrap((completion) => parseChatCompletion(completion, body));\n    }\n    runFunctions(body, options) {\n        if (body.stream) {\n            return ChatCompletionStreamingRunner.runFunctions(this._client, body, options);\n        }\n        return ChatCompletionRunner.runFunctions(this._client, body, options);\n    }\n    runTools(body, options) {\n        if (body.stream) {\n            return ChatCompletionStreamingRunner.runTools(this._client, body, options);\n        }\n        return ChatCompletionRunner.runTools(this._client, body, options);\n    }\n    /**\n     * Creates a chat completion stream\n     */\n    stream(body, options) {\n        return ChatCompletionStream.createChatCompletion(this._client, body, options);\n    }\n}\n//# sourceMappingURL=completions.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport * as CompletionsAPI from \"./completions.mjs\";\nexport class Chat extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.completions = new CompletionsAPI.Completions(this._client);\n    }\n}\n(function (Chat) {\n    Chat.Completions = CompletionsAPI.Completions;\n})(Chat || (Chat = {}));\n//# sourceMappingURL=chat.mjs.map","var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar _AssistantStream_instances, _AssistantStream_events, _AssistantStream_runStepSnapshots, _AssistantStream_messageSnapshots, _AssistantStream_messageSnapshot, _AssistantStream_finalRun, _AssistantStream_currentContentIndex, _AssistantStream_currentContent, _AssistantStream_currentToolCallIndex, _AssistantStream_currentToolCall, _AssistantStream_currentEvent, _AssistantStream_currentRunSnapshot, _AssistantStream_currentRunStepSnapshot, _AssistantStream_addEvent, _AssistantStream_endRequest, _AssistantStream_handleMessage, _AssistantStream_handleRunStep, _AssistantStream_handleEvent, _AssistantStream_accumulateRunStep, _AssistantStream_accumulateMessage, _AssistantStream_accumulateContent, _AssistantStream_handleRun;\nimport * as Core from \"../core.mjs\";\nimport { Stream } from \"../streaming.mjs\";\nimport { APIUserAbortError, OpenAIError } from \"../error.mjs\";\nimport { EventStream } from \"./EventStream.mjs\";\nexport class AssistantStream extends EventStream {\n    constructor() {\n        super(...arguments);\n        _AssistantStream_instances.add(this);\n        //Track all events in a single list for reference\n        _AssistantStream_events.set(this, []);\n        //Used to accumulate deltas\n        //We are accumulating many types so the value here is not strict\n        _AssistantStream_runStepSnapshots.set(this, {});\n        _AssistantStream_messageSnapshots.set(this, {});\n        _AssistantStream_messageSnapshot.set(this, void 0);\n        _AssistantStream_finalRun.set(this, void 0);\n        _AssistantStream_currentContentIndex.set(this, void 0);\n        _AssistantStream_currentContent.set(this, void 0);\n        _AssistantStream_currentToolCallIndex.set(this, void 0);\n        _AssistantStream_currentToolCall.set(this, void 0);\n        //For current snapshot methods\n        _AssistantStream_currentEvent.set(this, void 0);\n        _AssistantStream_currentRunSnapshot.set(this, void 0);\n        _AssistantStream_currentRunStepSnapshot.set(this, void 0);\n    }\n    [(_AssistantStream_events = new WeakMap(), _AssistantStream_runStepSnapshots = new WeakMap(), _AssistantStream_messageSnapshots = new WeakMap(), _AssistantStream_messageSnapshot = new WeakMap(), _AssistantStream_finalRun = new WeakMap(), _AssistantStream_currentContentIndex = new WeakMap(), _AssistantStream_currentContent = new WeakMap(), _AssistantStream_currentToolCallIndex = new WeakMap(), _AssistantStream_currentToolCall = new WeakMap(), _AssistantStream_currentEvent = new WeakMap(), _AssistantStream_currentRunSnapshot = new WeakMap(), _AssistantStream_currentRunStepSnapshot = new WeakMap(), _AssistantStream_instances = new WeakSet(), Symbol.asyncIterator)]() {\n        const pushQueue = [];\n        const readQueue = [];\n        let done = false;\n        //Catch all for passing along all events\n        this.on('event', (event) => {\n            const reader = readQueue.shift();\n            if (reader) {\n                reader.resolve(event);\n            }\n            else {\n                pushQueue.push(event);\n            }\n        });\n        this.on('end', () => {\n            done = true;\n            for (const reader of readQueue) {\n                reader.resolve(undefined);\n            }\n            readQueue.length = 0;\n        });\n        this.on('abort', (err) => {\n            done = true;\n            for (const reader of readQueue) {\n                reader.reject(err);\n            }\n            readQueue.length = 0;\n        });\n        this.on('error', (err) => {\n            done = true;\n            for (const reader of readQueue) {\n                reader.reject(err);\n            }\n            readQueue.length = 0;\n        });\n        return {\n            next: async () => {\n                if (!pushQueue.length) {\n                    if (done) {\n                        return { value: undefined, done: true };\n                    }\n                    return new Promise((resolve, reject) => readQueue.push({ resolve, reject })).then((chunk) => (chunk ? { value: chunk, done: false } : { value: undefined, done: true }));\n                }\n                const chunk = pushQueue.shift();\n                return { value: chunk, done: false };\n            },\n            return: async () => {\n                this.abort();\n                return { value: undefined, done: true };\n            },\n        };\n    }\n    static fromReadableStream(stream) {\n        const runner = new AssistantStream();\n        runner._run(() => runner._fromReadableStream(stream));\n        return runner;\n    }\n    async _fromReadableStream(readableStream, options) {\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        this._connected();\n        const stream = Stream.fromReadableStream(readableStream, this.controller);\n        for await (const event of stream) {\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_addEvent).call(this, event);\n        }\n        if (stream.controller.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        return this._addRun(__classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_endRequest).call(this));\n    }\n    toReadableStream() {\n        const stream = new Stream(this[Symbol.asyncIterator].bind(this), this.controller);\n        return stream.toReadableStream();\n    }\n    static createToolAssistantStream(threadId, runId, runs, params, options) {\n        const runner = new AssistantStream();\n        runner._run(() => runner._runToolAssistantStream(threadId, runId, runs, params, {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'stream' },\n        }));\n        return runner;\n    }\n    async _createToolAssistantStream(run, threadId, runId, params, options) {\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        const body = { ...params, stream: true };\n        const stream = await run.submitToolOutputs(threadId, runId, body, {\n            ...options,\n            signal: this.controller.signal,\n        });\n        this._connected();\n        for await (const event of stream) {\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_addEvent).call(this, event);\n        }\n        if (stream.controller.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        return this._addRun(__classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_endRequest).call(this));\n    }\n    static createThreadAssistantStream(params, thread, options) {\n        const runner = new AssistantStream();\n        runner._run(() => runner._threadAssistantStream(params, thread, {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'stream' },\n        }));\n        return runner;\n    }\n    static createAssistantStream(threadId, runs, params, options) {\n        const runner = new AssistantStream();\n        runner._run(() => runner._runAssistantStream(threadId, runs, params, {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'stream' },\n        }));\n        return runner;\n    }\n    currentEvent() {\n        return __classPrivateFieldGet(this, _AssistantStream_currentEvent, \"f\");\n    }\n    currentRun() {\n        return __classPrivateFieldGet(this, _AssistantStream_currentRunSnapshot, \"f\");\n    }\n    currentMessageSnapshot() {\n        return __classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\");\n    }\n    currentRunStepSnapshot() {\n        return __classPrivateFieldGet(this, _AssistantStream_currentRunStepSnapshot, \"f\");\n    }\n    async finalRunSteps() {\n        await this.done();\n        return Object.values(__classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\"));\n    }\n    async finalMessages() {\n        await this.done();\n        return Object.values(__classPrivateFieldGet(this, _AssistantStream_messageSnapshots, \"f\"));\n    }\n    async finalRun() {\n        await this.done();\n        if (!__classPrivateFieldGet(this, _AssistantStream_finalRun, \"f\"))\n            throw Error('Final run was not received.');\n        return __classPrivateFieldGet(this, _AssistantStream_finalRun, \"f\");\n    }\n    async _createThreadAssistantStream(thread, params, options) {\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        const body = { ...params, stream: true };\n        const stream = await thread.createAndRun(body, { ...options, signal: this.controller.signal });\n        this._connected();\n        for await (const event of stream) {\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_addEvent).call(this, event);\n        }\n        if (stream.controller.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        return this._addRun(__classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_endRequest).call(this));\n    }\n    async _createAssistantStream(run, threadId, params, options) {\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        const body = { ...params, stream: true };\n        const stream = await run.create(threadId, body, { ...options, signal: this.controller.signal });\n        this._connected();\n        for await (const event of stream) {\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_addEvent).call(this, event);\n        }\n        if (stream.controller.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        return this._addRun(__classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_endRequest).call(this));\n    }\n    static accumulateDelta(acc, delta) {\n        for (const [key, deltaValue] of Object.entries(delta)) {\n            if (!acc.hasOwnProperty(key)) {\n                acc[key] = deltaValue;\n                continue;\n            }\n            let accValue = acc[key];\n            if (accValue === null || accValue === undefined) {\n                acc[key] = deltaValue;\n                continue;\n            }\n            // We don't accumulate these special properties\n            if (key === 'index' || key === 'type') {\n                acc[key] = deltaValue;\n                continue;\n            }\n            // Type-specific accumulation logic\n            if (typeof accValue === 'string' && typeof deltaValue === 'string') {\n                accValue += deltaValue;\n            }\n            else if (typeof accValue === 'number' && typeof deltaValue === 'number') {\n                accValue += deltaValue;\n            }\n            else if (Core.isObj(accValue) && Core.isObj(deltaValue)) {\n                accValue = this.accumulateDelta(accValue, deltaValue);\n            }\n            else if (Array.isArray(accValue) && Array.isArray(deltaValue)) {\n                if (accValue.every((x) => typeof x === 'string' || typeof x === 'number')) {\n                    accValue.push(...deltaValue); // Use spread syntax for efficient addition\n                    continue;\n                }\n                for (const deltaEntry of deltaValue) {\n                    if (!Core.isObj(deltaEntry)) {\n                        throw new Error(`Expected array delta entry to be an object but got: ${deltaEntry}`);\n                    }\n                    const index = deltaEntry['index'];\n                    if (index == null) {\n                        console.error(deltaEntry);\n                        throw new Error('Expected array delta entry to have an `index` property');\n                    }\n                    if (typeof index !== 'number') {\n                        throw new Error(`Expected array delta entry \\`index\\` property to be a number but got ${index}`);\n                    }\n                    const accEntry = accValue[index];\n                    if (accEntry == null) {\n                        accValue.push(deltaEntry);\n                    }\n                    else {\n                        accValue[index] = this.accumulateDelta(accEntry, deltaEntry);\n                    }\n                }\n                continue;\n            }\n            else {\n                throw Error(`Unhandled record type: ${key}, deltaValue: ${deltaValue}, accValue: ${accValue}`);\n            }\n            acc[key] = accValue;\n        }\n        return acc;\n    }\n    _addRun(run) {\n        return run;\n    }\n    async _threadAssistantStream(params, thread, options) {\n        return await this._createThreadAssistantStream(thread, params, options);\n    }\n    async _runAssistantStream(threadId, runs, params, options) {\n        return await this._createAssistantStream(runs, threadId, params, options);\n    }\n    async _runToolAssistantStream(threadId, runId, runs, params, options) {\n        return await this._createToolAssistantStream(runs, threadId, runId, params, options);\n    }\n}\n_AssistantStream_addEvent = function _AssistantStream_addEvent(event) {\n    if (this.ended)\n        return;\n    __classPrivateFieldSet(this, _AssistantStream_currentEvent, event, \"f\");\n    __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_handleEvent).call(this, event);\n    switch (event.event) {\n        case 'thread.created':\n            //No action on this event.\n            break;\n        case 'thread.run.created':\n        case 'thread.run.queued':\n        case 'thread.run.in_progress':\n        case 'thread.run.requires_action':\n        case 'thread.run.completed':\n        case 'thread.run.failed':\n        case 'thread.run.cancelling':\n        case 'thread.run.cancelled':\n        case 'thread.run.expired':\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_handleRun).call(this, event);\n            break;\n        case 'thread.run.step.created':\n        case 'thread.run.step.in_progress':\n        case 'thread.run.step.delta':\n        case 'thread.run.step.completed':\n        case 'thread.run.step.failed':\n        case 'thread.run.step.cancelled':\n        case 'thread.run.step.expired':\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_handleRunStep).call(this, event);\n            break;\n        case 'thread.message.created':\n        case 'thread.message.in_progress':\n        case 'thread.message.delta':\n        case 'thread.message.completed':\n        case 'thread.message.incomplete':\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_handleMessage).call(this, event);\n            break;\n        case 'error':\n            //This is included for completeness, but errors are processed in the SSE event processing so this should not occur\n            throw new Error('Encountered an error event in event processing - errors should be processed earlier');\n    }\n}, _AssistantStream_endRequest = function _AssistantStream_endRequest() {\n    if (this.ended) {\n        throw new OpenAIError(`stream has ended, this shouldn't happen`);\n    }\n    if (!__classPrivateFieldGet(this, _AssistantStream_finalRun, \"f\"))\n        throw Error('Final run has not been received');\n    return __classPrivateFieldGet(this, _AssistantStream_finalRun, \"f\");\n}, _AssistantStream_handleMessage = function _AssistantStream_handleMessage(event) {\n    const [accumulatedMessage, newContent] = __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_accumulateMessage).call(this, event, __classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\"));\n    __classPrivateFieldSet(this, _AssistantStream_messageSnapshot, accumulatedMessage, \"f\");\n    __classPrivateFieldGet(this, _AssistantStream_messageSnapshots, \"f\")[accumulatedMessage.id] = accumulatedMessage;\n    for (const content of newContent) {\n        const snapshotContent = accumulatedMessage.content[content.index];\n        if (snapshotContent?.type == 'text') {\n            this._emit('textCreated', snapshotContent.text);\n        }\n    }\n    switch (event.event) {\n        case 'thread.message.created':\n            this._emit('messageCreated', event.data);\n            break;\n        case 'thread.message.in_progress':\n            break;\n        case 'thread.message.delta':\n            this._emit('messageDelta', event.data.delta, accumulatedMessage);\n            if (event.data.delta.content) {\n                for (const content of event.data.delta.content) {\n                    //If it is text delta, emit a text delta event\n                    if (content.type == 'text' && content.text) {\n                        let textDelta = content.text;\n                        let snapshot = accumulatedMessage.content[content.index];\n                        if (snapshot && snapshot.type == 'text') {\n                            this._emit('textDelta', textDelta, snapshot.text);\n                        }\n                        else {\n                            throw Error('The snapshot associated with this text delta is not text or missing');\n                        }\n                    }\n                    if (content.index != __classPrivateFieldGet(this, _AssistantStream_currentContentIndex, \"f\")) {\n                        //See if we have in progress content\n                        if (__classPrivateFieldGet(this, _AssistantStream_currentContent, \"f\")) {\n                            switch (__classPrivateFieldGet(this, _AssistantStream_currentContent, \"f\").type) {\n                                case 'text':\n                                    this._emit('textDone', __classPrivateFieldGet(this, _AssistantStream_currentContent, \"f\").text, __classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\"));\n                                    break;\n                                case 'image_file':\n                                    this._emit('imageFileDone', __classPrivateFieldGet(this, _AssistantStream_currentContent, \"f\").image_file, __classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\"));\n                                    break;\n                            }\n                        }\n                        __classPrivateFieldSet(this, _AssistantStream_currentContentIndex, content.index, \"f\");\n                    }\n                    __classPrivateFieldSet(this, _AssistantStream_currentContent, accumulatedMessage.content[content.index], \"f\");\n                }\n            }\n            break;\n        case 'thread.message.completed':\n        case 'thread.message.incomplete':\n            //We emit the latest content we were working on on completion (including incomplete)\n            if (__classPrivateFieldGet(this, _AssistantStream_currentContentIndex, \"f\") !== undefined) {\n                const currentContent = event.data.content[__classPrivateFieldGet(this, _AssistantStream_currentContentIndex, \"f\")];\n                if (currentContent) {\n                    switch (currentContent.type) {\n                        case 'image_file':\n                            this._emit('imageFileDone', currentContent.image_file, __classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\"));\n                            break;\n                        case 'text':\n                            this._emit('textDone', currentContent.text, __classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\"));\n                            break;\n                    }\n                }\n            }\n            if (__classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\")) {\n                this._emit('messageDone', event.data);\n            }\n            __classPrivateFieldSet(this, _AssistantStream_messageSnapshot, undefined, \"f\");\n    }\n}, _AssistantStream_handleRunStep = function _AssistantStream_handleRunStep(event) {\n    const accumulatedRunStep = __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_accumulateRunStep).call(this, event);\n    __classPrivateFieldSet(this, _AssistantStream_currentRunStepSnapshot, accumulatedRunStep, \"f\");\n    switch (event.event) {\n        case 'thread.run.step.created':\n            this._emit('runStepCreated', event.data);\n            break;\n        case 'thread.run.step.delta':\n            const delta = event.data.delta;\n            if (delta.step_details &&\n                delta.step_details.type == 'tool_calls' &&\n                delta.step_details.tool_calls &&\n                accumulatedRunStep.step_details.type == 'tool_calls') {\n                for (const toolCall of delta.step_details.tool_calls) {\n                    if (toolCall.index == __classPrivateFieldGet(this, _AssistantStream_currentToolCallIndex, \"f\")) {\n                        this._emit('toolCallDelta', toolCall, accumulatedRunStep.step_details.tool_calls[toolCall.index]);\n                    }\n                    else {\n                        if (__classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\")) {\n                            this._emit('toolCallDone', __classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\"));\n                        }\n                        __classPrivateFieldSet(this, _AssistantStream_currentToolCallIndex, toolCall.index, \"f\");\n                        __classPrivateFieldSet(this, _AssistantStream_currentToolCall, accumulatedRunStep.step_details.tool_calls[toolCall.index], \"f\");\n                        if (__classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\"))\n                            this._emit('toolCallCreated', __classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\"));\n                    }\n                }\n            }\n            this._emit('runStepDelta', event.data.delta, accumulatedRunStep);\n            break;\n        case 'thread.run.step.completed':\n        case 'thread.run.step.failed':\n        case 'thread.run.step.cancelled':\n        case 'thread.run.step.expired':\n            __classPrivateFieldSet(this, _AssistantStream_currentRunStepSnapshot, undefined, \"f\");\n            const details = event.data.step_details;\n            if (details.type == 'tool_calls') {\n                if (__classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\")) {\n                    this._emit('toolCallDone', __classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\"));\n                    __classPrivateFieldSet(this, _AssistantStream_currentToolCall, undefined, \"f\");\n                }\n            }\n            this._emit('runStepDone', event.data, accumulatedRunStep);\n            break;\n        case 'thread.run.step.in_progress':\n            break;\n    }\n}, _AssistantStream_handleEvent = function _AssistantStream_handleEvent(event) {\n    __classPrivateFieldGet(this, _AssistantStream_events, \"f\").push(event);\n    this._emit('event', event);\n}, _AssistantStream_accumulateRunStep = function _AssistantStream_accumulateRunStep(event) {\n    switch (event.event) {\n        case 'thread.run.step.created':\n            __classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id] = event.data;\n            return event.data;\n        case 'thread.run.step.delta':\n            let snapshot = __classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id];\n            if (!snapshot) {\n                throw Error('Received a RunStepDelta before creation of a snapshot');\n            }\n            let data = event.data;\n            if (data.delta) {\n                const accumulated = AssistantStream.accumulateDelta(snapshot, data.delta);\n                __classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id] = accumulated;\n            }\n            return __classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id];\n        case 'thread.run.step.completed':\n        case 'thread.run.step.failed':\n        case 'thread.run.step.cancelled':\n        case 'thread.run.step.expired':\n        case 'thread.run.step.in_progress':\n            __classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id] = event.data;\n            break;\n    }\n    if (__classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id])\n        return __classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id];\n    throw new Error('No snapshot available');\n}, _AssistantStream_accumulateMessage = function _AssistantStream_accumulateMessage(event, snapshot) {\n    let newContent = [];\n    switch (event.event) {\n        case 'thread.message.created':\n            //On creation the snapshot is just the initial message\n            return [event.data, newContent];\n        case 'thread.message.delta':\n            if (!snapshot) {\n                throw Error('Received a delta with no existing snapshot (there should be one from message creation)');\n            }\n            let data = event.data;\n            //If this delta does not have content, nothing to process\n            if (data.delta.content) {\n                for (const contentElement of data.delta.content) {\n                    if (contentElement.index in snapshot.content) {\n                        let currentContent = snapshot.content[contentElement.index];\n                        snapshot.content[contentElement.index] = __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_accumulateContent).call(this, contentElement, currentContent);\n                    }\n                    else {\n                        snapshot.content[contentElement.index] = contentElement;\n                        // This is a new element\n                        newContent.push(contentElement);\n                    }\n                }\n            }\n            return [snapshot, newContent];\n        case 'thread.message.in_progress':\n        case 'thread.message.completed':\n        case 'thread.message.incomplete':\n            //No changes on other thread events\n            if (snapshot) {\n                return [snapshot, newContent];\n            }\n            else {\n                throw Error('Received thread message event with no existing snapshot');\n            }\n    }\n    throw Error('Tried to accumulate a non-message event');\n}, _AssistantStream_accumulateContent = function _AssistantStream_accumulateContent(contentElement, currentContent) {\n    return AssistantStream.accumulateDelta(currentContent, contentElement);\n}, _AssistantStream_handleRun = function _AssistantStream_handleRun(event) {\n    __classPrivateFieldSet(this, _AssistantStream_currentRunSnapshot, event.data, \"f\");\n    switch (event.event) {\n        case 'thread.run.created':\n            break;\n        case 'thread.run.queued':\n            break;\n        case 'thread.run.in_progress':\n            break;\n        case 'thread.run.requires_action':\n        case 'thread.run.cancelled':\n        case 'thread.run.failed':\n        case 'thread.run.completed':\n        case 'thread.run.expired':\n            __classPrivateFieldSet(this, _AssistantStream_finalRun, event.data, \"f\");\n            if (__classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\")) {\n                this._emit('toolCallDone', __classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\"));\n                __classPrivateFieldSet(this, _AssistantStream_currentToolCall, undefined, \"f\");\n            }\n            break;\n        case 'thread.run.cancelling':\n            break;\n    }\n};\n//# sourceMappingURL=AssistantStream.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../core.mjs\";\nimport { CursorPage } from \"../../../pagination.mjs\";\nexport class Messages extends APIResource {\n    /**\n     * Create a message.\n     */\n    create(threadId, body, options) {\n        return this._client.post(`/threads/${threadId}/messages`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Retrieve a message.\n     */\n    retrieve(threadId, messageId, options) {\n        return this._client.get(`/threads/${threadId}/messages/${messageId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Modifies a message.\n     */\n    update(threadId, messageId, body, options) {\n        return this._client.post(`/threads/${threadId}/messages/${messageId}`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    list(threadId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list(threadId, {}, query);\n        }\n        return this._client.getAPIList(`/threads/${threadId}/messages`, MessagesPage, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Deletes a message.\n     */\n    del(threadId, messageId, options) {\n        return this._client.delete(`/threads/${threadId}/messages/${messageId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n}\nexport class MessagesPage extends CursorPage {\n}\nMessages.MessagesPage = MessagesPage;\n//# sourceMappingURL=messages.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../../core.mjs\";\nimport { CursorPage } from \"../../../../pagination.mjs\";\nexport class Steps extends APIResource {\n    retrieve(threadId, runId, stepId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.retrieve(threadId, runId, stepId, {}, query);\n        }\n        return this._client.get(`/threads/${threadId}/runs/${runId}/steps/${stepId}`, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    list(threadId, runId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list(threadId, runId, {}, query);\n        }\n        return this._client.getAPIList(`/threads/${threadId}/runs/${runId}/steps`, RunStepsPage, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n}\nexport class RunStepsPage extends CursorPage {\n}\nSteps.RunStepsPage = RunStepsPage;\n//# sourceMappingURL=steps.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../../core.mjs\";\nimport { AssistantStream } from \"../../../../lib/AssistantStream.mjs\";\nimport { sleep } from \"../../../../core.mjs\";\nimport * as StepsAPI from \"./steps.mjs\";\nimport { RunStepsPage, Steps, } from \"./steps.mjs\";\nimport { CursorPage } from \"../../../../pagination.mjs\";\nexport class Runs extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.steps = new StepsAPI.Steps(this._client);\n    }\n    create(threadId, params, options) {\n        const { include, ...body } = params;\n        return this._client.post(`/threads/${threadId}/runs`, {\n            query: { include },\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n            stream: params.stream ?? false,\n        });\n    }\n    /**\n     * Retrieves a run.\n     */\n    retrieve(threadId, runId, options) {\n        return this._client.get(`/threads/${threadId}/runs/${runId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Modifies a run.\n     */\n    update(threadId, runId, body, options) {\n        return this._client.post(`/threads/${threadId}/runs/${runId}`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    list(threadId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list(threadId, {}, query);\n        }\n        return this._client.getAPIList(`/threads/${threadId}/runs`, RunsPage, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Cancels a run that is `in_progress`.\n     */\n    cancel(threadId, runId, options) {\n        return this._client.post(`/threads/${threadId}/runs/${runId}/cancel`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * A helper to create a run an poll for a terminal state. More information on Run\n     * lifecycles can be found here:\n     * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n     */\n    async createAndPoll(threadId, body, options) {\n        const run = await this.create(threadId, body, options);\n        return await this.poll(threadId, run.id, options);\n    }\n    /**\n     * Create a Run stream\n     *\n     * @deprecated use `stream` instead\n     */\n    createAndStream(threadId, body, options) {\n        return AssistantStream.createAssistantStream(threadId, this._client.beta.threads.runs, body, options);\n    }\n    /**\n     * A helper to poll a run status until it reaches a terminal state. More\n     * information on Run lifecycles can be found here:\n     * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n     */\n    async poll(threadId, runId, options) {\n        const headers = { ...options?.headers, 'X-Stainless-Poll-Helper': 'true' };\n        if (options?.pollIntervalMs) {\n            headers['X-Stainless-Custom-Poll-Interval'] = options.pollIntervalMs.toString();\n        }\n        while (true) {\n            const { data: run, response } = await this.retrieve(threadId, runId, {\n                ...options,\n                headers: { ...options?.headers, ...headers },\n            }).withResponse();\n            switch (run.status) {\n                //If we are in any sort of intermediate state we poll\n                case 'queued':\n                case 'in_progress':\n                case 'cancelling':\n                    let sleepInterval = 5000;\n                    if (options?.pollIntervalMs) {\n                        sleepInterval = options.pollIntervalMs;\n                    }\n                    else {\n                        const headerInterval = response.headers.get('openai-poll-after-ms');\n                        if (headerInterval) {\n                            const headerIntervalMs = parseInt(headerInterval);\n                            if (!isNaN(headerIntervalMs)) {\n                                sleepInterval = headerIntervalMs;\n                            }\n                        }\n                    }\n                    await sleep(sleepInterval);\n                    break;\n                //We return the run in any terminal state.\n                case 'requires_action':\n                case 'incomplete':\n                case 'cancelled':\n                case 'completed':\n                case 'failed':\n                case 'expired':\n                    return run;\n            }\n        }\n    }\n    /**\n     * Create a Run stream\n     */\n    stream(threadId, body, options) {\n        return AssistantStream.createAssistantStream(threadId, this._client.beta.threads.runs, body, options);\n    }\n    submitToolOutputs(threadId, runId, body, options) {\n        return this._client.post(`/threads/${threadId}/runs/${runId}/submit_tool_outputs`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n            stream: body.stream ?? false,\n        });\n    }\n    /**\n     * A helper to submit a tool output to a run and poll for a terminal run state.\n     * More information on Run lifecycles can be found here:\n     * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n     */\n    async submitToolOutputsAndPoll(threadId, runId, body, options) {\n        const run = await this.submitToolOutputs(threadId, runId, body, options);\n        return await this.poll(threadId, run.id, options);\n    }\n    /**\n     * Submit the tool outputs from a previous run and stream the run to a terminal\n     * state. More information on Run lifecycles can be found here:\n     * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n     */\n    submitToolOutputsStream(threadId, runId, body, options) {\n        return AssistantStream.createToolAssistantStream(threadId, runId, this._client.beta.threads.runs, body, options);\n    }\n}\nexport class RunsPage extends CursorPage {\n}\nRuns.RunsPage = RunsPage;\nRuns.Steps = Steps;\nRuns.RunStepsPage = RunStepsPage;\n//# sourceMappingURL=runs.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../core.mjs\";\nimport { AssistantStream } from \"../../../lib/AssistantStream.mjs\";\nimport * as MessagesAPI from \"./messages.mjs\";\nimport { Messages, MessagesPage, } from \"./messages.mjs\";\nimport * as RunsAPI from \"./runs/runs.mjs\";\nimport { Runs, RunsPage, } from \"./runs/runs.mjs\";\nexport class Threads extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.runs = new RunsAPI.Runs(this._client);\n        this.messages = new MessagesAPI.Messages(this._client);\n    }\n    create(body = {}, options) {\n        if (isRequestOptions(body)) {\n            return this.create({}, body);\n        }\n        return this._client.post('/threads', {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Retrieves a thread.\n     */\n    retrieve(threadId, options) {\n        return this._client.get(`/threads/${threadId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Modifies a thread.\n     */\n    update(threadId, body, options) {\n        return this._client.post(`/threads/${threadId}`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Delete a thread.\n     */\n    del(threadId, options) {\n        return this._client.delete(`/threads/${threadId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    createAndRun(body, options) {\n        return this._client.post('/threads/runs', {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n            stream: body.stream ?? false,\n        });\n    }\n    /**\n     * A helper to create a thread, start a run and then poll for a terminal state.\n     * More information on Run lifecycles can be found here:\n     * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n     */\n    async createAndRunPoll(body, options) {\n        const run = await this.createAndRun(body, options);\n        return await this.runs.poll(run.thread_id, run.id, options);\n    }\n    /**\n     * Create a thread and stream the run back\n     */\n    createAndRunStream(body, options) {\n        return AssistantStream.createThreadAssistantStream(body, this._client.beta.threads, options);\n    }\n}\nThreads.Runs = Runs;\nThreads.RunsPage = RunsPage;\nThreads.Messages = Messages;\nThreads.MessagesPage = MessagesPage;\n//# sourceMappingURL=threads.mjs.map","/**\n * Like `Promise.allSettled()` but throws an error if any promises are rejected.\n */\nexport const allSettledWithThrow = async (promises) => {\n    const results = await Promise.allSettled(promises);\n    const rejected = results.filter((result) => result.status === 'rejected');\n    if (rejected.length) {\n        for (const result of rejected) {\n            console.error(result.reason);\n        }\n        throw new Error(`${rejected.length} promise(s) failed - see the above errors`);\n    }\n    // Note: TS was complaining about using `.filter().map()` here for some reason\n    const values = [];\n    for (const result of results) {\n        if (result.status === 'fulfilled') {\n            values.push(result.value);\n        }\n    }\n    return values;\n};\n//# sourceMappingURL=Util.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { sleep, isRequestOptions } from \"../../../core.mjs\";\nimport { CursorPage } from \"../../../pagination.mjs\";\nexport class Files extends APIResource {\n    /**\n     * Create a vector store file by attaching a\n     * [File](https://platform.openai.com/docs/api-reference/files) to a\n     * [vector store](https://platform.openai.com/docs/api-reference/vector-stores/object).\n     */\n    create(vectorStoreId, body, options) {\n        return this._client.post(`/vector_stores/${vectorStoreId}/files`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Retrieves a vector store file.\n     */\n    retrieve(vectorStoreId, fileId, options) {\n        return this._client.get(`/vector_stores/${vectorStoreId}/files/${fileId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    list(vectorStoreId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list(vectorStoreId, {}, query);\n        }\n        return this._client.getAPIList(`/vector_stores/${vectorStoreId}/files`, VectorStoreFilesPage, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Delete a vector store file. This will remove the file from the vector store but\n     * the file itself will not be deleted. To delete the file, use the\n     * [delete file](https://platform.openai.com/docs/api-reference/files/delete)\n     * endpoint.\n     */\n    del(vectorStoreId, fileId, options) {\n        return this._client.delete(`/vector_stores/${vectorStoreId}/files/${fileId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Attach a file to the given vector store and wait for it to be processed.\n     */\n    async createAndPoll(vectorStoreId, body, options) {\n        const file = await this.create(vectorStoreId, body, options);\n        return await this.poll(vectorStoreId, file.id, options);\n    }\n    /**\n     * Wait for the vector store file to finish processing.\n     *\n     * Note: this will return even if the file failed to process, you need to check\n     * file.last_error and file.status to handle these cases\n     */\n    async poll(vectorStoreId, fileId, options) {\n        const headers = { ...options?.headers, 'X-Stainless-Poll-Helper': 'true' };\n        if (options?.pollIntervalMs) {\n            headers['X-Stainless-Custom-Poll-Interval'] = options.pollIntervalMs.toString();\n        }\n        while (true) {\n            const fileResponse = await this.retrieve(vectorStoreId, fileId, {\n                ...options,\n                headers,\n            }).withResponse();\n            const file = fileResponse.data;\n            switch (file.status) {\n                case 'in_progress':\n                    let sleepInterval = 5000;\n                    if (options?.pollIntervalMs) {\n                        sleepInterval = options.pollIntervalMs;\n                    }\n                    else {\n                        const headerInterval = fileResponse.response.headers.get('openai-poll-after-ms');\n                        if (headerInterval) {\n                            const headerIntervalMs = parseInt(headerInterval);\n                            if (!isNaN(headerIntervalMs)) {\n                                sleepInterval = headerIntervalMs;\n                            }\n                        }\n                    }\n                    await sleep(sleepInterval);\n                    break;\n                case 'failed':\n                case 'completed':\n                    return file;\n            }\n        }\n    }\n    /**\n     * Upload a file to the `files` API and then attach it to the given vector store.\n     *\n     * Note the file will be asynchronously processed (you can use the alternative\n     * polling helper method to wait for processing to complete).\n     */\n    async upload(vectorStoreId, file, options) {\n        const fileInfo = await this._client.files.create({ file: file, purpose: 'assistants' }, options);\n        return this.create(vectorStoreId, { file_id: fileInfo.id }, options);\n    }\n    /**\n     * Add a file to a vector store and poll until processing is complete.\n     */\n    async uploadAndPoll(vectorStoreId, file, options) {\n        const fileInfo = await this.upload(vectorStoreId, file, options);\n        return await this.poll(vectorStoreId, fileInfo.id, options);\n    }\n}\nexport class VectorStoreFilesPage extends CursorPage {\n}\nFiles.VectorStoreFilesPage = VectorStoreFilesPage;\n//# sourceMappingURL=files.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../core.mjs\";\nimport { sleep } from \"../../../core.mjs\";\nimport { allSettledWithThrow } from \"../../../lib/Util.mjs\";\nimport { VectorStoreFilesPage } from \"./files.mjs\";\nexport class FileBatches extends APIResource {\n    /**\n     * Create a vector store file batch.\n     */\n    create(vectorStoreId, body, options) {\n        return this._client.post(`/vector_stores/${vectorStoreId}/file_batches`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Retrieves a vector store file batch.\n     */\n    retrieve(vectorStoreId, batchId, options) {\n        return this._client.get(`/vector_stores/${vectorStoreId}/file_batches/${batchId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Cancel a vector store file batch. This attempts to cancel the processing of\n     * files in this batch as soon as possible.\n     */\n    cancel(vectorStoreId, batchId, options) {\n        return this._client.post(`/vector_stores/${vectorStoreId}/file_batches/${batchId}/cancel`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Create a vector store batch and poll until all files have been processed.\n     */\n    async createAndPoll(vectorStoreId, body, options) {\n        const batch = await this.create(vectorStoreId, body);\n        return await this.poll(vectorStoreId, batch.id, options);\n    }\n    listFiles(vectorStoreId, batchId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.listFiles(vectorStoreId, batchId, {}, query);\n        }\n        return this._client.getAPIList(`/vector_stores/${vectorStoreId}/file_batches/${batchId}/files`, VectorStoreFilesPage, { query, ...options, headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers } });\n    }\n    /**\n     * Wait for the given file batch to be processed.\n     *\n     * Note: this will return even if one of the files failed to process, you need to\n     * check batch.file_counts.failed_count to handle this case.\n     */\n    async poll(vectorStoreId, batchId, options) {\n        const headers = { ...options?.headers, 'X-Stainless-Poll-Helper': 'true' };\n        if (options?.pollIntervalMs) {\n            headers['X-Stainless-Custom-Poll-Interval'] = options.pollIntervalMs.toString();\n        }\n        while (true) {\n            const { data: batch, response } = await this.retrieve(vectorStoreId, batchId, {\n                ...options,\n                headers,\n            }).withResponse();\n            switch (batch.status) {\n                case 'in_progress':\n                    let sleepInterval = 5000;\n                    if (options?.pollIntervalMs) {\n                        sleepInterval = options.pollIntervalMs;\n                    }\n                    else {\n                        const headerInterval = response.headers.get('openai-poll-after-ms');\n                        if (headerInterval) {\n                            const headerIntervalMs = parseInt(headerInterval);\n                            if (!isNaN(headerIntervalMs)) {\n                                sleepInterval = headerIntervalMs;\n                            }\n                        }\n                    }\n                    await sleep(sleepInterval);\n                    break;\n                case 'failed':\n                case 'cancelled':\n                case 'completed':\n                    return batch;\n            }\n        }\n    }\n    /**\n     * Uploads the given files concurrently and then creates a vector store file batch.\n     *\n     * The concurrency limit is configurable using the `maxConcurrency` parameter.\n     */\n    async uploadAndPoll(vectorStoreId, { files, fileIds = [] }, options) {\n        if (files == null || files.length == 0) {\n            throw new Error(`No \\`files\\` provided to process. If you've already uploaded files you should use \\`.createAndPoll()\\` instead`);\n        }\n        const configuredConcurrency = options?.maxConcurrency ?? 5;\n        // We cap the number of workers at the number of files (so we don't start any unnecessary workers)\n        const concurrencyLimit = Math.min(configuredConcurrency, files.length);\n        const client = this._client;\n        const fileIterator = files.values();\n        const allFileIds = [...fileIds];\n        // This code is based on this design. The libraries don't accommodate our environment limits.\n        // https://stackoverflow.com/questions/40639432/what-is-the-best-way-to-limit-concurrency-when-using-es6s-promise-all\n        async function processFiles(iterator) {\n            for (let item of iterator) {\n                const fileObj = await client.files.create({ file: item, purpose: 'assistants' }, options);\n                allFileIds.push(fileObj.id);\n            }\n        }\n        // Start workers to process results\n        const workers = Array(concurrencyLimit).fill(fileIterator).map(processFiles);\n        // Wait for all processing to complete.\n        await allSettledWithThrow(workers);\n        return await this.createAndPoll(vectorStoreId, {\n            file_ids: allFileIds,\n        });\n    }\n}\nexport { VectorStoreFilesPage };\n//# sourceMappingURL=file-batches.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../core.mjs\";\nimport * as FileBatchesAPI from \"./file-batches.mjs\";\nimport { FileBatches, } from \"./file-batches.mjs\";\nimport * as FilesAPI from \"./files.mjs\";\nimport { Files, VectorStoreFilesPage, } from \"./files.mjs\";\nimport { CursorPage } from \"../../../pagination.mjs\";\nexport class VectorStores extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.files = new FilesAPI.Files(this._client);\n        this.fileBatches = new FileBatchesAPI.FileBatches(this._client);\n    }\n    /**\n     * Create a vector store.\n     */\n    create(body, options) {\n        return this._client.post('/vector_stores', {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Retrieves a vector store.\n     */\n    retrieve(vectorStoreId, options) {\n        return this._client.get(`/vector_stores/${vectorStoreId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Modifies a vector store.\n     */\n    update(vectorStoreId, body, options) {\n        return this._client.post(`/vector_stores/${vectorStoreId}`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    list(query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list({}, query);\n        }\n        return this._client.getAPIList('/vector_stores', VectorStoresPage, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Delete a vector store.\n     */\n    del(vectorStoreId, options) {\n        return this._client.delete(`/vector_stores/${vectorStoreId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n}\nexport class VectorStoresPage extends CursorPage {\n}\nVectorStores.VectorStoresPage = VectorStoresPage;\nVectorStores.Files = Files;\nVectorStores.VectorStoreFilesPage = VectorStoreFilesPage;\nVectorStores.FileBatches = FileBatches;\n//# sourceMappingURL=vector-stores.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as AssistantsAPI from \"./assistants.mjs\";\nimport * as ChatAPI from \"./chat/chat.mjs\";\nimport { Assistants, AssistantsPage, } from \"./assistants.mjs\";\nimport * as ThreadsAPI from \"./threads/threads.mjs\";\nimport { Threads, } from \"./threads/threads.mjs\";\nimport * as VectorStoresAPI from \"./vector-stores/vector-stores.mjs\";\nimport { VectorStores, VectorStoresPage, } from \"./vector-stores/vector-stores.mjs\";\nimport { Chat } from \"./chat/chat.mjs\";\nexport class Beta extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.vectorStores = new VectorStoresAPI.VectorStores(this._client);\n        this.chat = new ChatAPI.Chat(this._client);\n        this.assistants = new AssistantsAPI.Assistants(this._client);\n        this.threads = new ThreadsAPI.Threads(this._client);\n    }\n}\nBeta.VectorStores = VectorStores;\nBeta.VectorStoresPage = VectorStoresPage;\nBeta.Assistants = Assistants;\nBeta.AssistantsPage = AssistantsPage;\nBeta.Threads = Threads;\n//# sourceMappingURL=beta.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nexport class Completions extends APIResource {\n    create(body, options) {\n        return this._client.post('/completions', { body, ...options, stream: body.stream ?? false });\n    }\n}\n//# sourceMappingURL=completions.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nexport class Embeddings extends APIResource {\n    /**\n     * Creates an embedding vector representing the input text.\n     */\n    create(body, options) {\n        return this._client.post('/embeddings', { body, ...options });\n    }\n}\n//# sourceMappingURL=embeddings.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nimport { isRequestOptions } from \"../core.mjs\";\nimport { sleep } from \"../core.mjs\";\nimport { APIConnectionTimeoutError } from \"../error.mjs\";\nimport * as Core from \"../core.mjs\";\nimport { CursorPage } from \"../pagination.mjs\";\nexport class Files extends APIResource {\n    /**\n     * Upload a file that can be used across various endpoints. Individual files can be\n     * up to 512 MB, and the size of all files uploaded by one organization can be up\n     * to 100 GB.\n     *\n     * The Assistants API supports files up to 2 million tokens and of specific file\n     * types. See the\n     * [Assistants Tools guide](https://platform.openai.com/docs/assistants/tools) for\n     * details.\n     *\n     * The Fine-tuning API only supports `.jsonl` files. The input also has certain\n     * required formats for fine-tuning\n     * [chat](https://platform.openai.com/docs/api-reference/fine-tuning/chat-input) or\n     * [completions](https://platform.openai.com/docs/api-reference/fine-tuning/completions-input)\n     * models.\n     *\n     * The Batch API only supports `.jsonl` files up to 200 MB in size. The input also\n     * has a specific required\n     * [format](https://platform.openai.com/docs/api-reference/batch/request-input).\n     *\n     * Please [contact us](https://help.openai.com/) if you need to increase these\n     * storage limits.\n     */\n    create(body, options) {\n        return this._client.post('/files', Core.multipartFormRequestOptions({ body, ...options }));\n    }\n    /**\n     * Returns information about a specific file.\n     */\n    retrieve(fileId, options) {\n        return this._client.get(`/files/${fileId}`, options);\n    }\n    list(query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list({}, query);\n        }\n        return this._client.getAPIList('/files', FileObjectsPage, { query, ...options });\n    }\n    /**\n     * Delete a file.\n     */\n    del(fileId, options) {\n        return this._client.delete(`/files/${fileId}`, options);\n    }\n    /**\n     * Returns the contents of the specified file.\n     */\n    content(fileId, options) {\n        return this._client.get(`/files/${fileId}/content`, { ...options, __binaryResponse: true });\n    }\n    /**\n     * Returns the contents of the specified file.\n     *\n     * @deprecated The `.content()` method should be used instead\n     */\n    retrieveContent(fileId, options) {\n        return this._client.get(`/files/${fileId}/content`, {\n            ...options,\n            headers: { Accept: 'application/json', ...options?.headers },\n        });\n    }\n    /**\n     * Waits for the given file to be processed, default timeout is 30 mins.\n     */\n    async waitForProcessing(id, { pollInterval = 5000, maxWait = 30 * 60 * 1000 } = {}) {\n        const TERMINAL_STATES = new Set(['processed', 'error', 'deleted']);\n        const start = Date.now();\n        let file = await this.retrieve(id);\n        while (!file.status || !TERMINAL_STATES.has(file.status)) {\n            await sleep(pollInterval);\n            file = await this.retrieve(id);\n            if (Date.now() - start > maxWait) {\n                throw new APIConnectionTimeoutError({\n                    message: `Giving up on waiting for file ${id} to finish processing after ${maxWait} milliseconds.`,\n                });\n            }\n        }\n        return file;\n    }\n}\nexport class FileObjectsPage extends CursorPage {\n}\nFiles.FileObjectsPage = FileObjectsPage;\n//# sourceMappingURL=files.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../core.mjs\";\nimport { CursorPage } from \"../../../pagination.mjs\";\nexport class Checkpoints extends APIResource {\n    list(fineTuningJobId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list(fineTuningJobId, {}, query);\n        }\n        return this._client.getAPIList(`/fine_tuning/jobs/${fineTuningJobId}/checkpoints`, FineTuningJobCheckpointsPage, { query, ...options });\n    }\n}\nexport class FineTuningJobCheckpointsPage extends CursorPage {\n}\nCheckpoints.FineTuningJobCheckpointsPage = FineTuningJobCheckpointsPage;\n//# sourceMappingURL=checkpoints.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../core.mjs\";\nimport * as CheckpointsAPI from \"./checkpoints.mjs\";\nimport { Checkpoints, FineTuningJobCheckpointsPage, } from \"./checkpoints.mjs\";\nimport { CursorPage } from \"../../../pagination.mjs\";\nexport class Jobs extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.checkpoints = new CheckpointsAPI.Checkpoints(this._client);\n    }\n    /**\n     * Creates a fine-tuning job which begins the process of creating a new model from\n     * a given dataset.\n     *\n     * Response includes details of the enqueued job including job status and the name\n     * of the fine-tuned models once complete.\n     *\n     * [Learn more about fine-tuning](https://platform.openai.com/docs/guides/fine-tuning)\n     */\n    create(body, options) {\n        return this._client.post('/fine_tuning/jobs', { body, ...options });\n    }\n    /**\n     * Get info about a fine-tuning job.\n     *\n     * [Learn more about fine-tuning](https://platform.openai.com/docs/guides/fine-tuning)\n     */\n    retrieve(fineTuningJobId, options) {\n        return this._client.get(`/fine_tuning/jobs/${fineTuningJobId}`, options);\n    }\n    list(query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list({}, query);\n        }\n        return this._client.getAPIList('/fine_tuning/jobs', FineTuningJobsPage, { query, ...options });\n    }\n    /**\n     * Immediately cancel a fine-tune job.\n     */\n    cancel(fineTuningJobId, options) {\n        return this._client.post(`/fine_tuning/jobs/${fineTuningJobId}/cancel`, options);\n    }\n    listEvents(fineTuningJobId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.listEvents(fineTuningJobId, {}, query);\n        }\n        return this._client.getAPIList(`/fine_tuning/jobs/${fineTuningJobId}/events`, FineTuningJobEventsPage, {\n            query,\n            ...options,\n        });\n    }\n}\nexport class FineTuningJobsPage extends CursorPage {\n}\nexport class FineTuningJobEventsPage extends CursorPage {\n}\nJobs.FineTuningJobsPage = FineTuningJobsPage;\nJobs.FineTuningJobEventsPage = FineTuningJobEventsPage;\nJobs.Checkpoints = Checkpoints;\nJobs.FineTuningJobCheckpointsPage = FineTuningJobCheckpointsPage;\n//# sourceMappingURL=jobs.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as JobsAPI from \"./jobs/jobs.mjs\";\nimport { FineTuningJobEventsPage, FineTuningJobsPage, Jobs, } from \"./jobs/jobs.mjs\";\nexport class FineTuning extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.jobs = new JobsAPI.Jobs(this._client);\n    }\n}\nFineTuning.Jobs = Jobs;\nFineTuning.FineTuningJobsPage = FineTuningJobsPage;\nFineTuning.FineTuningJobEventsPage = FineTuningJobEventsPage;\n//# sourceMappingURL=fine-tuning.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nimport * as Core from \"../core.mjs\";\nexport class Images extends APIResource {\n    /**\n     * Creates a variation of a given image.\n     */\n    createVariation(body, options) {\n        return this._client.post('/images/variations', Core.multipartFormRequestOptions({ body, ...options }));\n    }\n    /**\n     * Creates an edited or extended image given an original image and a prompt.\n     */\n    edit(body, options) {\n        return this._client.post('/images/edits', Core.multipartFormRequestOptions({ body, ...options }));\n    }\n    /**\n     * Creates an image given a prompt.\n     */\n    generate(body, options) {\n        return this._client.post('/images/generations', { body, ...options });\n    }\n}\n//# sourceMappingURL=images.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nimport { Page } from \"../pagination.mjs\";\nexport class Models extends APIResource {\n    /**\n     * Retrieves a model instance, providing basic information about the model such as\n     * the owner and permissioning.\n     */\n    retrieve(model, options) {\n        return this._client.get(`/models/${model}`, options);\n    }\n    /**\n     * Lists the currently available models, and provides basic information about each\n     * one such as the owner and availability.\n     */\n    list(options) {\n        return this._client.getAPIList('/models', ModelsPage, options);\n    }\n    /**\n     * Delete a fine-tuned model. You must have the Owner role in your organization to\n     * delete a model.\n     */\n    del(model, options) {\n        return this._client.delete(`/models/${model}`, options);\n    }\n}\n/**\n * Note: no pagination actually occurs yet, this is for forwards-compatibility.\n */\nexport class ModelsPage extends Page {\n}\nModels.ModelsPage = ModelsPage;\n//# sourceMappingURL=models.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nexport class Moderations extends APIResource {\n    /**\n     * Classifies if text and/or image inputs are potentially harmful. Learn more in\n     * the [moderation guide](https://platform.openai.com/docs/guides/moderation).\n     */\n    create(body, options) {\n        return this._client.post('/moderations', { body, ...options });\n    }\n}\n//# sourceMappingURL=moderations.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as Core from \"../../core.mjs\";\nexport class Parts extends APIResource {\n    /**\n     * Adds a\n     * [Part](https://platform.openai.com/docs/api-reference/uploads/part-object) to an\n     * [Upload](https://platform.openai.com/docs/api-reference/uploads/object) object.\n     * A Part represents a chunk of bytes from the file you are trying to upload.\n     *\n     * Each Part can be at most 64 MB, and you can add Parts until you hit the Upload\n     * maximum of 8 GB.\n     *\n     * It is possible to add multiple Parts in parallel. You can decide the intended\n     * order of the Parts when you\n     * [complete the Upload](https://platform.openai.com/docs/api-reference/uploads/complete).\n     */\n    create(uploadId, body, options) {\n        return this._client.post(`/uploads/${uploadId}/parts`, Core.multipartFormRequestOptions({ body, ...options }));\n    }\n}\n//# sourceMappingURL=parts.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as PartsAPI from \"./parts.mjs\";\nimport { Parts } from \"./parts.mjs\";\nexport class Uploads extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.parts = new PartsAPI.Parts(this._client);\n    }\n    /**\n     * Creates an intermediate\n     * [Upload](https://platform.openai.com/docs/api-reference/uploads/object) object\n     * that you can add\n     * [Parts](https://platform.openai.com/docs/api-reference/uploads/part-object) to.\n     * Currently, an Upload can accept at most 8 GB in total and expires after an hour\n     * after you create it.\n     *\n     * Once you complete the Upload, we will create a\n     * [File](https://platform.openai.com/docs/api-reference/files/object) object that\n     * contains all the parts you uploaded. This File is usable in the rest of our\n     * platform as a regular File object.\n     *\n     * For certain `purpose`s, the correct `mime_type` must be specified. Please refer\n     * to documentation for the supported MIME types for your use case:\n     *\n     * - [Assistants](https://platform.openai.com/docs/assistants/tools/file-search#supported-files)\n     *\n     * For guidance on the proper filename extensions for each purpose, please follow\n     * the documentation on\n     * [creating a File](https://platform.openai.com/docs/api-reference/files/create).\n     */\n    create(body, options) {\n        return this._client.post('/uploads', { body, ...options });\n    }\n    /**\n     * Cancels the Upload. No Parts may be added after an Upload is cancelled.\n     */\n    cancel(uploadId, options) {\n        return this._client.post(`/uploads/${uploadId}/cancel`, options);\n    }\n    /**\n     * Completes the\n     * [Upload](https://platform.openai.com/docs/api-reference/uploads/object).\n     *\n     * Within the returned Upload object, there is a nested\n     * [File](https://platform.openai.com/docs/api-reference/files/object) object that\n     * is ready to use in the rest of the platform.\n     *\n     * You can specify the order of the Parts by passing in an ordered list of the Part\n     * IDs.\n     *\n     * The number of bytes uploaded upon completion must match the number of bytes\n     * initially specified when creating the Upload object. No Parts may be added after\n     * an Upload is completed.\n     */\n    complete(uploadId, body, options) {\n        return this._client.post(`/uploads/${uploadId}/complete`, { body, ...options });\n    }\n}\nUploads.Parts = Parts;\n//# sourceMappingURL=uploads.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nvar _a;\nimport * as qs from \"./internal/qs/index.mjs\";\nimport * as Core from \"./core.mjs\";\nimport * as Errors from \"./error.mjs\";\nimport * as Pagination from \"./pagination.mjs\";\nimport * as Uploads from \"./uploads.mjs\";\nimport * as API from \"./resources/index.mjs\";\nimport { Batches, BatchesPage, } from \"./resources/batches.mjs\";\nimport { Completions, } from \"./resources/completions.mjs\";\nimport { Embeddings, } from \"./resources/embeddings.mjs\";\nimport { FileObjectsPage, Files, } from \"./resources/files.mjs\";\nimport { Images, } from \"./resources/images.mjs\";\nimport { Models, ModelsPage } from \"./resources/models.mjs\";\nimport { Moderations, } from \"./resources/moderations.mjs\";\nimport { Audio } from \"./resources/audio/audio.mjs\";\nimport { Beta } from \"./resources/beta/beta.mjs\";\nimport { Chat } from \"./resources/chat/chat.mjs\";\nimport { FineTuning } from \"./resources/fine-tuning/fine-tuning.mjs\";\nimport { Uploads as UploadsAPIUploads, } from \"./resources/uploads/uploads.mjs\";\n/**\n * API Client for interfacing with the OpenAI API.\n */\nexport class OpenAI extends Core.APIClient {\n    /**\n     * API Client for interfacing with the OpenAI API.\n     *\n     * @param {string | undefined} [opts.apiKey=process.env['OPENAI_API_KEY'] ?? undefined]\n     * @param {string | null | undefined} [opts.organization=process.env['OPENAI_ORG_ID'] ?? null]\n     * @param {string | null | undefined} [opts.project=process.env['OPENAI_PROJECT_ID'] ?? null]\n     * @param {string} [opts.baseURL=process.env['OPENAI_BASE_URL'] ?? https://api.openai.com/v1] - Override the default base URL for the API.\n     * @param {number} [opts.timeout=10 minutes] - The maximum amount of time (in milliseconds) the client will wait for a response before timing out.\n     * @param {number} [opts.httpAgent] - An HTTP agent used to manage HTTP(s) connections.\n     * @param {Core.Fetch} [opts.fetch] - Specify a custom `fetch` function implementation.\n     * @param {number} [opts.maxRetries=2] - The maximum number of times the client will retry a request.\n     * @param {Core.Headers} opts.defaultHeaders - Default headers to include with every request to the API.\n     * @param {Core.DefaultQuery} opts.defaultQuery - Default query parameters to include with every request to the API.\n     * @param {boolean} [opts.dangerouslyAllowBrowser=false] - By default, client-side use of this library is not allowed, as it risks exposing your secret API credentials to attackers.\n     */\n    constructor({ baseURL = Core.readEnv('OPENAI_BASE_URL'), apiKey = Core.readEnv('OPENAI_API_KEY'), organization = Core.readEnv('OPENAI_ORG_ID') ?? null, project = Core.readEnv('OPENAI_PROJECT_ID') ?? null, ...opts } = {}) {\n        if (apiKey === undefined) {\n            throw new Errors.OpenAIError(\"The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).\");\n        }\n        const options = {\n            apiKey,\n            organization,\n            project,\n            ...opts,\n            baseURL: baseURL || `https://api.openai.com/v1`,\n        };\n        if (!options.dangerouslyAllowBrowser && Core.isRunningInBrowser()) {\n            throw new Errors.OpenAIError(\"It looks like you're running in a browser-like environment.\\n\\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\\nIf you understand the risks and have appropriate mitigations in place,\\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\\n\\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\\n\\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\\n\");\n        }\n        super({\n            baseURL: options.baseURL,\n            timeout: options.timeout ?? 600000 /* 10 minutes */,\n            httpAgent: options.httpAgent,\n            maxRetries: options.maxRetries,\n            fetch: options.fetch,\n        });\n        this.completions = new API.Completions(this);\n        this.chat = new API.Chat(this);\n        this.embeddings = new API.Embeddings(this);\n        this.files = new API.Files(this);\n        this.images = new API.Images(this);\n        this.audio = new API.Audio(this);\n        this.moderations = new API.Moderations(this);\n        this.models = new API.Models(this);\n        this.fineTuning = new API.FineTuning(this);\n        this.beta = new API.Beta(this);\n        this.batches = new API.Batches(this);\n        this.uploads = new API.Uploads(this);\n        this._options = options;\n        this.apiKey = apiKey;\n        this.organization = organization;\n        this.project = project;\n    }\n    defaultQuery() {\n        return this._options.defaultQuery;\n    }\n    defaultHeaders(opts) {\n        return {\n            ...super.defaultHeaders(opts),\n            'OpenAI-Organization': this.organization,\n            'OpenAI-Project': this.project,\n            ...this._options.defaultHeaders,\n        };\n    }\n    authHeaders(opts) {\n        return { Authorization: `Bearer ${this.apiKey}` };\n    }\n    stringifyQuery(query) {\n        return qs.stringify(query, { arrayFormat: 'brackets' });\n    }\n}\n_a = OpenAI;\nOpenAI.OpenAI = _a;\nOpenAI.DEFAULT_TIMEOUT = 600000; // 10 minutes\nOpenAI.OpenAIError = Errors.OpenAIError;\nOpenAI.APIError = Errors.APIError;\nOpenAI.APIConnectionError = Errors.APIConnectionError;\nOpenAI.APIConnectionTimeoutError = Errors.APIConnectionTimeoutError;\nOpenAI.APIUserAbortError = Errors.APIUserAbortError;\nOpenAI.NotFoundError = Errors.NotFoundError;\nOpenAI.ConflictError = Errors.ConflictError;\nOpenAI.RateLimitError = Errors.RateLimitError;\nOpenAI.BadRequestError = Errors.BadRequestError;\nOpenAI.AuthenticationError = Errors.AuthenticationError;\nOpenAI.InternalServerError = Errors.InternalServerError;\nOpenAI.PermissionDeniedError = Errors.PermissionDeniedError;\nOpenAI.UnprocessableEntityError = Errors.UnprocessableEntityError;\nOpenAI.toFile = Uploads.toFile;\nOpenAI.fileFromPath = Uploads.fileFromPath;\nOpenAI.Completions = Completions;\nOpenAI.Chat = Chat;\nOpenAI.Embeddings = Embeddings;\nOpenAI.Files = Files;\nOpenAI.FileObjectsPage = FileObjectsPage;\nOpenAI.Images = Images;\nOpenAI.Audio = Audio;\nOpenAI.Moderations = Moderations;\nOpenAI.Models = Models;\nOpenAI.ModelsPage = ModelsPage;\nOpenAI.FineTuning = FineTuning;\nOpenAI.Beta = Beta;\nOpenAI.Batches = Batches;\nOpenAI.BatchesPage = BatchesPage;\nOpenAI.Uploads = UploadsAPIUploads;\n/** API Client for interfacing with the Azure OpenAI API. */\nexport class AzureOpenAI extends OpenAI {\n    /**\n     * API Client for interfacing with the Azure OpenAI API.\n     *\n     * @param {string | undefined} [opts.apiVersion=process.env['OPENAI_API_VERSION'] ?? undefined]\n     * @param {string | undefined} [opts.endpoint=process.env['AZURE_OPENAI_ENDPOINT'] ?? undefined] - Your Azure endpoint, including the resource, e.g. `https://example-resource.azure.openai.com/`\n     * @param {string | undefined} [opts.apiKey=process.env['AZURE_OPENAI_API_KEY'] ?? undefined]\n     * @param {string | undefined} opts.deployment - A model deployment, if given, sets the base client URL to include `/deployments/{deployment}`.\n     * @param {string | null | undefined} [opts.organization=process.env['OPENAI_ORG_ID'] ?? null]\n     * @param {string} [opts.baseURL=process.env['OPENAI_BASE_URL']] - Sets the base URL for the API, e.g. `https://example-resource.azure.openai.com/openai/`.\n     * @param {number} [opts.timeout=10 minutes] - The maximum amount of time (in milliseconds) the client will wait for a response before timing out.\n     * @param {number} [opts.httpAgent] - An HTTP agent used to manage HTTP(s) connections.\n     * @param {Core.Fetch} [opts.fetch] - Specify a custom `fetch` function implementation.\n     * @param {number} [opts.maxRetries=2] - The maximum number of times the client will retry a request.\n     * @param {Core.Headers} opts.defaultHeaders - Default headers to include with every request to the API.\n     * @param {Core.DefaultQuery} opts.defaultQuery - Default query parameters to include with every request to the API.\n     * @param {boolean} [opts.dangerouslyAllowBrowser=false] - By default, client-side use of this library is not allowed, as it risks exposing your secret API credentials to attackers.\n     */\n    constructor({ baseURL = Core.readEnv('OPENAI_BASE_URL'), apiKey = Core.readEnv('AZURE_OPENAI_API_KEY'), apiVersion = Core.readEnv('OPENAI_API_VERSION'), endpoint, deployment, azureADTokenProvider, dangerouslyAllowBrowser, ...opts } = {}) {\n        if (!apiVersion) {\n            throw new Errors.OpenAIError(\"The OPENAI_API_VERSION environment variable is missing or empty; either provide it, or instantiate the AzureOpenAI client with an apiVersion option, like new AzureOpenAI({ apiVersion: 'My API Version' }).\");\n        }\n        if (typeof azureADTokenProvider === 'function') {\n            dangerouslyAllowBrowser = true;\n        }\n        if (!azureADTokenProvider && !apiKey) {\n            throw new Errors.OpenAIError('Missing credentials. Please pass one of `apiKey` and `azureADTokenProvider`, or set the `AZURE_OPENAI_API_KEY` environment variable.');\n        }\n        if (azureADTokenProvider && apiKey) {\n            throw new Errors.OpenAIError('The `apiKey` and `azureADTokenProvider` arguments are mutually exclusive; only one can be passed at a time.');\n        }\n        // define a sentinel value to avoid any typing issues\n        apiKey ?? (apiKey = API_KEY_SENTINEL);\n        opts.defaultQuery = { ...opts.defaultQuery, 'api-version': apiVersion };\n        if (!baseURL) {\n            if (!endpoint) {\n                endpoint = process.env['AZURE_OPENAI_ENDPOINT'];\n            }\n            if (!endpoint) {\n                throw new Errors.OpenAIError('Must provide one of the `baseURL` or `endpoint` arguments, or the `AZURE_OPENAI_ENDPOINT` environment variable');\n            }\n            baseURL = `${endpoint}/openai`;\n        }\n        else {\n            if (endpoint) {\n                throw new Errors.OpenAIError('baseURL and endpoint are mutually exclusive');\n            }\n        }\n        super({\n            apiKey,\n            baseURL,\n            ...opts,\n            ...(dangerouslyAllowBrowser !== undefined ? { dangerouslyAllowBrowser } : {}),\n        });\n        this.apiVersion = '';\n        this._azureADTokenProvider = azureADTokenProvider;\n        this.apiVersion = apiVersion;\n        this._deployment = deployment;\n    }\n    buildRequest(options) {\n        if (_deployments_endpoints.has(options.path) && options.method === 'post' && options.body !== undefined) {\n            if (!Core.isObj(options.body)) {\n                throw new Error('Expected request body to be an object');\n            }\n            const model = this._deployment || options.body['model'];\n            if (model !== undefined && !this.baseURL.includes('/deployments')) {\n                options.path = `/deployments/${model}${options.path}`;\n            }\n        }\n        return super.buildRequest(options);\n    }\n    async _getAzureADToken() {\n        if (typeof this._azureADTokenProvider === 'function') {\n            const token = await this._azureADTokenProvider();\n            if (!token || typeof token !== 'string') {\n                throw new Errors.OpenAIError(`Expected 'azureADTokenProvider' argument to return a string but it returned ${token}`);\n            }\n            return token;\n        }\n        return undefined;\n    }\n    authHeaders(opts) {\n        return {};\n    }\n    async prepareOptions(opts) {\n        /**\n         * The user should provide a bearer token provider if they want\n         * to use Azure AD authentication. The user shouldn't set the\n         * Authorization header manually because the header is overwritten\n         * with the Azure AD token if a bearer token provider is provided.\n         */\n        if (opts.headers?.['api-key']) {\n            return super.prepareOptions(opts);\n        }\n        const token = await this._getAzureADToken();\n        opts.headers ?? (opts.headers = {});\n        if (token) {\n            opts.headers['Authorization'] = `Bearer ${token}`;\n        }\n        else if (this.apiKey !== API_KEY_SENTINEL) {\n            opts.headers['api-key'] = this.apiKey;\n        }\n        else {\n            throw new Errors.OpenAIError('Unable to handle auth');\n        }\n        return super.prepareOptions(opts);\n    }\n}\nconst _deployments_endpoints = new Set([\n    '/completions',\n    '/chat/completions',\n    '/embeddings',\n    '/audio/transcriptions',\n    '/audio/translations',\n    '/audio/speech',\n    '/images/generations',\n]);\nconst API_KEY_SENTINEL = '<Missing Key>';\nexport { toFile, fileFromPath } from \"./uploads.mjs\";\nexport { OpenAIError, APIError, APIConnectionError, APIConnectionTimeoutError, APIUserAbortError, NotFoundError, ConflictError, RateLimitError, BadRequestError, AuthenticationError, InternalServerError, PermissionDeniedError, UnprocessableEntityError, } from \"./error.mjs\";\nexport default OpenAI;\n//# sourceMappingURL=index.mjs.map","import OpenAI from 'openai'\n\nexport class OpenAIService {\n  constructor(apiKey) {\n    this.client = new OpenAI({ \n      apiKey,\n      dangerouslyAllowBrowser: true // Enable browser usage\n    })\n  }\n\n  async generateCompletion(prompt, options = {}) {\n    try {\n      const response = await this.client.chat.completions.create({\n        model: options.model || 'gpt-4',\n        messages: [{ role: 'user', content: prompt }],\n        temperature: options.temperature || 0.7,\n        max_tokens: options.maxTokens || 1000,\n      })\n\n      return {\n        text: response.choices[0].message.content,\n        usage: response.usage,\n      }\n    } catch (error) {\n      console.error('OpenAI API Error:', error)\n      throw new Error(`OpenAI API Error: ${error.message}`)\n    }\n  }\n\n  async generateImage(prompt, options = {}) {\n    try {\n      const response = await this.client.images.generate({\n        prompt,\n        n: options.n || 1,\n        size: options.size || '1024x1024',\n        quality: options.quality || 'standard',\n        style: options.style || 'vivid',\n      })\n\n      return response.data\n    } catch (error) {\n      console.error('OpenAI Image API Error:', error)\n      throw new Error(`OpenAI Image API Error: ${error.message}`)\n    }\n  }\n} ","import { supabase } from '../../lib/supabase'\n\nexport class AnthropicService {\n  constructor(apiKey) {\n    this.apiKey = apiKey\n  }\n\n  async generateCompletion(prompt, options = {}) {\n    const defaultOptions = {\n      model: 'claude-3-opus-20240229',\n      temperature: 0.7,\n      maxTokens: 1000\n    }\n\n    const mergedOptions = { ...defaultOptions, ...options }\n\n    try {\n      const response = await fetch('/api/anthropic', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          apiKey: this.apiKey,\n          prompt,\n          ...mergedOptions\n        })\n      })\n\n      if (!response.ok) {\n        const errorData = await response.json()\n        throw new Error(errorData.error || 'API request failed')\n      }\n\n      const data = await response.json()\n\n      if (data.error) {\n        throw new Error(data.error)\n      }\n\n      return data.content\n    } catch (error) {\n      throw error\n    }\n  }\n} ","import { supabase } from '../../lib/supabase'\n\nexport class GrokService {\n  constructor(apiKey) {\n    this.apiKey = apiKey\n  }\n\n  async generateCompletion(prompt, options = {}) {\n    const defaultOptions = {\n      model: 'grok-1',\n      temperature: 0.7,\n      maxTokens: 1000\n    }\n\n    const mergedOptions = { ...defaultOptions, ...options }\n\n    try {\n      const response = await fetch('/api/grok', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          apiKey: this.apiKey,\n          prompt,\n          ...mergedOptions\n        })\n      })\n\n      if (!response.ok) {\n        const errorData = await response.json()\n        throw new Error(errorData.error || 'API request failed')\n      }\n\n      const data = await response.json()\n\n      if (data.error) {\n        throw new Error(data.error)\n      }\n\n      return data.content\n    } catch (error) {\n      throw error\n    }\n  }\n} ","import { supabase } from '../../lib/supabase'\n\nexport class PerplexityService {\n  constructor(apiKey) {\n    this.apiKey = apiKey\n  }\n\n  async generateCompletion(prompt, options = {}) {\n    const defaultOptions = {\n      model: 'pplx-7b-online',\n      temperature: 0.7,\n      maxTokens: 1000\n    }\n\n    const mergedOptions = { ...defaultOptions, ...options }\n\n    try {\n      const response = await fetch('/api/perplexity', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          apiKey: this.apiKey,\n          prompt,\n          ...mergedOptions\n        })\n      })\n\n      if (!response.ok) {\n        const errorData = await response.json()\n        throw new Error(errorData.error || 'API request failed')\n      }\n\n      const data = await response.json()\n\n      if (data.error) {\n        throw new Error(data.error)\n      }\n\n      return data.content\n    } catch (error) {\n      throw error\n    }\n  }\n} ","export default class SerperService {\n  constructor(apiKey) {\n    this.apiKey = apiKey;\n    this.baseUrl = 'https://google.serper.dev/search';\n  }\n\n  async generateCompletion(prompt, options = {}) {\n    const headers = new Headers();\n    headers.append(\"X-API-KEY\", this.apiKey);\n    headers.append(\"Content-Type\", \"application/json\");\n\n    const requestOptions = {\n      method: \"POST\",\n      headers: headers,\n      body: JSON.stringify({ q: prompt }),\n      redirect: \"follow\"\n    };\n\n    const response = await fetch(this.baseUrl, requestOptions);\n    const result = await response.json();\n    \n    // Format each source as a separate item\n    let sources = [];\n    \n    if (result.organic) {\n      sources = result.organic.slice(0, 5).map(item => (\n        `${item.title}\\n${item.snippet}\\n[Source](${item.link})`\n      ));\n    }\n\n    if (result.knowledgeGraph) {\n      const kg = result.knowledgeGraph;\n      let kgText = [];\n      if (kg.title) kgText.push(`${kg.title}`);\n      if (kg.type) kgText.push(`Type: ${kg.type}`);\n      if (kg.description) kgText.push(kg.description);\n      if (kgText.length > 0) {\n        sources.push(kgText.join('\\n'));\n      }\n    }\n\n    if (result.relatedSearches) {\n      sources.push(...result.relatedSearches.map(search => search.query));\n    }\n\n    return { text: sources.join('\\n\\n---\\n\\n') };\n  }\n} ","import { createContext, useContext, useState, useEffect } from 'react'\nimport { OpenAIService } from './openai'\nimport { AnthropicService } from './anthropic'\nimport { GrokService } from './grok'\nimport { PerplexityService } from './perplexity'\nimport SerperService from './serper'\nimport { useAuth } from '../../contexts/AuthContext'\nimport { supabase } from '../../lib/supabase'\n\n// Define which services are available for each development step\nexport const STEP_SERVICES = {\n  child_posts: ['openai', 'anthropic', 'grok'],\n  ideation: ['openai', 'anthropic', 'grok'],\n  research: ['serper', 'perplexity'],\n  // Add other steps as needed\n}\n\nconst AIContext = createContext()\n\nexport function AIProvider({ children }) {\n  const { user } = useAuth()\n  const [currentService, setCurrentService] = useState('')\n  const [services, setServices] = useState({})\n  const [loading, setLoading] = useState(false)\n  const [profile, setProfile] = useState(null)\n  const [currentStep, setCurrentStep] = useState('ideation')\n\n  useEffect(() => {\n    if (user?.id) {\n      loadProfile()\n    }\n  }, [user?.id])\n\n  // Add effect to initialize services when profile is loaded\n  useEffect(() => {\n    if (profile) {\n      const initializeServices = async () => {\n        for (const serviceType of ['openai', 'anthropic', 'grok', 'perplexity', 'serper']) {\n          const service = await initializeService(serviceType)\n          if (service) {\n            setServices(prev => ({ ...prev, [serviceType]: service }))\n            if (!currentService) {\n              setCurrentService(serviceType)\n            }\n          }\n        }\n      }\n      initializeServices()\n    }\n  }, [profile])\n\n  const loadProfile = async () => {\n    if (!user?.id) return null\n\n    try {\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('id', user.id)\n        .single()\n\n      if (error) return null\n\n      return data\n    } catch (error) {\n      return null\n    }\n  }\n\n  const initializeService = async (serviceType) => {\n    if (!profile?.[`api_${serviceType}`]) return null\n\n    try {\n      let service = null\n      switch (serviceType) {\n        case 'openai':\n          service = new OpenAIService(profile.api_openai)\n          break\n        case 'anthropic':\n          service = new AnthropicService(profile.api_anthropic)\n          break\n        case 'grok':\n          service = new GrokService(profile.api_grok)\n          break\n        case 'perplexity':\n          service = new PerplexityService(profile.api_perplexity)\n          break\n        case 'serper':\n          service = new SerperService(profile.api_serper)\n          break\n      }\n      if (service) {\n        services[serviceType] = service\n      }\n      return service\n    } catch (error) {\n      console.error(`Error initializing ${serviceType} service:`, error)\n      return null\n    }\n  }\n\n  const getCurrentService = async () => {\n    if (currentService && services[currentService]) {\n      return services[currentService]\n    }\n\n    // Try to initialize first available service\n    for (const serviceType of ['openai', 'anthropic', 'grok', 'perplexity', 'serper']) {\n      const service = await initializeService(serviceType)\n      if (service) {\n        setCurrentService(serviceType)\n        return service\n      }\n    }\n\n    console.error('No AI service available')\n    return null\n  }\n\n  useEffect(() => {\n    const initServices = async () => {\n      const loadedProfile = await loadProfile()\n      if (loadedProfile) {\n        setProfile(loadedProfile)\n        for (const serviceType of ['openai', 'anthropic', 'grok', 'perplexity', 'serper']) {\n          await initializeService(serviceType)\n        }\n      }\n    }\n\n    initServices()\n  }, [user])\n\n  const value = {\n    currentService,\n    setCurrentService,\n    services,\n    loading,\n    getCurrentService,\n    reloadProfile: loadProfile,\n    currentStep,\n    setCurrentStep,\n    availableServices: STEP_SERVICES[currentStep] || []\n  }\n\n  return <AIContext.Provider value={value}>{children}</AIContext.Provider>\n}\n\nexport function useAI() {\n  const context = useContext(AIContext)\n  if (context === undefined) {\n    throw new Error('useAI must be used within an AIProvider')\n  }\n  return context\n}\n\nexport const AI_SERVICE_NAMES = {\n  openai: 'OpenAI',\n  anthropic: 'Anthropic',\n  grok: 'Grok',\n  perplexity: 'Perplexity',\n  serper: 'Serper'\n} ","import { Navigate } from 'react-router-dom'\nimport { useAuth } from '../contexts/AuthContext'\n\nfunction ProtectedRoute({ children }) {\n  const { user } = useAuth()\n\n  if (!user) {\n    return <Navigate to=\"/login\" replace />\n  }\n\n  return children\n}\n\nexport default ProtectedRoute ","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6\"\n}), 'Brightness4');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6m0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4\"\n}), 'Brightness7');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6\"\n}), 'Settings');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z\"\n}), 'Description');","import { Link, useLocation } from 'react-router-dom'\nimport { useAuth } from '../contexts/AuthContext'\nimport { useTheme } from '../contexts/ThemeContext'\nimport { useInterests } from '../contexts/InterestContext'\nimport { useProfile } from '../contexts/ProfileContext'\nimport { AppBar, Toolbar, Button, IconButton, Box, Menu, MenuItem, Stack } from '@mui/material'\nimport Brightness4Icon from '@mui/icons-material/Brightness4'\nimport Brightness7Icon from '@mui/icons-material/Brightness7'\nimport SettingsIcon from '@mui/icons-material/Settings'\nimport DescriptionIcon from '@mui/icons-material/Description'\nimport { useState } from 'react'\n\nexport default function Navbar() {\n  const { user, signOut } = useAuth()\n  const { darkMode, toggleDarkMode } = useTheme()\n  const { interests, loading: interestsLoading } = useInterests()\n  const { blogProfile, userProfile, loading: profileLoading, currentUsername, getFullLogoUrl } = useProfile()\n  const [manageAnchorEl, setManageAnchorEl] = useState(null)\n  const location = useLocation()\n\n  // Sort interests by sequence\n  const sortedInterests = [...(interests || [])]\n    .sort((a, b) => (a.sequence || 0) - (b.sequence || 0))\n\n  const handleManageClick = (event) => {\n    setManageAnchorEl(event.currentTarget)\n  }\n\n  const handleManageClose = () => {\n    setManageAnchorEl(null)\n  }\n\n  // Get the active profile (blog profile or user profile)\n  const activeProfile = blogProfile || userProfile\n\n  // Check if we're on the welcome page\n  const isWelcomePage = location.pathname === '/'\n\n  // If we're loading and not on welcome page, don't show navbar\n  if ((interestsLoading || profileLoading || !currentUsername) && !isWelcomePage) {\n    return null\n  }\n\n  // Get the full logo URL - ensure we're getting it from the active profile\n  const logoUrl = isWelcomePage ? getFullLogoUrl(blogProfile?.logo) : getFullLogoUrl(activeProfile?.logo)\n\n  return (\n    <AppBar \n      position=\"sticky\" \n      sx={{ \n        borderRadius: 0,\n        '& .MuiButton-root': {\n          borderRadius: 0\n        }\n      }}\n    >\n      <Toolbar>\n        {/* Left section - Logo and Resume */}\n        <Stack \n          direction=\"row\" \n          spacing={1} \n          alignItems=\"center\" \n          sx={{ flex: '0 0 auto' }}\n        >\n          <Button\n            color=\"inherit\"\n            component={Link}\n            to={isWelcomePage ? '/' : `/${blogProfile?.username}`}\n            sx={{ \n              textTransform: 'none',\n              fontSize: '1.2rem',\n              fontWeight: 500,\n              display: 'flex',\n              alignItems: 'center',\n              gap: 1\n            }}\n          >\n            <Box\n              component=\"img\"\n              src={logoUrl}\n              alt={isWelcomePage ? 'Hiverarchy logo' : `${blogProfile?.username}'s logo`}\n              sx={{\n                height: 32,\n                width: 32,\n                objectFit: 'contain',\n                borderRadius: '4px'\n              }}\n              onError={(e) => {\n                e.target.src = '/images/default.jpg'\n              }}\n            />\n            {isWelcomePage ? 'Hiverarchy' : (blogProfile?.username || 'Hiverarchy')}\n          </Button>\n          \n          {/* Resume Link - Only show if resume exists and not on welcome page */}\n          {!isWelcomePage && activeProfile?.resume && (\n            <Button\n              color=\"inherit\"\n              component={Link}\n              to={`/${blogProfile?.username}/resume`}\n              startIcon={<DescriptionIcon />}\n              size=\"small\"\n              sx={{ \n                textTransform: 'none',\n                whiteSpace: 'nowrap',\n                ml: 1\n              }}\n            >\n              Resume\n            </Button>\n          )}\n        </Stack>\n\n        {/* Middle section - Interests (only show if not on welcome page) */}\n        {!isWelcomePage && (\n          <Box sx={{ \n            flex: '1 1 auto', \n            display: 'flex', \n            justifyContent: 'center',\n            alignItems: 'center', \n            gap: 1,\n            mx: 2,\n            overflow: 'auto'\n          }}>\n            {sortedInterests.map((interest) => (\n              <Button\n                key={interest.id}\n                color=\"inherit\"\n                component={Link}\n                to={`/${blogProfile?.username}/interest/${interest.name}`}\n                sx={{\n                  whiteSpace: 'nowrap'\n                }}\n              >\n                {interest.title}\n              </Button>\n            ))}\n          </Box>\n        )}\n\n        {/* Right section - Actions */}\n        <Box sx={{ flex: '0 0 auto', display: 'flex', alignItems: 'center', gap: 1 }}>\n          <IconButton onClick={toggleDarkMode} color=\"inherit\">\n            {darkMode ? <Brightness7Icon /> : <Brightness4Icon />}\n          </IconButton>\n\n          {user ? (\n            <>\n              <IconButton\n                color=\"inherit\"\n                onClick={handleManageClick}\n                aria-controls=\"manage-menu\"\n                aria-haspopup=\"true\"\n              >\n                <SettingsIcon />\n              </IconButton>\n              <Menu\n                id=\"manage-menu\"\n                anchorEl={manageAnchorEl}\n                keepMounted\n                open={Boolean(manageAnchorEl)}\n                onClose={handleManageClose}\n              >\n                <MenuItem \n                  component={Link} \n                  to={`/${blogProfile?.username}/manage/posts`}\n                  onClick={handleManageClose}\n                >\n                  Manage Posts\n                </MenuItem>\n                <MenuItem \n                  component={Link} \n                  to={`/${blogProfile?.username}/manage/profile`}\n                  onClick={handleManageClose}\n                >\n                  Manage Profile\n                </MenuItem>\n                <MenuItem \n                  component={Link} \n                  to={`/${blogProfile?.username}/manage/interests`}\n                  onClick={handleManageClose}\n                >\n                  Manage Interests\n                </MenuItem>\n              </Menu>\n              <Button color=\"inherit\" onClick={signOut}>\n                Sign Out\n              </Button>\n            </>\n          ) : (\n            <Button color=\"inherit\" component={Link} to=\"/login\">\n              Login\n            </Button>\n          )}\n        </Box>\n      </Toolbar>\n    </AppBar>\n  )\n}","import { Link } from 'react-router-dom'\nimport { Box, Container, Typography, Button, Paper, Grid } from '@mui/material'\nimport { useTheme } from '../contexts/ThemeContext'\nimport { useNavigate } from 'react-router-dom'\nimport { useAuth } from '../contexts/AuthContext'\nimport { useEffect } from 'react'\nimport { useProfile } from '../contexts/ProfileContext'\n\nexport default function Welcome() {\n  const navigate = useNavigate()\n  const { user } = useAuth()\n  const { userProfile } = useProfile()\n  const { darkMode } = useTheme()\n\n  return (\n    <Container maxWidth=\"lg\">\n      <Box sx={{ \n        minHeight: '100vh', \n        display: 'flex', \n        flexDirection: 'column',\n        justifyContent: 'center',\n        py: 8\n      }}>\n        <Grid container spacing={4}>\n          {/* Hero Section */}\n          <Grid item xs={12}>\n            <Box sx={{ textAlign: 'center', mb: 6 }}>\n              <Typography variant=\"h2\" component=\"h1\" gutterBottom>\n                Welcome to Hiverarchy\n              </Typography>\n              <Typography variant=\"h5\" color=\"text.secondary\" paragraph>\n                A collaborative platform where developers share and evolve knowledge together\n              </Typography>\n            </Box>\n          </Grid>\n\n          {/* Features */}\n          <Grid item xs={12}>\n            <Grid container spacing={4}>\n              <Grid item xs={12} md={4}>\n                <Paper \n                  elevation={3} \n                  sx={{ \n                    p: 3, \n                    height: '100%',\n                    backgroundColor: darkMode ? 'rgba(255, 255, 255, 0.05)' : 'background.paper',\n                    borderRadius: 0\n                  }}\n                >\n                  <Typography variant=\"h5\" gutterBottom>\n                    Share Your Knowledge\n                  </Typography>\n                  <Typography>\n                    Create your own space to share technical insights, tutorials, and experiences\n                  </Typography>\n                </Paper>\n              </Grid>\n              <Grid item xs={12} md={4}>\n                <Paper \n                  elevation={3} \n                  sx={{ \n                    p: 3, \n                    height: '100%',\n                    backgroundColor: darkMode ? 'rgba(255, 255, 255, 0.05)' : 'background.paper',\n                    borderRadius: 0\n                  }}\n                >\n                  <Typography variant=\"h5\" gutterBottom>\n                    Organize by Interests\n                  </Typography>\n                  <Typography>\n                    Group your content by topics and interests for easy navigation\n                  </Typography>\n                </Paper>\n              </Grid>\n              <Grid item xs={12} md={4}>\n                <Paper \n                  elevation={3} \n                  sx={{ \n                    p: 3, \n                    height: '100%',\n                    backgroundColor: darkMode ? 'rgba(255, 255, 255, 0.05)' : 'background.paper',\n                    borderRadius: 0\n                  }}\n                >\n                  <Typography variant=\"h5\" gutterBottom>\n                    AI-Powered Writing\n                  </Typography>\n                  <Typography>\n                    Use AI tools to help research, structure, and enhance your content\n                  </Typography>\n                </Paper>\n              </Grid>\n            </Grid>\n          </Grid>\n\n          {/* Featured Blog */}\n          <Grid item xs={12}>\n            <Paper \n              elevation={3} \n              sx={{ \n                p: 4, \n                mt: 4,\n                backgroundColor: darkMode ? 'rgba(255, 255, 255, 0.05)' : 'background.paper',\n                textAlign: 'center',\n                borderRadius: 0\n              }}\n            >\n              <Typography variant=\"h5\" gutterBottom>\n                Featured Blog\n              </Typography>\n              <Typography paragraph>\n                Check out GolferGeek's blog to see the platform in action\n              </Typography>\n              <Button \n                component={Link}\n                to=\"/golfergeek\"\n                variant=\"contained\" \n                size=\"large\"\n                sx={{ mt: 2, borderRadius: 0 }}\n              >\n                Visit GolferGeek's Blog\n              </Button>\n            </Paper>\n          </Grid>\n        </Grid>\n      </Box>\n    </Container>\n  )\n} ","import { BrowserRouter, Routes, Route, Navigate, useParams, useLocation, useNavigate } from 'react-router-dom'\nimport { AuthProvider, useAuth } from './contexts/AuthContext'\nimport { InterestProvider } from './contexts/InterestContext'\nimport { ProfileProvider, useProfile } from './contexts/ProfileContext'\nimport { ThemeProvider } from './contexts/ThemeContext'\nimport { AIProvider } from './services/ai/index.jsx'\nimport ProtectedRoute from './components/ProtectedRoute'\nimport Navbar from './components/Navbar'\nimport Welcome from './components/Welcome'\nimport { lazy, Suspense, useEffect } from 'react'\nimport './styles/global.css'\n\nconst Home = lazy(() => import('./pages/Home'))\nconst Login = lazy(() => import('./pages/Login'))\nconst SignUp = lazy(() => import('./pages/SignUp'))\nconst ViewPost = lazy(() => import('./pages/ViewPost'))\nconst CreatePost = lazy(() => import('./pages/CreatePost'))\nconst EditPost = lazy(() => import('./pages/EditPost'))\nconst ManageInterests = lazy(() => import('./pages/ManageInterests'))\nconst InterestPage = lazy(() => import('./components/InterestPage'))\nconst UserProfile = lazy(() => import('./pages/UserProfile'))\nconst Posts = lazy(() => import('./pages/Posts'))\nconst Resume = lazy(() => import('./pages/Resume'))\nconst PostWriter = lazy(() => import('./pages/PostWriter'))\n\n// Route guard component to check for username\nconst RouteGuard = ({ children }) => {\n  const { user } = useAuth()\n  const navigate = useNavigate()\n  const location = useLocation()\n  const params = useParams()\n\n  useEffect(() => {\n    // Allow public routes: welcome page, login, signup, and viewing user blogs\n    const publicPaths = ['/', '/login', '/signup']\n    const isPublicPath = publicPaths.includes(location.pathname) || \n                        location.pathname.match(/^\\/[^/]+$/) || // User's blog home\n                        location.pathname.match(/^\\/[^/]+\\/post\\/[^/]+$/) || // Viewing a post\n                        location.pathname.match(/^\\/[^/]+\\/interest\\/[^/]+$/) || // Interest page\n                        location.pathname.match(/^\\/[^/]+\\/resume$/) // Resume page\n\n    if (!user && !isPublicPath) {\n      navigate('/')\n    }\n  }, [user, location, navigate])\n\n  return children\n}\n\nfunction App() {\n  return (\n    <BrowserRouter future={{\n      v7_startTransition: true,\n      v7_relativeSplatPath: true,\n      v7_fetcherPersist: true,\n      v7_normalizeFormMethod: true,\n      v7_partialHydration: true,\n      v7_skipActionErrorRevalidation: true\n    }}>\n      <AuthProvider>\n        <ThemeProvider>\n          <ProfileProvider>\n            <InterestProvider>\n              <AIProvider>\n                <RouteGuard>\n                  <Navbar />\n                  <main className=\"container\">\n                    <Suspense fallback={<div>Loading...</div>}>\n                      <Routes>\n                        {/* Public routes - no username needed */}\n                        <Route path=\"/\" element={<Welcome />} />\n                        <Route path=\"/welcome\" element={<Welcome />} />\n                        <Route path=\"/login\" element={<Login />} />\n                        <Route path=\"/signup\" element={<SignUp />} />\n                        \n                        {/* Username-based routes */}\n                        <Route path=\"/:username\">\n                          <Route index element={<Home />} />\n                          <Route path=\"resume\" element={<Resume />} />\n                          <Route path=\"post/:id\" element={<ViewPost />} />\n                          <Route path=\"interest/:interest\" element={<InterestPage />} />\n                          \n                          {/* Protected routes */}\n                          <Route path=\"create\" element={\n                            <ProtectedRoute>\n                              <CreatePost />\n                            </ProtectedRoute>\n                          } />\n                          <Route path=\"edit/:id\" element={\n                            <ProtectedRoute>\n                              <EditPost />\n                            </ProtectedRoute>\n                          } />\n                          <Route path=\"writer/:id\" element={\n                            <ProtectedRoute>\n                              <PostWriter />\n                            </ProtectedRoute>\n                          } />\n                          <Route path=\"manage/interests\" element={\n                            <ProtectedRoute>\n                              <ManageInterests />\n                            </ProtectedRoute>\n                          } />\n                          <Route path=\"manage/profile\" element={\n                            <ProtectedRoute>\n                              <UserProfile />\n                            </ProtectedRoute>\n                          } />\n                          <Route path=\"manage/posts\" element={\n                            <ProtectedRoute>\n                              <Posts />\n                            </ProtectedRoute>\n                          } />\n                        </Route>\n\n                        {/* Show welcome page for unknown routes */}\n                        <Route path=\"*\" element={<Welcome />} />\n                      </Routes>\n                    </Suspense>\n                  </main>\n                </RouteGuard>\n              </AIProvider>\n            </InterestProvider>\n          </ProfileProvider>\n        </ThemeProvider>\n      </AuthProvider>\n    </BrowserRouter>\n  )\n}\n\nexport default App\n","import { StrictMode } from 'react'\nimport { createRoot } from 'react-dom/client'\nimport './index.css'\nimport App from './App.jsx'\n\ncreateRoot(document.getElementById('root')).render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n)\n"],"file":"assets/index-CWCCNURT.js"}